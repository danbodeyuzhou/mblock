(window.webpackJsonp=window.webpackJsonp||[]).push([[38],{1277:function(e,t,a){"use strict";a.r(t);var s=a(0),n=a.n(s),i=a(26),r=a(67),c=a(63),l=a(1163),o=a(1176),d=a(1164),E=a(13),h=a(5),m=a(102),T=a(17),p=a(3);function u(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class C extends n.a.Component{constructor(e){super(e),u(this,"hasConnected",()=>{const{connect:e}=this.props;return e&&e.status===h.a.CONNECT_STATUS.CONNECT_SUCCESS}),u(this,"handleCancel",()=>{p.default.emit("firmware.update.cancel",this.state.device),E.a.replace("/")}),u(this,"handleUpdate",()=>{const{device:e,name:t,tag:a}=this.state;E.a.replace(`/updater/firmware/progress?name=${t}&tag=${a}&device=${e}`)}),u(this,"handleChange",e=>{this.setState({tag:e})}),u(this,"footer",()=>{const{intlr:e}=this.props;return[n.a.createElement(r.a,{key:"serial",onClick:this.handleCancel},e.messages["BUTTON.CANCEL.TEXT"]),n.a.createElement(r.a,{key:"connect",type:"primary",onClick:this.handleUpdate},e.messages["BUTTON.UPDATE.TEXT"])]});const t=Object(T.getQueryString)(E.a.location.search,"deviceId")||h.a.DEVICE.CODEY,a=Object(T.getQueryString)(E.a.location.search,"name"),s=Object(T.getQueryString)(E.a.location.search,"tag")||"online";this.state={version:null,device:t,name:a,tag:s};const{intlr:i}=this.props;this.hasConnected()||(c.a.warn(i.messages["UPDATER.FRIMWARE.NOTCONNECT"]),E.a.replace("/"))}async componentDidMount(){if(!this.hasConnected())return;const{updater:e,setFirmware:t,intlr:a}=this.props,{model:s}=e;return this.state.device===h.a.DEVICE.MCORE?(t({tag:this.state.tag}),void this.setState({version:a.messages["UPDATE.FACTORY.DATA.LATEST"]})):this.state.device===h.a.DEVICE.AURIGA?(t({tag:this.state.tag}),void this.setState({version:a.messages["UPDATE.FACTORY.DATA.LATEST"]})):void(s.codey&&!s.codey.last||this.setState({version:s.codey.last}))}render(){const{intlr:e}=this.props,{version:t,tag:a,device:s}=this.state;return n.a.createElement(l.a,{width:"100%",className:"small-modal",visible:!0,title:e.messages["UPDATER.FRIMWARE.M.TITLE"],keyboard:!1,maskClosable:!1,onCancel:this.handleCancel,footer:this.footer()},n.a.createElement(o.a,{layout:"vertical"},n.a.createElement(o.a.Item,{label:e.messages["UPDATER.FRIMWARE.F.DEVICE.TEXT"]},n.a.createElement(d.a,{defaultValue:s,disabled:!0},n.a.createElement(d.a.Option,{value:"codey"},e.messages.CODEY))),n.a.createElement(o.a.Item,{label:e.messages["UPDATER.FRIMWARE.F.VERSION.TEXT"]},n.a.createElement(d.a,{value:a,onChange:this.handleChange,disabled:!0},n.a.createElement(d.a.Option,{value:"online"},t),n.a.createElement(d.a.Option,{value:"reset"},e.messages["UPDATE.FACTORY.DATA.RESET"])))))}}t.default=Object(i.connect)(e=>({intlr:e.intlr,connect:e.connect,updater:e.updater}),e=>({setFirmware:t=>e(m.g.firmware(t))}))(C)}}]);