(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{1187:function(e,t,r){(e.exports=r(68)(!1)).push([e.i,".updtaer-content {\n  max-height: 10rem;\n  overflow: auto;\n  margin-bottom: 1em;\n}\n.updtaer-content p {\n  font-size: 12px;\n  color: #9e9e9e;\n}\n.updtaer-content p:last-child {\n  margin-bottom: 0;\n}\n.version-title {\n  margin-bottom: 4px;\n  color: #6b6b6b;\n}\n.updater-alert {\n  margin: -30px -30px 1rem -30px;\n  margin-bottom: 1rem;\n  background-color: var(--BTN-HOVER-COLOR);\n  color: #fff;\n  padding: 12px 30px;\n}\n.progress-title {\n  font-size: 14px;\n  text-align: center;\n  margin-bottom: 2em;\n}\n.progress-title i {\n  margin-right: 6px;\n  font-size: 20px;\n}\n",""])},1203:function(e,t,r){var a=r(1187);"string"==typeof a&&(a=[[e.i,a,""]]);var s={transform:void 0},i=r(88)(a,s);a.locals&&(e.exports=a.locals),a.locals||e.hot.accept(1187,(function(){var t=r(1187);"string"==typeof t&&(t=[[e.i,t,""]]),i(t)})),e.hot.dispose((function(){i()}))},1279:function(e,t,r){"use strict";r.r(t);var a=r(4),s=r.n(a),i=r(0),n=r.n(i),o=r(26),l=r(548),c=r(32),d=r(67),p=r(1163),m=r(13),h=r(3),u=r(79),E=r(99),w=r(22),T=r(17),g=r(230),f=r(52),P=(r(1203),r(5));function F(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const{UPLOAD_STATUS:I}=P.a,y=20;class A extends n.a.Component{constructor(e){super(e),F(this,"triggerDownloadProcess",()=>{this.props.uploadFirmwarePrepare(),this.downloadProcessId=setInterval(()=>{this.downloadProcess<y?(this.downloadProcess++,this.props.uploadFirmwareProgress(this.downloadProcess)):(clearInterval(this.downloadProcessId),this.downloadProcessId=null)},1e3)}),F(this,"getEditingTarget",()=>{try{const e=Object(w.b)();this.firmware=e.config.options.firmware}catch(e){}}),F(this,"handleOk",(e=!1)=>{e&&(m.a.replace("/"),h.default.emit("ShowUpdateFirmware",null),h.default.emit("UploadFirmwareComplete",this.device,!0,e))}),F(this,"handleCancel",()=>{g.a.setSoftDisconnectMode(!1),h.default.emit("ConnectBroken",this.device,!1),h.default.emit("firmware.update.cancel",this.device,!!this.downloadProcessId),m.a.replace("/")}),F(this,"processing",(e,t)=>{const{intlr:r}=this.props,{messages:a}=r;return{title:a["UPDATER.FIRMWARE.LOADING.TITLE"],content:n.a.createElement("div",{style:{padding:"48px 0 80px 0"}},n.a.createElement(l.a,{status:e===I.FAILED?"exception":e===I.UPLOADED?"success":"active",percent:t}),n.a.createElement("p",{style:{marginTop:"1rem",textAlign:"center"}},n.a.createElement(c.a,{type:"warning mr",style:{color:"#ffa39e"}}),a["UPDATER.FIRMWARE.LOADING.CONTENT.TEXT"])),footer:n.a.createElement("div",{style:{textAlign:"center"}},n.a.createElement(d.a,{type:"primary",ghost:!0,onClick:this.handleCancel},r.messages["BUTTON.CANCEL.TEXT"])),close:!1}}),F(this,"uploaded",()=>{const{intlr:e}=this.props,{messages:t}=e,r=this.firmware&&this.firmware.tips&&this.firmware.tips.success||[];return{title:t["UPDATER.FIRMWARE.SUCCESS.TITLE"],content:n.a.createElement("div",{style:{padding:"26px 0 40px 0"}},n.a.createElement("p",{className:"progress-title"},n.a.createElement(f.a,{type:"icon-success",style:{verticalAlign:"top",color:"#52c41a"}}),t["UPDATER.FIRMWARE.SUCCESS.CONTENT.TITLE"]),n.a.createElement("ul",{className:"helpTip",style:{marginBottom:"0"}},r.map((e,t)=>n.a.createElement("li",{key:t},Object(E.a)(e))))),footer:n.a.createElement("div",{style:{textAlign:"center"}},n.a.createElement(d.a,{type:"primary",onClick:this.handleCancel},t["BUTTON.IKNOW.TEXT"])),close:!0}}),F(this,"failed",()=>{const{intlr:e}=this.props,{messages:t}=e;let r;return r=this.downloadFirmwareFail?["HARDDRIVER.DOWNLOAD.FAIL"]:this.firmware&&this.firmware.tips&&this.firmware.tips.fail||[],{title:t["UPDATER.FIRMWARE.FAILED.TITLE"],content:n.a.createElement("div",{style:{padding:"26px 0 40px 0"}},n.a.createElement("p",{className:"progress-title"},n.a.createElement(f.a,{type:"icon-wangluoyichangchengseV",style:{verticalAlign:"top",color:"#FDC02F"}}),t["UPDATER.FIRMWARE.FAILED.CONTENT.TITLE"]),n.a.createElement("ul",{className:"helpTip fail",style:{marginBottom:"0"}},r.map((e,t)=>n.a.createElement("li",{key:t},Object(E.a)(e))))),footer:[n.a.createElement("div",{key:"ok",style:{textAlign:"center"}},n.a.createElement(d.a,{type:"primary",onClick:()=>this.handleOk(!0)},t["BUTTON.RETRY.TEXT"]))],close:!1}}),F(this,"noupdate",()=>{const{intlr:e}=this.props,{messages:t}=e;return{title:t["UPDATER.FRIMWARE.M.TITLE"],content:n.a.createElement("div",null,n.a.createElement("h3",null,n.a.createElement(c.a,{type:"exclamation-circle",className:"mr",style:{color:"#52c41a"}}),t["UPDATER.NO.NEED.UPDATE"])),footer:n.a.createElement(d.a,{type:"primary",onClick:()=>m.a.replace("/")},t["BUTTON.OK.TEXT"]),close:!0}}),F(this,"cantuseble",()=>{const{intlr:e}=this.props,{messages:t}=e;return{title:t["UPDATER.FRIMWARE.M.TITLE"],content:n.a.createElement("div",null,n.a.createElement("h3",null,n.a.createElement(c.a,{type:"exclamation-circle",className:"mr",style:{color:"#ffa39e"}}),t["UPDATER.CANT.USE.BLE.TITLE"]),n.a.createElement("p",null,t["UPDATER.CANT.USE.BLE.TEXT"])),footer:n.a.createElement(d.a,{type:"primary",onClick:()=>m.a.replace("/")},t["BUTTON.OK.TEXT"]),close:!1}}),F(this,"modalData",()=>{if(this.isBle)return this.cantuseble();const{upload:e}=this.props,{progress_status:t}=e;return t===I.UPLOADED?this.uploaded():t===I.FAILED?this.failed():(I.PROCESSING,this.processing(t,e.progress_percent))}),this.url=Object(T.getQueryString)(m.a.location.search,"url"),this.firmware=null,this.check(),this.getEditingTarget(),this.isBle||this.handleOk(),this.downloadProcess=0}componentDidMount(){this.device=this.props.connect.device,this.triggerDownloadProcess(),this.initListeners()}componentWillUnmount(){this.downloadProcessId&&(clearInterval(this.downloadProcessId),this.downloadProcessId=null);for(const e in this.listeners)h.default.removeListener(e,this.listeners[e]);const{upload:e}=this.props,{progress_status:t}=e;t===I.PROCESSING&&this.handleCancel()}initListeners(){this.listeners={uploadFirmwarePrepare:()=>this.props.uploadFirmwarePrepare(),uploadFirmwareProgress:e=>{this.downloadProcessId&&(clearInterval(this.downloadProcessId),this.downloadProcessId=null);const t=this.downloadProcess+Math.round((100-this.downloadProcess)/100*e);this.props.uploadFirmwareProgress(t)},uploadFirmwareFail:e=>{this.downloadProcessId&&(clearInterval(this.downloadProcessId),this.downloadProcessId=null),this.props.uploadFirmwareFail(e)},uploadFirmwareFinished:()=>this.props.uploadFirmwareFinished(),downloadFirmwareFail:e=>{this.downloadProcessId&&(clearInterval(this.downloadProcessId),this.downloadProcessId=null),this.downloadFirmwareFail=!0,this.props.uploadFirmwareFail(e)}};for(const e in this.listeners)h.default.on(e,this.listeners[e])}check(){const{updater:e,connect:t}=this.props,{model:r}=e,{devices:a}=t;if(!s.a.isEmpty(a)&&!s.a.isEmpty(r)){let e=null;if(e=a[0],e){let{firmware:t}=e;return t||(t={}),this.isNoUpdate=t.version===r.codey.last,this.isBle="BLE"===t.channel,void(this.verify=!0)}}this.verify=!1}render(){const{title:e,content:t,footer:r,close:a}=this.modalData();return n.a.createElement(p.a,{width:400,keyboard:!1,visible:!0,title:e,footer:r,closable:!0,maskClosable:a,onCancel:this.handleCancel},t)}}t.default=Object(o.connect)(e=>({intlr:e.intlr,connect:e.connect,updater:e.updater,upload:e.upload}),e=>({uploadFirmwarePrepare:()=>{e(u.e.uploadFirmwarePrepare())},uploadFirmwareProgress:t=>{e(u.e.uploadFirmwareProgress(t))},uploadFirmwareFinished:()=>{e(u.e.uploadFirmwareFinished())},uploadFirmwareFail:t=>{e(u.e.uploadFirmwareFail(t))}}))(A)}}]);