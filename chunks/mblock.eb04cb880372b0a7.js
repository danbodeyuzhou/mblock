(window.webpackJsonp_name_=window.webpackJsonp_name_||[]).push([[1],{1011:function(e,t,o){"use strict";var n=o(864),i=o.n(n),s=o(3),a=o.n(s),r=o(147),l=o.n(r);l.a.enable();var c=l()("scratch-paint"),d=o(0),h=o.n(d),p=o(16),u=o(8),m=o.n(u),f=o(29),g=o(145),b=o.n(g),v=o(874),w=o.n(v);const S=w()({BITMAP:null,VECTOR:null,BITMAP_SKIP_CONVERT:null,VECTOR_SKIP_CONVERT:null}),C=function(e){return e===S.VECTOR||e===S.VECTOR_SKIP_CONVERT},I=function(e){return e===S.BITMAP||e===S.BITMAP_SKIP_CONVERT},x={BRUSH:null,ERASER:null,LINE:null,FILL:null,SELECT:null,RESHAPE:null,OVAL:null,RECT:null,ROUNDED_RECT:null,TEXT:null},T={BIT_BRUSH:null,BIT_LINE:null,BIT_OVAL:null,BIT_RECT:null,BIT_TEXT:null,BIT_FILL:null,BIT_ERASER:null,BIT_SELECT:null},y=w()(x),M=w()(T),E=w()({...x,...T}),R=function(e){return"Layer"===e.parent.className?e:R(e.parent)},k=function(e){return"PointText"===e.className||"Shape"===e.className||"PlacedSymbol"===e.className||"Raster"===e.className},O=function(e){return"CompoundPath"===e.className},D=function(e){return e&&e.className&&"Group"===e.className},P=function(e){return"PointText"===e.className},_=function(e){return R(e).data.isPGTextItem},L=function(e){return D(e)},B=function(e,t,o){return function(e,t,o,n){if(e.length>0){const s=new i.a.Group(e);re(t),ie(s,!0);for(let e=0;e<s.children.length;e++)s.children[e].selected=!0;return o(),n(),s}return!1}(le(),e,t,o)},A=function(e,t,o){if(e&&e.children&&L(e)){e.applyMatrix=!0;for(let n=0;n<e.children.length;n++){let s=e.children[n];if(s instanceof i.a.Group&&s.hasChildren()){if(t){A(s,t,o);continue}1===s.children.length&&(s=s.reduce())}s.applyMatrix=!0,s.insertBelow(e),o&&(s.selected=!0),n--}}},N=function(e,t,o){if(0===e.length)return;const n=[];for(let o=0;o<e.length;o++){const i=e[o];L(i)&&!i.data.isPGTextItem&&(A(i,!1,t),i.hasChildren()||n.push(i))}t&&t();for(let e=0;e<n.length;e++)n[e].remove();o&&o()},U=function(e,t,o){const n=le();re(e),N(n,t,o)},z=function(){const e=le();for(let t=0;t<e.length;t++){const o=e[t];if(L(o)&&!o.data.isPGTextItem&&o.children&&o.children.length>0)return!0}return!1},F=function(e){return e&&"CompoundPath"===e.className},H=function(e){return!!e.parent&&"CompoundPath"===e.parent.className},q=function(e){const t=e.parent;return F(t)?t:null},G=.3902628565,j=function(e,t,o){const n=Math.abs(e.x-t.x),i=Math.abs(e.y-t.y);return n<o&&i<o},V=function(e,t){let o=Math.atan2(e.y,e.x);o=Math.round(o/t)*t;const n=Math.cos(o),s=Math.sin(o),a=n*e.x+s*e.y;return new i.a.Point(n*a,s*a)},W=function(e){let t=e,o=0;for(;!(t instanceof i.a.Layer);){if(o++,null===t.parent)return null;t=t.parent}return o},K=function(e,t){if(null===e||null===t)return null;let o=e,n=t,s=W(e),a=W(t);for(;a>s;)n=n.parent,a--;for(;s>a;)o=o.parent,s--;for(;o&&n;){if(n===o)return 0;if(n.parent===o.parent)return n.parent instanceof i.a.CompoundPath?Math.abs(n.area)-Math.abs(o.area):parseFloat(o.index)-parseFloat(n.index);n=n.parent,o=o.parent}return null},X=function(e,t){const o=e.position;let n=e.area;for(const i of e.segments){const s=i.point.subtract(o).normalize().multiply(t);i.point=i.point.add(s),e.area<n&&(i.point=i.point.subtract(s.multiply(2))),n=e.area}},$=function(e,t){if(e instanceof i.a.Group)for(const o of e.children)$(o,t);else t(e)},Y=function(e){$(e,e=>{e instanceof i.a.PathItem&&(e.clockwise=!0)})},Z=function(e,t,o){$(e,e=>{e instanceof i.a.PointText||e.strokeWidth&&(e.strokeWidth=e.strokeWidth*t)}),e.scale(t,o)},J=function(e,t){let o=t.x-e.x,n=t.y-e.y;o=o||1,n=n||1;const s=t.subtract(e).abs(),a=Math.max(s.x,s.y),r=new i.a.Point(a*o/Math.abs(o),a*n/Math.abs(n)),l=e.add(r.multiply(.5));return{size:r,position:l}},Q=function(e){const t={...e,match:function(t){return!(t instanceof i.a.Layer)&&t.layer.data&&t.layer.data.isPaintingLayer&&!t.locked&&!t.isClipMask()&&!(t.data&&t.data.isHelperItem)&&(!e.match||e.match(t))}};return i.a.project.getItems(t)},ee=function(e){e=e||!1;const t=[];for(const o of i.a.project.layers)for(const n of o.children)!e&&n.guide||t.push(n);return t},te=function(){const e=ee(),t=[];for(let o=0;o<e.length;o++)e[o].data&&!e[o].data.isHelperItem&&t.push(e[o]);return t},oe=function(e,t){if(e.children)for(let o=0;o<e.children.length;o++){const n=e.children[o];n.children&&n.children.length>0?oe(n,t):n.fullySelected=t}else for(let o=0;o<e.segments.length;o++)e.segments[o].selected=t},ne=function(e,t,o){if(e.fullySelected=o,e.selected=t,F(e)||L(e)){const n=e.children;if(n)for(const e of n)L(e)?ne(e,t,o):(e.fullySelected=o,e.selected=t)}},ie=function(e,t,o){const n=function(e){const t=e.parent;return L(t)?t:null}(e),i=q(e);if(n)ie(n,t,o);else if(i)ne(i,t,o);else{if(e.data&&e.data.noSelect)return;ne(e,t,o)}},se=function(){const e=te();if(0===e.length)return!1;for(let t=0;t<e.length;t++)ie(e[t],!0);return!0},ae=function(){const e=te();if(0===e.length)return!1;for(let t=0;t<e.length;t++)oe(e[t],!0);return!0},re=function(e){i.a.project.deselectAll(),e()},le=function(){const e=te(),t=[];for(const o of e)if(o.selected)t.push(o);else if(o instanceof i.a.CompoundPath)for(const e of o.children)if(e.selected){t.push(o);break}return t.sort((e,t)=>parseFloat(e.index)-parseFloat(t.index)),t},ce=function(){const e=i.a.project.selectedItems,t=[];for(let o=0;o<e.length;o++){const n=e[o];n instanceof i.a.Layer||L(n)||!n.data||n.data.isSelectionBound||t.push(n)}return t.sort(K),t},de=function(){const e=ce(),t=[];for(const o of e)if(o.segments)for(const e of o.segments)e.selected&&t.push(e);return t},he=function(e,t){if(0===e.length)return!1;for(let t=0;t<e.length;t++)e[t].remove();return t(),!0},pe=function(e,t){if(e===E.RESHAPE){const e=ce();return!!function(e,t){const o=[];for(let t=0;t<e.length;t++){if(!e[t].segments)continue;const n=e[t].segments;for(let e=0;e<n.length;e++){const t=n[e];t.selected&&o.push(t)}}let n=!1;for(let e=0;e<o.length;e++){o[e].remove(),n=!0}return n&&t(),n}(e,t)||he(e,t)}const o=le();return he(o,t)},ue=function(e,t){const o=e?ce():le();for(let e=0;e<o.length;e++){const t=o[e];t.clone(),t.selected=!1}t()},me=function(e,t,o,n,s){if(function(e){return"Path"===e.className}(e)){let i=!1;for(let a=0;a<e.segments.length;a++){const r=e.segments[a];if(o.contains(r.point)){if(n!==E.RESHAPE)return t.modifiers.shift&&e.selected?ie(s,!1):ie(s,!0,!0),!1;t.modifiers.shift&&r.selected?r.selected=!1:r.selected=!0,i=!0}}const a=e.getIntersections(o);if(a.length>0&&!i){if(n!==E.RESHAPE)return t.modifiers.shift&&e.selected?ie(e,!1):ie(e,!0),!1;for(let e=0;e<a.length;e++){const o=a[e].curve;e%2!=1&&(t.modifiers.shift?o.selected=!o.selected:o.selected=!0)}}}else if(k(e)&&function(e,t,o){const n=new i.a.Path([t.localToGlobal(t.internalBounds.topLeft),t.localToGlobal(t.internalBounds.topRight),t.localToGlobal(t.internalBounds.bottomRight),t.localToGlobal(t.internalBounds.bottomLeft)]);n.closed=!0,n.guide=!0;for(let i=0;i<n.segments.length;i++){const s=n.segments[i];if(e.contains(s.point)||0===i&&e.getIntersections(n).length>0)return o.modifiers.shift&&t.selected?ie(t,!1):ie(t,!0),n.remove(),!0}n.remove()}(o,e,t))return!1;return!0},fe=function(e,t,o,n,i){for(let s=0;s<e.children.length;s++){const a=e.children[s];L(a)||O(a)?fe(a,t,o,n,i):me(a,n,t,i,o)}return!0},ge=function(e,t,o){const n=te();for(let i=0;i<n.length;i++){const s=n[i];o===E.RESHAPE&&_(R(s))||(L(s)||O(s)?fe(s,t,s,e,o):me(s,e,t,o,s))}},be=function(){const e=ce();for(const t of e){if(H(t)){const e=q(t);ie(e,!0,!0)}const e=R(t);t!==e&&ie(e,!0,!0)}},ve=function(e){e.strokeWidth=1/i.a.view.zoom,e.opacity=1,e.blendMode="normal",e.guide=!0},we=function(e){const t=e.segments,o=new i.a.Path(t);return ve(o),e.closed&&(o.closed=!0),o.parent=Dt(),o.position=e.position,o.strokeColor="#009dec",o.fillColor=null,o.data.isHelperItem=!0,o.data.origItem=e,o.bringToFront(),o},Se=function(e,t){let o=e.internalBounds;t&&(o=o.expand(t));const n=new i.a.Path.Rectangle(o);return n.matrix=e.matrix,ve(n),n.parent=Dt(),n.strokeColor="#009dec",n.fillColor=null,n.data.isHelperItem=!0,n.data.origItem=e,n.bringToFront(),n},Ce=function(e,t){const o=new i.a.Point(.5/i.a.view.zoom,.5/i.a.view.zoom),n=e.downPoint.add(o),s=e.point.add(o),a=new i.a.Path.Rectangle(n,s),r=1/i.a.view.zoom;return ve(a),t||(t="#aaaaaa"),a.parent=Dt(),a.strokeColor=t,a.data.isRectSelect=!0,a.data.isHelperItem=!0,a.dashArray=[3*r,3*r],a},Ie=function(){return"#009dec"},xe=function(e){const t=ee(!0);for(const o of t)for(const t of e)o.data&&o.data[t]&&o.remove()},Te=function(){xe(["isSelectionBound","isRotHandle","isScaleHandle"])},ye=function(){xe(["isRotHandle","isScaleHandle"])},Me=function(){xe(["isHitPoint"])},Ee=function(e){if(Me(),e){const t=i.a.Path.Circle(e,4/i.a.view.zoom);t.strokeWidth=1/i.a.view.zoom,t.strokeColor="#009dec",t.fillColor=new i.a.Color(1,1,1,.5),t.parent=Dt(),t.data.isHitPoint=!0,t.data.isHelperItem=!0}};var Re=o(86);const ke=function(e,t,o){let n=~~e.x;const i=~~t.x;let s=~~e.y;const a=~~t.y,r=Math.abs(i-n),l=Math.abs(a-s),c=n<i?1:-1,d=s<a?1:-1;let h=r-l;for(o(n,s);n!==i||s!==a;){const e=2*h;e>-l&&(h-=l,n+=c),e<r&&(h+=r,s+=d),o(n,s)}},Oe=function(e,t,o){const n=(-t+Math.sqrt(t*t-4*e*o))/2/e,i=(-t-Math.sqrt(t*t-4*e*o))/2/e;return n>i?[n,i]:[i,n]},De=function(e,t){const o=~~e.centerX,n=~~e.centerY,i=~~Math.abs(e.radiusX)-.5,s=~~Math.abs(e.radiusY)-.5,a=e.shearSlope,r=e.isFilled,l=e.drawFn;if(a===1/0||i<1||s<1)return!1;const c=1/i/i+a*a/s/s,d=-2*a/s/s,h=1/s/s,p=(-2*c-d)/(2*h+d),u=(-2*c+d)/(-2*h+d),m=function(e,i){let s,a,p,u=e,m=Oe(c,d*u,h*u*u-1);for(;i(m[0],u);)s=Math.floor(u),a=Math.floor(m[0]),p=Math.floor(m[1]),r?(t.fillRect(o-a-1,n+s,a-p+1,1),t.fillRect(o+p,n-s-1,a-p+1,1)):(l(o-a-1,n+s),l(o+a,n-s-1)),u--,m=Oe(c,d*u,h*u*u-1);return a||s?{x:a,y:s}:null},f=function(e,i){let s,a,p,u=e,m=Oe(h,d*u,c*u*u-1);for(;i(u,m[0]);)s=Math.floor(u),a=Math.floor(m[0]),p=Math.floor(m[1]),r?(t.fillRect(o-s-1,n+p,1,a-p+1),t.fillRect(o+s,n-a-1,1,a-p+1)):(l(o-s-1,n+a),l(o+s,n-a-1)),u++,m=Oe(h,d*u,c*u*u-1);return s||a?{x:s,y:a}:null};let g;if(p>u){let e=!1;p>0&&(e=!0),g=m(e?-s:s,(e,t)=>0===e&&t>0||!(0===e&&t<0)&&t/e>p),g=f(g?.5-g.x:.5,(e,t)=>t/e>u)||{x:-g.x-.5,y:-g.y-.5},m(g.y-.5,(t,o)=>e?o>-s:o>s)}else g=f(.5,(e,t)=>t/e>u),g=m(g?g.y-.5:s,(e,t)=>0===e&&t>0||!(0===e&&t<0)&&t/e>p)||g,f(.5-g.x,e=>e<0);return!0},Pe=function(e,t,o){e=~~e;const n=document.createElement("canvas"),i=Math.ceil(e/2);n.width=2*i,n.height=2*i;const s=n.getContext("2d");if(s.imageSmoothingEnabled=!1,s.fillStyle=o?"white":t,e<=5){let t=0;e%2&&(t=1),o?(s.fillStyle=Ie(),s.fillRect(t,t,e,e),s.fillStyle="white",s.fillRect(t+1,t+1,e-2,e-2)):s.fillRect(t,t,e,e)}else De({centerX:e/2,centerY:e/2,radiusX:e/2,radiusY:e/2,shearSlope:0,isFilled:!0},s),o&&(s.fillStyle=Ie(),De({centerX:e/2,centerY:e/2,radiusX:e/2,radiusY:e/2,shearSlope:0,isFilled:!1,drawFn:(e,t)=>s.fillRect(e,t,1,1)},s));return n},_e=function(e,t,o){for(let n=0;n<t;++n)if(0!==e.data[(o*t<<2)+(n<<2)+3])return!1;return!0},Le=function(e,t,o,n,i){for(let s=n;s<i;++s)if(0!==e.data[(s*t<<2)+(o<<2)+3])return!1;return!0},Be=function(e,t){const o=t||e.bounds,n=o.width,s=e.getImageData(o);let a=0,r=s.height,l=0,c=s.width;for(;a<r&&_e(s,n,a);)++a;for(;r-1>a&&_e(s,n,r-1);)--r;for(;l<c&&Le(s,n,l,a,r);)++l;for(;c-1>l&&Le(s,n,c-1,a,r);)--c;return a===r&&(a=r=s.height/2),l===c&&(l=c=s.width/2),new i.a.Rectangle(l+o.left,a+o.top,c-l,r-a)},Ae=function(e){const t=function(e){const t=Be(e);return t.width&&t.height?e.getSubRaster(Be(e)):null}(yt());return t?(e?i.a.project.activeLayer.addChild(t):t.remove(),t):null},Ne=function(e,t){re(e);const o=_t(!0),n=i.a.project.activeLayer.drawnBounds,s=i.a.project.exportSVG({bounds:"content",matrix:(new i.a.Matrix).translate(-n.x,-n.y)});Lt(o),s.setAttribute("shape-rendering","crispEdges");let a=(new XMLSerializer).serializeToString(s);a=Object(Re.inlineSvgFonts)(a);const r=new Image;r.onload=()=>{r.width&&r.height&&yt().drawImage(r,new i.a.Point(Math.floor(n.topLeft.x),Math.floor(n.topLeft.y)));for(let e=i.a.project.activeLayer.children.length-1;e>=0;e--){const t=i.a.project.activeLayer.children[e];!1===t.clipMask?t.remove():(t.size.height=nt,t.size.width=ot,t.setPosition(it))}t(!1,S.BITMAP)},r.onerror=()=>{const e=i.a.project.activeLayer.rasterize(72,!1);e.onLoad=()=>{e.canvas.width&&e.canvas.height&&yt().drawImage(e.canvas,e.bounds.topLeft),i.a.project.activeLayer.removeChildren(),t(!1,S.BITMAP)}},r.src=`data:image/svg+xml;utf8,${encodeURIComponent(a)}`},Ue=function(e,t){re(e);for(const e of i.a.project.activeLayer.children)!0===e.clipMask&&(e.size.height=rt.height,e.size.width=rt.width,e.setPosition(it));Ae(!0),Tt(),t(!1,S.VECTOR)},ze=function(e,t,o){return o.getImageData(e,t,1,1).data},Fe=function(e,t,o,n){const i=4*(t*o.width+e);return o.data[i+0]===n[0]&&o.data[i+1]===n[1]&&o.data[i+2]===n[2]&&o.data[i+3]===n[3]},He=function(e,t,o,n){const i=4*(t*o.width+e);o.data[i+0]=n[0],o.data[i+1]=n[1],o.data[i+2]=n[2],o.data[i+3]=n[3]},qe=function(e,t,o,n,i,s,a){for(;t>0&&Fe(e,t-1,o,s);)t--;let r=!1,l=!1;for(;t<o.height&&Fe(e,t,o,s);t++)He(e,t,o,i),He(e,t,n,i),e>0&&(Fe(e-1,t,o,s)?r||(a.push([e-1,t]),r=!0):r=!1),e<o.width-1&&(Fe(e+1,t,o,s)?l||(a.push([e+1,t]),l=!0):l=!1)},Ge=function(e){const t=document.createElement("canvas");t.width=1,t.height=1;const o=t.getContext("2d");return o.fillStyle=e,o.fillRect(0,0,1,1),o.getImageData(0,0,1,1).data},je=function(e,t,o,n,i){e=~~e,t=~~t;const s=Ge(o),a=ze(e,t,n),r=n.getImageData(0,0,n.canvas.width,n.canvas.height);let l=r;if(i!==n&&(l=new ImageData(n.canvas.width,n.canvas.height)),a[0]===s[0]&&a[1]===s[1]&&a[2]===s[2]&&a[3]===s[3])return!1;const c=[[e,t]];for(;c.length;){const e=c.pop();qe(e[0],e[1],r,l,s,a,c)}return i.putImageData(l,0,0),!0},Ve=function(e,t,o,n,i){e=~~e,t=~~t;const s=Ge(o),a=ze(e,t,n),r=n.getImageData(0,0,n.canvas.width,n.canvas.height);let l=r;if(i!==n&&(l=new ImageData(n.canvas.width,n.canvas.height)),a[0]===s[0]&&a[1]===s[1]&&a[2]===s[2]&&a[3]===s[3])return!1;for(let e=0;e<r.width;e++)for(let t=0;t<r.height;t++)Fe(e,t,r,a)&&He(e,t,l,s);return i.putImageData(l,0,0),!0},We=function(e,t){if(0===e.matrix.b&&0===e.matrix.c){const o=e.size.width*e.matrix.a,n=e.size.height*e.matrix.d;return void t.fillRect(Math.round(e.matrix.tx-o/2),Math.round(e.matrix.ty-n/2),Math.round(o),Math.round(n))}const o=e.matrix.transform(new i.a.Point(-e.size.width/2,-e.size.height/2)),n=e.matrix.transform(new i.a.Point(e.size.width/2,-e.size.height/2)),s=e.matrix.transform(new i.a.Point(-e.size.width/2,e.size.height/2)),a=e.matrix.transform(new i.a.Point(e.size.width/2,e.size.height/2)),r=e.matrix.transform(new i.a.Point),l=[o,n,s,a].sort((e,t)=>e.x-t.x),c=(e,t,o)=>t.x===e.x?r.x>e.x?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY:(t.y-e.y)/(t.x-e.x)*(o-e.x)+e.y;for(let e=Math.round(l[0].x);e<Math.round(l[3].x);e++){const i=[c(o,n,e+.5),c(o,s,e+.5),c(a,n,e+.5),c(a,s,e+.5)].sort((e,t)=>e-t);t.fillRect(e,Math.round(i[1]),1,Math.max(1,Math.round(i[2])-Math.round(i[1])))}},Ke=function(e){const t=xt(e.width,e.height),o=t.getContext("2d");return o.save(),o.scale(-1,1),o.drawImage(e,0,0,-t.width,t.height),o.restore(),t},Xe=function(e){const t=xt(e.width,e.height),o=t.getContext("2d");return o.save(),o.scale(1,-1),o.drawImage(e,0,0,t.width,-t.height),o.restore(),t},$e=function(e,t){let o=xt(Math.round(e.width*Math.abs(t.x)),e.height);return t.x<0&&(e=Ke(e)),o.getContext("2d").drawImage(e,0,0,o.width,o.height),o=xt((e=o).width,Math.round(e.height*Math.abs(t.y))),t.y<0&&(e=Xe(e)),o.getContext("2d").drawImage(e,0,0,o.width,o.height),o},Ye=function(e,t){e.matrix.isInvertible()&&(function(e){const t=e.matrix.decompose();Math.abs(t.scaling.x)<1&&Math.abs(t.scaling.y)<1&&0!==t.scaling.x&&0!==t.scaling.y&&(e.canvas=$e(e.canvas,t.scaling),e.data&&e.data.expanded&&(e.data.expanded.canvas=$e(e.data.expanded.canvas,t.scaling)),e.matrix.append((new i.a.Matrix).scale(new i.a.Point(1/t.scaling.x,1/t.scaling.y))))}(e),function(e,t){const o=xt(),n=o.getContext("2d"),s=new i.a.Shape.Rectangle(new i.a.Point,e.size);s.matrix=e.matrix,We(s,n),s.remove(),n.globalCompositeOperation="source-in";const a=e.matrix;n.transform(a.a,a.b,a.c,a.d,a.tx,a.ty);let r=e.canvas;e.data&&e.data.expanded&&(r=e.data.expanded.canvas),n.transform(1,0,0,1,-r.width/2,-r.height/2),n.drawImage(r,0,0),t.drawImage(o,new i.a.Point)}(e,t))},Ze=function(e,t){const o=Math.abs(e.size.width/2),n=Math.abs(e.size.height/2),s=t.getContext("2d"),a=0===e.strokeWidth,r=a?e.fillColor:e.strokeColor;if(r)return s.fillStyle=r.toCSS(),function(e,t){const o=e.position.x,n=e.position.y,i=e.radiusX,s=e.radiusY,a=e.matrix,r=e.isFilled,l=e.thickness;let c=null;if(!a.isInvertible())return!1;const d=a.clone().invert();if(!r){const e=Pe(l,t.fillStyle),o=Math.ceil(l/2);c=(n,i)=>{t.drawImage(e,~~n-o,~~i-o)}}const h=d.a*d.a/i/i+d.b*d.b/s/s,p=2*d.a*d.c/i/i+2*d.b*d.d/s/s,u=d.c*d.c/i/i+d.d*d.d/s/s,m=1/Math.sqrt(u),f=Math.sqrt(-4*u/(p*p-4*h*u));return De({centerX:o,centerY:n,radiusX:f,radiusY:m,shearSlope:p/2/u,isFilled:r,drawFn:c},t)}({position:e.position,radiusX:o,radiusY:n,matrix:e.matrix,isFilled:a,thickness:e.strokeWidth/i.a.view.zoom},s)},Je=function(e,t){const o=xt(),n=o.getContext("2d"),s=0===e.strokeWidth,a=s?e.fillColor:e.strokeColor;a&&(n.fillStyle=a.toCSS(),s?We(e,n):function(e,t,o){const n=Pe(t,o.fillStyle),s=Math.ceil(t/2),a=(e,t)=>{o.drawImage(n,~~e-s,~~t-s)},r=e.matrix.transform(new i.a.Point(-e.size.width/2,-e.size.height/2)),l=e.matrix.transform(new i.a.Point(e.size.width/2,-e.size.height/2)),c=e.matrix.transform(new i.a.Point(-e.size.width/2,e.size.height/2)),d=e.matrix.transform(new i.a.Point(e.size.width/2,e.size.height/2));ke(r,l,a),ke(r,c,a),ke(d,l,a),ke(d,c,a)}(e,e.strokeWidth/i.a.view.zoom,n),t.drawImage(o,new i.a.Point))},Qe=function(e){re(e);const t=Ae(!0);t&&(t.selected=!0),Tt()},et=480,tt=360,ot=2*et,nt=2*tt,it=new i.a.Point(ot/2,nt/2),st=.333,at=new i.a.Rectangle(0,0,ot,nt),rt=new i.a.Rectangle(-ot/4,-nt/4,1.5*ot,1.5*nt);let lt=at;const ct=()=>lt,dt=e=>{const t=ee();let o=at;e||(o=o.unite(i.a.view.bounds));for(const e of t)o=o.unite(e.bounds.expand(50));o=o.intersect(rt.expand(50));let n=o.top,s=o.left,a=o.bottom,r=o.right,l=0,c=0;o.width<i.a.view.bounds.width&&(l=(i.a.view.bounds.width-o.width)/2,s-=l,r+=l),o.height<i.a.view.bounds.height&&(c=(i.a.view.bounds.height-o.height)/2,n-=c,a+=c),lt=new i.a.Rectangle(s,n,r-s,a-n)},ht=()=>{const{left:e,right:t,top:o,bottom:n}=i.a.project.view.bounds;e<lt.left&&i.a.project.view.scrollBy(new i.a.Point(lt.left-e,0)),o<lt.top&&i.a.project.view.scrollBy(new i.a.Point(0,lt.top-o)),n>lt.bottom&&i.a.project.view.scrollBy(new i.a.Point(0,lt.bottom-n)),t>lt.right&&i.a.project.view.scrollBy(new i.a.Point(lt.right-t,0)),dt()},pt=()=>{Mt()&&Mt().dragCrosshair&&Mt().dragCrosshair.scale(wt/Mt().dragCrosshair.bounds.width/i.a.view.zoom),Et()&&Et().dragCrosshair&&Et().dragCrosshair.scale(wt/Et().dragCrosshair.bounds.width/i.a.view.zoom)},ut=(e,t)=>{const o=i.a.view,n=o.center,s=Math.max(st,o.zoom+e),a=o.zoom/s,r=t.subtract(n),l=t.subtract(r.multiply(a)).subtract(n);o.zoom=s,o.translate(l.multiply(-1)),dt(!0),ht(),pt()},mt=e=>{let t;const o=le();if(o.length>0){let e=null;for(const t of o)e=e?e.unite(t.bounds):t.bounds;t=e.center}else t=i.a.project.view.center;ut(e,t)},ft=()=>{i.a.project.view.zoom=.5,dt(!0),pt(),ht()},gt=(e,t)=>{i.a.project.view.scrollBy(new i.a.Point(e,t)),ht()},bt=e=>e?at:i.a.view.bounds.unite(at).intersect(rt),vt=e=>{let t;if(ft(),e)t=Be(yt()).expand(50);else{const e=ee();for(const o of e)t=t?t.unite(o.bounds):o.bounds}if(t&&t.width&&t.height){const e=i.a.view.element;let o=i.a.view.zoom*Math.max(1.5*t.width/e.clientWidth,1.5*t.height/e.clientHeight);o=Math.max(Math.min(1,o),.125),o<1&&(i.a.view.center=t.center,i.a.view.zoom=i.a.view.zoom/o,pt(),ht())}else c.warn("No bounds!")},wt=16,St=.75,Ct=function(e){for(const t of i.a.project.layers)if(t.data&&t.data[e])return t},It=function(){return Ct("isPaintingLayer")},xt=function(e,t){const o=document.createElement("canvas");return o.width=e||ot,o.height=t||nt,o.getContext("2d").imageSmoothingEnabled=!1,o},Tt=function(){const e=Ct("isRasterLayer");e.removeChildren();const t=new i.a.Raster(xt());t.canvas.getContext("2d").imageSmoothingEnabled=!1,t.parent=e,t.guide=!0,t.locked=!0,t.position=it},yt=function(){return 0===Ct("isRasterLayer").children.length&&Tt(),Ct("isRasterLayer").children[0]},Mt=function(){return Ct("isDragCrosshairLayer")},Et=function(){return Ct("isBackgroundGuideLayer")},Rt=function(e,t){e.bitmapBackground.visible=I(t),e.vectorBackground.visible=C(t)},kt=function(e){Rt(Et(),e)},Ot=function(){const e=new i.a.Layer;return e.data.isGuideLayer=!0,e},Dt=function(){let e=Ct("isGuideLayer");return e||(e=Ot(),It().activate()),e},Pt=function(e){if(e.locked=!0,e.guide=!0,D(e))for(let t=0;t<e.children.length;t++)Pt(e.children[t])},_t=function(e){const t=Et(),o=Mt(),n=Ct("isOutlineLayer"),i=Dt();let s;return o.remove(),n.remove(),i.remove(),t.remove(),e&&(s=Ct("isRasterLayer"),s.remove()),{dragCrosshairLayer:o,outlineLayer:n,guideLayer:i,backgroundGuideLayer:t,rasterLayer:s}},Lt=function(e){const t=e.backgroundGuideLayer,o=e.dragCrosshairLayer,n=e.outlineLayer,s=e.guideLayer,a=e.rasterLayer;a&&!a.index&&(i.a.project.addLayer(a),a.sendToBack()),t.index||(i.a.project.addLayer(t),t.sendToBack()),o.index||(i.a.project.addLayer(o),o.bringToFront()),n.index||(i.a.project.addLayer(n),n.bringToFront()),s.index||(i.a.project.addLayer(s),s.bringToFront()),i.a.project.activeLayer!==It()&&(c.error("Wrong active layer"),c.error(i.a.project.activeLayer.data))},Bt=function(e,t,o,n){let s=0,a=0;const r=[];for(;s<e;)r.push(new i.a.Point(s,a)),s++,r.push(new i.a.Point(s,a)),a=0===a?t:0;for(a=t-1,s=e;a>0;)r.push(new i.a.Point(s,a)),s=0===s?e:0,r.push(new i.a.Point(s,a)),a--;const l=new i.a.Shape.Rectangle(new i.a.Point(0,0),new i.a.Point(ot/8,nt/8));l.fillColor="#fff",l.guide=!0,l.locked=!0,l.position=it;const c=new i.a.Path(r);c.fillRule="evenodd",c.fillColor=o,c.opacity=n,c.guide=!0,c.locked=!0,c.position=it;const d=new i.a.Shape.Rectangle(rt);d.position=it,d.guide=!0,d.locked=!0,d.scale(1/8);const h=new i.a.Group([l,c,d]);return d.clipMask=!0,h},At=function(e,t){const o=new i.a.Group,n=new i.a.Path.Line(new i.a.Point(0,-7),new i.a.Point(0,7));n.strokeWidth=6,n.strokeColor="white",n.strokeCap="round",o.addChild(n);const s=new i.a.Path.Line(new i.a.Point(-7,0),new i.a.Point(7,0));s.strokeWidth=6,s.strokeColor="white",s.strokeCap="round",o.addChild(s);const a=new i.a.Shape.Circle(new i.a.Point(0,0),5.5);a.strokeWidth=6,a.strokeColor="white",o.addChild(a);const r=new i.a.Path.Line(new i.a.Point(0,-7),new i.a.Point(0,7));r.strokeWidth=2,r.strokeColor="black",r.strokeCap="round",o.addChild(r);const l=new i.a.Path.Line(new i.a.Point(-7,0),new i.a.Point(7,0));l.strokeWidth=2,l.strokeColor="black",l.strokeCap="round",o.addChild(l);const c=new i.a.Shape.Circle(new i.a.Point(0,0),5.5);c.strokeWidth=2,c.strokeColor="black",o.addChild(c),Pt(o),o.position=it,o.opacity=e,o.parent=t,o.applyMatrix=!1,t.dragCrosshair=o,o.scale(wt/o.bounds.width/i.a.view.zoom)},Nt=function(e){const t=function(e){const t=new i.a.Layer;t.locked=!0;const o=new i.a.Shape.Rectangle(rt);o.fillColor="#ECF1F9",o.position=it;const n=Bt(rt.width/8,rt.height/8+1,"#0062ff",.05);n.position=it,n.scaling=new i.a.Point(8,8);const s=new i.a.Group;s.addChild(o),s.addChild(n),Pt(s),t.vectorBackground=s;const a=Bt(ot/8,nt/8,"#0062ff",.05);return a.position=it,a.scaling=new i.a.Point(8,8),a.guide=!0,a.locked=!0,t.bitmapBackground=a,Rt(t,e),At(.16,t),t.data.isBackgroundGuideLayer=!0,t}(e);!function(){const e=new i.a.Layer;e.data.isRasterLayer=!0,Tt()}();const o=function(){const e=new i.a.Layer;return e.data.isPaintingLayer=!0,e}(),n=function(){const e=new i.a.Layer;return At(St,e),e.data.isDragCrosshairLayer=!0,e.visible=!1,e}(),s=function(){const e=new i.a.Layer,t=new i.a.Shape.Rectangle(at.expand(1));t.strokeWidth=2,t.strokeColor="white",Pt(t);const o=new i.a.Shape.Rectangle(at.expand(5));return o.strokeWidth=2,o.strokeColor="#4280D7",o.opacity=.25,Pt(o),e.data.isOutlineLayer=!0,e}(),a=Ot();t.sendToBack(),n.bringToFront(),s.bringToFront(),a.bringToFront(),o.activate()},Ut=function(e,t){t||c.error("Format must be specified.");const o=_t();e({json:i.a.project.exportJSON({asString:!1}),paintEditorFormat:t}),Lt(o)},zt=function(e,t,o,n){for(let e=i.a.project.layers.length-1;e>=0;e--){const t=i.a.project.layers[e];t.data.isBackgroundGuideLayer||t.data.isDragCrosshairLayer||t.data.isOutlineLayer||(t.removeChildren(),t.remove())}i.a.project.importJSON(e.json),t();const s=[],a=()=>{if(yt().loaded){for(const e of s)if(!e.loaded)return;o(!0)}};if(n){const e=ce();1===e.length&&e[0]instanceof i.a.Raster&&(s.push(e[0]),e[0].data&&e[0].data.expanded instanceof i.a.Raster&&s.push(e[0].data.expanded))}yt().onLoad=a;for(const e of s)e.onLoad=a,e.loaded&&e.onLoad()},Ft=function(e,t,o,n){if(e.pointer>0){const i=e.stack[e.pointer-1];zt(i,o,n,I(i.paintEditorFormat)),t(C(i.paintEditorFormat)?S.VECTOR_SKIP_CONVERT:I(i.paintEditorFormat)?S.BITMAP_SKIP_CONVERT:null)}},Ht=function(e,t,o,n){if(e.pointer>=0&&e.pointer<e.stack.length-1){const i=e.stack[e.pointer+1];zt(i,o,n,I(i.paintEditorFormat)),t(C(i.paintEditorFormat)?S.VECTOR_SKIP_CONVERT:I(i.paintEditorFormat)?S.BITMAP_SKIP_CONVERT:null)}},qt=function(e){return e.pointer>0},Gt=function(e){return e.pointer>-1&&e.pointer!==e.stack.length-1},jt="scratch-paint/undo/UNDO",Vt="scratch-paint/undo/REDO",Wt="scratch-paint/undo/SNAPSHOT",Kt="scratch-paint/undo/CLEAR",Xt={stack:[],pointer:-1},$t=function(e){return{type:Wt,snapshot:e}},Yt="scratch-paint/select/CHANGE_SELECTED_ITEMS",Zt=[],Jt=function(e,t){return{type:Yt,selectedItems:e,bitmapMode:t}},Qt=function(){return{type:Yt,selectedItems:[]}},eo="scratch-paint/hover/CHANGE_HOVERED",to=function(e){return{type:eo,hoveredItemId:e}},oo=function(){return{type:eo,hoveredItemId:null}},no="scratch-paint/clipboard/SET",io={items:[],pasteOffset:0},so=function(e){return{type:"scratch-paint/formats/CHANGE_FORMAT",format:e}},ao=new i.a.Matrix,ro=function(e){return{type:"scratch-paint/view/UPDATE_VIEW_BOUNDS",viewBounds:e.clone()}},lo={};var co=o(897),ho=o.n(co);class po extends h.a.Component{constructor(e){super(e),b()(this,["clearQueuedImport","setCanvas","importSvg","initializeSvg","maybeZoomToFit","switchCostume","onViewResize","recalibrateSize"])}componentDidMount(){i.a.setup(this.canvas),i.a.view.on("resize",this.onViewResize),ft(),this.props.zoomLevelId?(this.props.setZoomLevelId(this.props.zoomLevelId),this.props.zoomLevels[this.props.zoomLevelId]?this.shouldZoomToFit=this.props.zoomLevels[this.props.zoomLevelId]:this.shouldZoomToFit=!0):this.props.updateViewBounds(i.a.view.matrix);const e=this.canvas.getContext("2d");e.webkitImageSmoothingEnabled=!1,e.imageSmoothingEnabled=!1,i.a.settings.handleSize=0,Nt(this.props.format),this.importImage(this.props.imageFormat,this.props.image,this.props.rotationCenterX,this.props.rotationCenterY)}componentWillReceiveProps(e){this.props.imageId!==e.imageId&&this.switchCostume(e.imageFormat,e.image,e.rotationCenterX,e.rotationCenterY,this.props.zoomLevelId,e.zoomLevelId),this.props.format!==e.format&&(this.recalibrateSize(),kt(e.format))}componentWillUnmount(){this.clearQueuedImport(),this.shouldZoomToFit||this.props.saveZoomLevel(),i.a.remove()}clearQueuedImport(){this.queuedImport&&(window.clearTimeout(this.queuedImport),this.queuedImport=null),this.queuedImageToLoad&&(this.queuedImageToLoad.src="",this.queuedImageToLoad.onload=null,this.queuedImageToLoad=null)}switchCostume(e,t,o,n,s,a){s&&s!==a&&this.props.saveZoomLevel(),a&&s!==a&&(this.props.zoomLevels[a]?this.shouldZoomToFit=this.props.zoomLevels[a]:this.shouldZoomToFit=!0,this.props.setZoomLevelId(a));for(const e of i.a.project.layers)e.data.isRasterLayer?Tt():e.data.isBackgroundGuideLayer||e.data.isDragCrosshairLayer||e.data.isOutlineLayer||e.removeChildren();this.props.clearUndo(),this.props.clearSelectedItems(),this.props.clearHoveredItem(),this.props.clearPasteOffset(),this.importImage(e,t,o,n)}importImage(e,t,o,n){if(this.clearQueuedImport(),!t)return this.props.changeFormat(S.VECTOR_SKIP_CONVERT),Ut(this.props.undoSnapshot,S.VECTOR_SKIP_CONVERT),void this.recalibrateSize();if("jpg"===e||"png"===e){this.props.changeFormat(S.BITMAP_SKIP_CONVERT);const e=new i.a.Shape.Rectangle(yt().getBounds());e.guide=!0,e.locked=!0,e.setPosition(it),e.clipMask=!0;const s=new Image;this.queuedImageToLoad=s,s.onload=()=>{this.queuedImageToLoad&&(this.queuedImageToLoad=null,yt().drawImage(s,ot/2-o,nt/2-n),yt().drawImage(s,ot/2-o,nt/2-n),this.maybeZoomToFit(!0),Ut(this.props.undoSnapshot,S.BITMAP_SKIP_CONVERT),this.recalibrateSize())},s.src=t}else"svg"===e?(this.props.changeFormat(S.VECTOR_SKIP_CONVERT),this.importSvg(t,o,n)):(c.error(`Didn't recognize format: ${e}. Use 'jpg', 'png' or 'svg'.`),this.props.changeFormat(S.VECTOR_SKIP_CONVERT),Ut(this.props.undoSnapshot,S.VECTOR_SKIP_CONVERT),this.recalibrateSize())}maybeZoomToFit(e){this.shouldZoomToFit instanceof i.a.Matrix?(i.a.view.matrix=this.shouldZoomToFit,this.props.updateViewBounds(i.a.view.matrix),pt()):!0===this.shouldZoomToFit&&vt(e),this.shouldZoomToFit=!1,dt(),this.props.updateViewBounds(i.a.view.matrix)}importSvg(e,t,o){const n=this,s=(e=(e=e.split(/<\s*svg:/).join("<")).split(/<\/\s*svg:/).join("</")).match(/<svg [^>]*>/);s&&-1===s[0].indexOf("xmlns=")&&(e=e.replace("<svg ",'<svg xmlns="http://www.w3.org/2000/svg" '));const a=(new DOMParser).parseFromString(e,"text/xml"),r=a.documentElement.attributes.viewBox?a.documentElement.attributes.viewBox.value.match(/\S+/g):null;if(r)for(let e=0;e<r.length;e++)r[e]=parseFloat(r[e]);i.a.project.importSVG(e,{expandShapes:!0,onLoad:function(s){if(!s)return c.error("SVG import failed:"),c.info(e),this.props.changeFormat(S.VECTOR_SKIP_CONVERT),void Ut(n.props.undoSnapshot,S.VECTOR_SKIP_CONVERT);s.remove(),n.queuedImport=n.recalibrateSize(()=>{n.props.updateViewBounds(i.a.view.matrix),n.initializeSvg(s,t,o,r)})}})}initializeSvg(e,t,o,n){this.queuedImport&&(this.queuedImport=null);const s=e.bounds.width,a=e.bounds.height;let r;if(e.clipped){for(const t of e.children)if(t.isClipMask()){r=t;break}r.clipMask=!1}else r=new i.a.Shape.Rectangle(e.bounds);if(r.guide=!0,r.locked=!0,r.matrix=new i.a.Matrix,r.size.height=rt.height,r.size.width=rt.width,r.setPosition(it),i.a.project.activeLayer.addChild(r),r.clipMask=!0,e instanceof i.a.Group&&1===e.children.length&&(e=e.reduce()),Y(e),Z(e,2,new i.a.Point),void 0!==t&&void 0!==o){let s=new i.a.Point(t,o);n&&n.length>=2&&!isNaN(n[0])&&!isNaN(n[1])&&(s=s.subtract(n[0],n[1])),e.translate(it.subtract(s.multiply(2)))}else e.translate(it.subtract(s,a));if(i.a.project.activeLayer.insertChild(0,e),L(e)){for(const t of e.children)L(t)&&0===t.children.length&&t.remove();N([e])}Ut(this.props.undoSnapshot,S.VECTOR_SKIP_CONVERT),this.maybeZoomToFit()}onViewResize(){dt(!0),ht(),this.recalibrateSize(),this.props.updateViewBounds(i.a.view.matrix)}recalibrateSize(e){return window.setTimeout(()=>{if(!i.a.view)return;const t=i.a.DomElement.getSize(i.a.view.element);t.width=Math.round(t.width),t.height=Math.round(t.height),i.a.view.setViewSize(t),e&&e()},0)}setCanvas(e){this.canvas=e,this.props.canvasRef&&this.props.canvasRef(e)}render(){return h.a.createElement("canvas",{className:ho.a.paperCanvas,ref:this.setCanvas,style:{cursor:this.props.cursor},resize:"true"})}}po.propTypes={canvasRef:a.a.func,changeFormat:a.a.func.isRequired,clearHoveredItem:a.a.func.isRequired,clearPasteOffset:a.a.func.isRequired,clearSelectedItems:a.a.func.isRequired,clearUndo:a.a.func.isRequired,cursor:a.a.string,format:a.a.oneOf(Object.keys(S)),image:a.a.oneOfType([a.a.string,a.a.instanceOf(HTMLImageElement)]),imageFormat:a.a.string,imageId:a.a.string,rotationCenterX:a.a.number,rotationCenterY:a.a.number,saveZoomLevel:a.a.func.isRequired,setZoomLevelId:a.a.func.isRequired,undoSnapshot:a.a.func.isRequired,updateViewBounds:a.a.func.isRequired,zoomLevelId:a.a.string,zoomLevels:a.a.shape({currentZoomLevelId:a.a.string})};var uo=Object(p.connect)(e=>({mode:e.scratchPaint.mode,cursor:e.scratchPaint.cursor,format:e.scratchPaint.format,zoomLevels:e.scratchPaint.zoomLevels}),e=>({undoSnapshot:t=>{e($t(t))},clearUndo:()=>{e({type:Kt})},clearSelectedItems:()=>{e(Qt())},clearHoveredItem:()=>{e(oo())},clearPasteOffset:()=>{e({type:"scratch-paint/clipboard/CLEAR_PASTE_OFFSET"})},changeFormat:t=>{e(so(t))},saveZoomLevel:()=>{e(function(e){return e instanceof i.a.Matrix||c.warn(`Not a matrix: ${e}`),{type:"scratch-paint/zoom-levels/SAVE_ZOOM_LEVEL",zoomLevel:new i.a.Matrix(e)}}(i.a.view.matrix))},setZoomLevelId:t=>{e(function(e){return{type:"scratch-paint/zoom-levels/SET_ZOOM_LEVEL_ID",zoomLevelId:e}}(t))},updateViewBounds:t=>{e(ro(t))}}))(po),mo=o(899),fo=o.n(mo);const go=e=>h.a.createElement("div",{className:e.style},e.children,h.a.createElement("div",{className:fo.a.horizontalScrollbarWrapper,style:{pointerEvents:"none"}},h.a.createElement("div",{className:fo.a.horizontalScrollbar,style:{width:`${e.horizontalScrollLengthPercent}%`,left:`${e.horizontalScrollStartPercent}%`,pointerEvents:"auto",display:`${e.hideScrollbars||Math.abs(e.horizontalScrollLengthPercent-100)<1e-8?"none":"block"}`},onMouseDown:e.onHorizontalScrollbarMouseDown,onTouchStart:e.onHorizontalScrollbarMouseDown})),h.a.createElement("div",{className:fo.a.verticalScrollbarWrapper,style:{pointerEvents:"none"}},h.a.createElement("div",{className:fo.a.verticalScrollbar,style:{height:`${e.verticalScrollLengthPercent}%`,top:`${e.verticalScrollStartPercent}%`,pointerEvents:"auto",display:`${e.hideScrollbars||Math.abs(e.verticalScrollLengthPercent-100)<1e-8?"none":"block"}`},onMouseDown:e.onVerticalScrollbarMouseDown,onTouchStart:e.onVerticalScrollbarMouseDown})));go.propTypes={children:a.a.node.isRequired,hideScrollbars:a.a.bool,horizontalScrollLengthPercent:a.a.number,horizontalScrollStartPercent:a.a.number,onHorizontalScrollbarMouseDown:a.a.func.isRequired,onVerticalScrollbarMouseDown:a.a.func.isRequired,style:a.a.string,verticalScrollLengthPercent:a.a.number,verticalScrollStartPercent:a.a.number};var bo=go;const vo=e=>e.touches&&e.touches[0]?{x:e.touches[0].clientX,y:e.touches[0].clientY}:e.changedTouches&&e.changedTouches[0]?{x:e.changedTouches[0].clientX,y:e.changedTouches[0].clientY}:{x:e.clientX,y:e.clientY};class wo extends h.a.Component{static get ZOOM_INCREMENT(){return.5}constructor(e){super(e),b()(this,["handleHorizontalScrollbarMouseDown","handleHorizontalScrollbarMouseMove","handleHorizontalScrollbarMouseUp","handleVerticalScrollbarMouseDown","handleVerticalScrollbarMouseMove","handleVerticalScrollbarMouseUp","handleWheel"])}componentDidMount(){this.props.canvas&&this.props.canvas.addEventListener("wheel",this.handleWheel)}componentWillReceiveProps(e){e.canvas&&(this.props.canvas&&this.props.canvas.removeEventListener("wheel",this.handleWheel),e.canvas.addEventListener("wheel",this.handleWheel))}handleHorizontalScrollbarMouseDown(e){this.initialMouseX=vo(e).x,this.initialScreenX=i.a.view.matrix.tx,window.addEventListener("mousemove",this.handleHorizontalScrollbarMouseMove),window.addEventListener("touchmove",this.handleHorizontalScrollbarMouseMove,{passive:!1}),window.addEventListener("mouseup",this.handleHorizontalScrollbarMouseUp),window.addEventListener("touchend",this.handleHorizontalScrollbarMouseUp),e.preventDefault()}handleHorizontalScrollbarMouseMove(e){const t=this.initialMouseX-vo(e).x;i.a.view.matrix.tx=this.initialScreenX+t*i.a.view.zoom*2,ht(),this.props.updateViewBounds(i.a.view.matrix),e.preventDefault()}handleHorizontalScrollbarMouseUp(){window.removeEventListener("mousemove",this.handleHorizontalScrollbarMouseMove),window.removeEventListener("touchmove",this.handleHorizontalScrollbarMouseMove,{passive:!1}),window.removeEventListener("mouseup",this.handleHorizontalScrollbarMouseUp),window.removeEventListener("touchend",this.handleHorizontalScrollbarMouseUp),this.initialMouseX=null,this.initialScreenX=null,event.preventDefault()}handleVerticalScrollbarMouseDown(e){this.initialMouseY=vo(e).y,this.initialScreenY=i.a.view.matrix.ty,window.addEventListener("mousemove",this.handleVerticalScrollbarMouseMove),window.addEventListener("touchmove",this.handleVerticalScrollbarMouseMove,{passive:!1}),window.addEventListener("mouseup",this.handleVerticalScrollbarMouseUp),window.addEventListener("touchend",this.handleVerticalScrollbarMouseUp),e.preventDefault()}handleVerticalScrollbarMouseMove(e){const t=this.initialMouseY-vo(e).y;i.a.view.matrix.ty=this.initialScreenY+t*i.a.view.zoom*2,ht(),this.props.updateViewBounds(i.a.view.matrix),e.preventDefault()}handleVerticalScrollbarMouseUp(e){window.removeEventListener("mousemove",this.handleVerticalScrollbarMouseMove),window.removeEventListener("touchmove",this.handleVerticalScrollbarMouseMove,{passive:!1}),window.removeEventListener("mouseup",this.handleVerticalScrollbarMouseUp),window.removeEventListener("touchend",this.handleVerticalScrollbarMouseUp),this.initialMouseY=null,this.initialScreenY=null,e.preventDefault()}handleWheel(e){const t=1===e.deltaMode?15:1,o=e.deltaX*t,n=e.deltaY*t,s=this.props.canvas.getBoundingClientRect(),a=e.clientX-s.left,r=e.clientY-s.top,l=i.a.view.viewToProject(new i.a.Point(a,r));if(e.metaKey||e.ctrlKey)ut(-n/1e3,l),this.props.updateViewBounds(i.a.view.matrix),this.props.redrawSelectionBox();else if(e.shiftKey&&0===e.deltaX){const e=n/i.a.view.zoom;gt(e,0),this.props.updateViewBounds(i.a.view.matrix)}else{const t=o/i.a.view.zoom,s=n/i.a.view.zoom;gt(t,s),this.props.updateViewBounds(i.a.view.matrix),i.a.tool&&i.a.tool.view._handleMouseEvent("mousemove",e,l)}e.preventDefault()}render(){let e=0,t=0,o=0,n=0;if(i.a.project){const s=ct(),{x:a,y:r,width:l,height:c}=i.a.view.bounds;e=Math.min(100,100*l/s.width),t=Math.min(100,100*c/s.height);const d=(a+l/2-s.x)/s.width,h=(r+c/2-s.y)/s.height;o=Math.max(0,100*h-t/2),n=Math.max(0,100*d-e/2)}return h.a.createElement(bo,{hideScrollbars:this.props.hideScrollbars,horizontalScrollLengthPercent:e,horizontalScrollStartPercent:n,style:this.props.style,verticalScrollLengthPercent:t,verticalScrollStartPercent:o,onHorizontalScrollbarMouseDown:this.handleHorizontalScrollbarMouseDown,onVerticalScrollbarMouseDown:this.handleVerticalScrollbarMouseDown},this.props.children)}}wo.propTypes={canvas:a.a.instanceOf(Element),children:a.a.node.isRequired,hideScrollbars:a.a.bool,redrawSelectionBox:a.a.func.isRequired,style:a.a.string,updateViewBounds:a.a.func.isRequired};var So=Object(p.connect)(e=>({viewBounds:e.scratchPaint.viewBounds}),e=>({redrawSelectionBox:()=>{e({type:"scratch-paint/select/REDRAW_SELECTION_BOX"})},updateViewBounds:t=>{e(ro(t))}}))(wo);var Co=w()({SOLID:null,HORIZONTAL:null,VERTICAL:null,RADIAL:null}),Io=o(875),xo=o.n(Io);const To="#9966FF",yo=To,Mo=/^#([0-9a-f]{3}){1,2}$/i,Eo=function(e){return{type:"scratch-paint/fill-color/CHANGE_FILL_COLOR",fillColor:e}},Ro="scratch-paint/style-path/mixed",ko=function(e,t){return(!e||"gradient"!==e.type)&&(!e&&!t||e&&t&&e.toCSS()===new i.a.Color(t).toCSS())},Oo=function(e){const t=ce();if(e){const o=Q({match:t=>t.id===e});o.length&&t.push(o[0])}return t},Do=function(e){const t=new i.a.Color(e);return t.alpha=0,t.toCSS()},Po=function(e){if(e===Ro)return null;const t=new i.a.Color(e);return e&&0!==t.alpha?xo()(`hsl(${(t.hue-72)%360}, ${100*t.saturation}, ${Math.max(100*t.lightness,10)})`).hex:To},_o=function(e,t,o,n,s){if(o===Co.SOLID)return e;null===e&&(e=Do(t)),null===t&&(t=Do(e));const a=Math.max(n.width,n.height)/2,r=o===Co.RADIAL?s:o===Co.VERTICAL?n.topCenter:o===Co.HORIZONTAL?n.leftCenter:null,l=o===Co.RADIAL?r.add(new i.a.Point(a,0)):o===Co.VERTICAL?n.bottomCenter:o===Co.HORIZONTAL?n.rightCenter:null;return{gradient:{stops:[e,t],radial:o===Co.RADIAL},origin:r,destination:l}},Lo=function(e,t,o,n,s){const a=Oo(s);let r=!1;for(let s of a)if(s.parent instanceof i.a.CompoundPath&&(s=s.parent),n&&null!==s.strokeColor&&s.strokeWidth)ko(s.strokeColor,e)||(r=!0,s.strokeColor=e);else if(!o&&s.fillColor&&s.fillColor.gradient&&2!==!s.fillColor.gradient.stops.length){if(!ko(s.fillColor.gradient.stops[t].color,e)){r=!0;const o=0===t?1:0;null===e&&(e=Do(s.fillColor.gradient.stops[o].color.toCSS()));const n=[0,0];n[t]=e,0===s.fillColor.gradient.stops[o].color.alpha?n[o]=Do(e):n[o]=s.fillColor.gradient.stops[o].color.toCSS(),s.fillColor.gradient={stops:n,radial:s.fillColor.gradient.radial}}}else ko(s.fillColor,e)||(r=!0,P(s)&&!e?s.fillColor="rgba(0,0,0,0)":s.fillColor=e);return r},Bo=function(e,t){const o=Oo(t);let n=!1;for(const t of o)if(!H(t)){if(e)return;if(t.fillColor&&t.fillColor.gradient&&2!==!t.fillColor.gradient.stops.length&&!t.fillColor.gradient.stops[0].color.equals(t.fillColor.gradient.stops[1].color)){n=!0;const e=[t.fillColor.gradient.stops[1].color.toCSS(),t.fillColor.gradient.stops[0].color.toCSS()];t.fillColor.gradient={stops:e,radial:t.fillColor.gradient.radial}}}return n},Ao=function(e,t,o){const n=Oo(o);let s=!1;for(let o of n){let n,a;if(o.parent instanceof i.a.CompoundPath&&(o=o.parent),n=null===o.fillColor||0===o.fillColor.alpha?null:o.fillColor.gradient?o.fillColor.gradient.stops[0]&&0!==o.fillColor.gradient.stops[0].color.alpha?o.fillColor.gradient.stops[0].color.toCSS():null:o.fillColor.toCSS(),a=o.fillColor&&o.fillColor.gradient&&o.fillColor.gradient.stops[1]?0===o.fillColor.gradient.stops[1].color.alpha?null:o.fillColor.gradient.stops[1].color.toCSS():Po(n),!t)if(e!==Co.SOLID){if(null===n&&(n=Do(a)),null===a&&(a=Do(n)),e===Co.RADIAL){if(!(o.fillColor&&o.fillColor.gradient&&o.fillColor.gradient.radial)){s=!0;const e=Math.max(o.bounds.width,o.bounds.height)/2;o.fillColor={gradient:{stops:[n,a],radial:!0},origin:o.position,destination:o.position.add(new i.a.Point(e,0))}}}else if(e===Co.HORIZONTAL){o.fillColor&&o.fillColor.gradient&&!o.fillColor.gradient.radial&&Math.abs(o.fillColor.origin.y-o.fillColor.destination.y)<1e-8||(s=!0,o.fillColor={gradient:{stops:[n,a]},origin:o.bounds.leftCenter,destination:o.bounds.rightCenter})}else if(e===Co.VERTICAL){o.fillColor&&o.fillColor.gradient&&!o.fillColor.gradient.radial&&Math.abs(o.fillColor.origin.x-o.fillColor.destination.x)<1e-8||(s=!0,o.fillColor={gradient:{stops:[n,a]},origin:o.bounds.topCenter,destination:o.bounds.bottomCenter})}}else o.fillColor&&o.fillColor.gradient&&(s=!0,o.fillColor=n)}return s},No=function(e,t,o){if(t)return!1;const n=Oo(o);let s=!1;for(let t of n)t.parent instanceof i.a.CompoundPath&&(t=t.parent),ko(t.strokeColor,e)||(s=!0,t.strokeColor=e);return s},Uo=function(e,t){let o=!1;const n=Oo(t);for(let t of n)t.parent instanceof i.a.CompoundPath&&(t=t.parent),L(t)||t.strokeWidth!==e&&(t.strokeWidth=e,o=!0);return o},zo=function(e,t){let o,n,s,a,r,l,c=!0;for(let d of e){let e,h,p;d.parent instanceof i.a.CompoundPath&&(d=d.parent);let u=Co.SOLID;if(!L(d)){d.fillColor&&(P(d)&&0===d.fillColor.alpha?e=null:"gradient"===d.fillColor.type?2===d.fillColor.gradient.stops.length?(u=d.fillColor.gradient.radial?Co.RADIAL:Co.HORIZONTAL,e=0===d.fillColor.gradient.stops[0].color.alpha?null:d.fillColor.gradient.stops[0].color.toCSS(),h=0===d.fillColor.gradient.stops[1].color.alpha?null:d.fillColor.gradient.stops[1].color.toCSS()):(e=Ro,h=Ro):e=0===d.fillColor.alpha?null:d.fillColor.toCSS()),d.strokeColor?t?e=d.strokeColor.toCSS():p="gradient"===d.strokeColor.type?Ro:0!==d.strokeColor.alpha&&d.strokeWidth?d.strokeColor.toCSS():null:p=null,c&&(c=!1,o=e,n=h,s=p,l=u,a=p?d.strokeWidth:0,d.strokeWidth&&d.data&&d.data.zoomLevel&&(r=d.strokeWidth/d.data.zoomLevel)),e!==o&&(o=Ro),h!==n&&(n=Ro),u!==l&&(l=Co.SOLID,o=Ro,n=Ro),p!==s&&(s=Ro),a!==(p?d.strokeWidth:0)&&(a=null)}}if(e&&e.length&&l!==Co.SOLID){let t=e[0];t.parent instanceof i.a.CompoundPath&&(t=t.parent);const o=t.fillColor.destination.subtract(t.fillColor.origin);90===Math.abs(o.angle)&&(l=Co.VERTICAL)}return t?{fillColor:o||null,fillColor2:n||null,gradientType:l,thickness:r}:{fillColor:o||null,fillColor2:n||null,gradientType:l,strokeColor:s||null,strokeWidth:a||null===a?a:0}},Fo=function(e,t){t.isEraser?e.fillColor="white":t.fillColor?e.fillColor=t.fillColor:e.fillColor="black"},Ho=function(e,t,o){e.setStrokeColor(t===Ro||null===t?"black":t),e.setStrokeWidth(null===o||0===o?1:o)},qo=function(e,t){t.isEraser?(e.fillColor="white",e.strokeColor="cornflowerblue",e.strokeWidth=1):t.fillColor?e.fillColor=t.fillColor:e.fillColor="black"},Go=function(e,t){e.fillColor=t.fillColor,e.strokeColor=t.strokeColor,e.strokeWidth=t.strokeWidth},jo=E.SELECT,Vo=function(e){return{type:"scratch-paint/modes/CHANGE_MODE",mode:e}},Wo="scratch-paint/fill-mode-gradient-type/CHANGE_GRADIENT_TYPE",Ko=function(e){return{type:Wo,gradientType:e}},Xo="scratch-paint/selection-gradient-type/CLEAR_GRADIENT",$o=Co.SOLID,Yo=function(){return{type:Xo}};var Zo=o(903),Jo=o.n(Zo);function Qo(){return(Qo=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e}).apply(this,arguments)}const en=({className:e,highlighted:t,onClick:o,children:n,...i})=>{const s=i.disabled||!1;return!1===s&&(i.onClick=o),h.a.createElement("span",Qo({className:m()(Jo.a.button,e,{[Jo.a.modDisabled]:s,[Jo.a.highlighted]:t}),role:"button"},i),n)};en.propTypes={children:a.a.node,className:a.a.string,disabled:a.a.oneOfType([a.a.string,a.a.bool]),highlighted:a.a.bool,onClick:a.a.func.isRequired};var tn=en,on=o(905),nn=o.n(on);const sn=e=>h.a.createElement(tn,{className:m()(e.className,nn.a.modToolSelect,{[nn.a.isSelected]:e.isSelected}),disabled:e.disabled,title:e.intl.formatMessage(e.imgDescriptor),onClick:e.onMouseDown},h.a.createElement("img",{alt:e.intl.formatMessage(e.imgDescriptor),className:nn.a.toolSelectIcon,draggable:!1,src:e.imgSrc}));sn.propTypes={className:a.a.string,disabled:a.a.bool,imgDescriptor:a.a.shape({defaultMessage:a.a.string,description:a.a.string,id:a.a.string}).isRequired,imgSrc:a.a.string.isRequired,intl:f.intlShape.isRequired,isSelected:a.a.bool.isRequired,onMouseDown:a.a.func.isRequired};var an=Object(f.injectIntl)(sn);var rn=Object(f.defineMessages)({brush:{defaultMessage:"Brush",description:"Label for the brush tool",id:"paint.brushMode.brush"},eraser:{defaultMessage:"Eraser",description:"Label for the eraser tool",id:"paint.eraserMode.eraser"},fill:{defaultMessage:"Fill",description:"Label for the fill tool",id:"paint.fillMode.fill"},line:{defaultMessage:"Line",description:"Label for the line tool",id:"paint.lineMode.line"},oval:{defaultMessage:"Circle",description:"Label for the oval-drawing tool",id:"paint.ovalMode.oval"},rect:{defaultMessage:"Rectangle",description:"Label for the rectangle tool",id:"paint.rectMode.rect"},reshape:{defaultMessage:"Reshape",description:"Label for the reshape tool, which allows changing the points in the lines of the vectors",id:"paint.reshapeMode.reshape"},roundedRect:{defaultMessage:"Rounded Rectangle",description:"Label for the rounded rectangle tool",id:"paint.roundedRectMode.roundedRect"},select:{defaultMessage:"Select",description:"Label for the select tool, which allows selecting, moving, and resizing shapes",id:"paint.selectMode.select"},text:{defaultMessage:"Text",description:"Label for the text tool",id:"paint.textMode.text"}}),ln=o(887),cn=o.n(ln);const dn=e=>h.a.createElement(an,{imgDescriptor:rn.brush,imgSrc:cn.a,isSelected:e.isSelected,onMouseDown:e.onMouseDown});dn.propTypes={isSelected:a.a.bool.isRequired,onMouseDown:a.a.func.isRequired};var hn=dn;class pn extends i.a.Tool{constructor(e,t){super(),this.onUpdateImage=e,this.isEraser=t,this.onMouseMove=this.handleMouseMove,this.onMouseDown=this.handleMouseDown,this.onMouseDrag=this.handleMouseDrag,this.onMouseUp=this.handleMouseUp,this.colorState=null,this.active=!1,this.lastPoint=null,this.cursorPreview=null}setColor(e){this.color=e,this.tmpCanvas=Pe(this.size,this.color,this.isEraser||!this.color)}setBrushSize(e){this.size=Math.max(1,~~e),this.tmpCanvas=Pe(this.size,this.color,this.isEraser||!this.color)}draw(e,t){const o=Math.ceil(this.size/2),n=yt().getContext("2d");!this.isEraser&&this.color||(n.globalCompositeOperation="destination-out"),yt().drawImage(this.tmpCanvas,new i.a.Point(~~e-o,~~t-o)),!this.isEraser&&this.color||(n.globalCompositeOperation="source-over")}updateCursorIfNeeded(){this.size&&(this.cursorPreview&&!this.cursorPreview.parent&&(this.cursorPreview=null),this.cursorPreview&&this.lastSize===this.size&&this.lastColor===this.color||(this.cursorPreview&&this.cursorPreview.remove(),this.tmpCanvas=Pe(this.size,this.color,this.isEraser||!this.color),this.cursorPreview=new i.a.Raster(this.tmpCanvas),this.cursorPreview.guide=!0,this.cursorPreview.parent=Dt(),this.cursorPreview.data.isHelperItem=!0),this.lastSize=this.size,this.lastColor=this.color)}handleMouseMove(e){this.updateCursorIfNeeded(),this.cursorPreview.position=new i.a.Point(~~e.point.x,~~e.point.y)}handleMouseDown(e){e.event.button>0||(this.active=!0,this.cursorPreview&&this.cursorPreview.remove(),this.draw(e.point.x,e.point.y),this.lastPoint=e.point)}handleMouseDrag(e){e.event.button>0||!this.active||(ke(this.lastPoint,e.point,this.draw.bind(this)),this.lastPoint=e.point)}handleMouseUp(e){e.event.button>0||!this.active||(ke(this.lastPoint,e.point,this.draw.bind(this)),this.onUpdateImage(),this.lastPoint=null,this.active=!1,this.updateCursorIfNeeded(),this.cursorPreview.position=new i.a.Point(~~e.point.x,~~e.point.y))}deactivateTool(){this.active=!1,this.tmpCanvas=null,this.cursorPreview&&(this.cursorPreview.remove(),this.cursorPreview=null)}}var un=pn;class mn extends h.a.Component{constructor(e){super(e),b()(this,["activateTool","deactivateTool"])}componentDidMount(){this.props.isBitBrushModeActive&&this.activateTool(this.props)}componentWillReceiveProps(e){this.tool&&e.color!==this.props.color&&this.tool.setColor(e.color),this.tool&&e.bitBrushSize!==this.props.bitBrushSize&&this.tool.setBrushSize(e.bitBrushSize),e.isBitBrushModeActive&&!this.props.isBitBrushModeActive?this.activateTool():!e.isBitBrushModeActive&&this.props.isBitBrushModeActive&&this.deactivateTool()}shouldComponentUpdate(e){return e.isBitBrushModeActive!==this.props.isBitBrushModeActive}componentWillUnmount(){this.tool&&this.deactivateTool()}activateTool(){re(this.props.clearSelectedItems),this.props.clearGradient();let e=this.props.color;e&&e!==Ro||(this.props.onChangeFillColor(To),e=To),this.tool=new un(this.props.onUpdateImage),this.tool.setColor(e),this.tool.setBrushSize(this.props.bitBrushSize),this.tool.activate()}deactivateTool(){this.tool.deactivateTool(),this.tool.remove(),this.tool=null}render(){return h.a.createElement(hn,{isSelected:this.props.isBitBrushModeActive,onMouseDown:this.props.handleMouseDown})}}mn.propTypes={bitBrushSize:a.a.number.isRequired,clearGradient:a.a.func.isRequired,clearSelectedItems:a.a.func.isRequired,color:a.a.string,handleMouseDown:a.a.func.isRequired,isBitBrushModeActive:a.a.bool.isRequired,onChangeFillColor:a.a.func.isRequired,onUpdateImage:a.a.func.isRequired};var fn=Object(p.connect)(e=>({bitBrushSize:e.scratchPaint.bitBrushSize,color:e.scratchPaint.color.fillColor,isBitBrushModeActive:e.scratchPaint.mode===E.BIT_BRUSH}),e=>({clearSelectedItems:()=>{e(Qt())},clearGradient:()=>{e(Yo())},handleMouseDown:()=>{e(Vo(E.BIT_BRUSH))},onChangeFillColor:t=>{e(Eo(t))}}))(mn),gn=o(888),bn=o.n(gn);const vn=e=>h.a.createElement(an,{imgDescriptor:rn.line,imgSrc:bn.a,isSelected:e.isSelected,onMouseDown:e.onMouseDown});vn.propTypes={isSelected:a.a.bool.isRequired,onMouseDown:a.a.func.isRequired};var wn=vn;class Sn extends i.a.Tool{constructor(e){super(),this.onUpdateImage=e,this.onMouseMove=this.handleMouseMove,this.onMouseDown=this.handleMouseDown,this.onMouseDrag=this.handleMouseDrag,this.onMouseUp=this.handleMouseUp,this.colorState=null,this.active=!1,this.startPoint=null,this.cursorPreview=null,this.drawTarget=null}setColor(e){this.color=e,this.tmpCanvas=Pe(this.size,this.color)}setLineSize(e){this.size=Math.max(1,~~e),this.tmpCanvas=Pe(this.size,this.color)}draw(e,t){const o=Math.ceil(this.size/2);this.drawTarget.drawImage(this.tmpCanvas,new i.a.Point(~~e-o,~~t-o))}updateCursorIfNeeded(){this.size&&(this.cursorPreview&&!this.cursorPreview.parent&&(this.cursorPreview=null),this.cursorPreview&&this.lastSize===this.size&&this.lastColor===this.color||(this.cursorPreview&&this.cursorPreview.remove(),this.tmpCanvas=Pe(this.size,this.color),this.cursorPreview=new i.a.Raster(this.tmpCanvas),this.cursorPreview.guide=!0,this.cursorPreview.parent=Dt(),this.cursorPreview.data.isHelperItem=!0),this.lastSize=this.size,this.lastColor=this.color)}handleMouseMove(e){this.updateCursorIfNeeded(),this.cursorPreview.position=new i.a.Point(~~e.point.x,~~e.point.y)}handleMouseDown(e){if(e.event.button>0)return;this.active=!0,this.cursorPreview&&this.cursorPreview.remove();const t=xt();this.drawTarget=new i.a.Raster(t),this.drawTarget.parent=Dt(),this.drawTarget.guide=!0,this.drawTarget.locked=!0,this.drawTarget.position=yt().position,this.draw(e.point.x,e.point.y),this.startPoint=e.point}handleMouseDrag(e){if(e.event.button>0||!this.active)return;this.drawTarget.canvas.getContext("2d").clearRect(0,0,ot,nt),ke(this.startPoint,e.point,this.draw.bind(this))}handleMouseUp(e){e.event.button>0||!this.active||(this.drawTarget.remove(),this.drawTarget=yt(),ke(this.startPoint,e.point,this.draw.bind(this)),this.drawTarget=null,this.onUpdateImage(),this.lastPoint=null,this.active=!1,this.updateCursorIfNeeded(),this.cursorPreview.position=new i.a.Point(~~e.point.x,~~e.point.y))}deactivateTool(){this.active=!1,this.tmpCanvas=null,this.cursorPreview&&(this.cursorPreview.remove(),this.cursorPreview=null)}}var Cn=Sn;class In extends h.a.Component{constructor(e){super(e),b()(this,["activateTool","deactivateTool"])}componentDidMount(){this.props.isBitLineModeActive&&this.activateTool(this.props)}componentWillReceiveProps(e){this.tool&&e.color!==this.props.color&&this.tool.setColor(e.color),this.tool&&e.bitBrushSize!==this.props.bitBrushSize&&this.tool.setLineSize(e.bitBrushSize),e.isBitLineModeActive&&!this.props.isBitLineModeActive?this.activateTool():!e.isBitLineModeActive&&this.props.isBitLineModeActive&&this.deactivateTool()}shouldComponentUpdate(e){return e.isBitLineModeActive!==this.props.isBitLineModeActive}componentWillUnmount(){this.tool&&this.deactivateTool()}activateTool(){re(this.props.clearSelectedItems),this.props.clearGradient();let e=this.props.color;e&&e!==Ro||(this.props.onChangeFillColor(To),e=To),this.tool=new Cn(this.props.onUpdateImage),this.tool.setColor(e),this.tool.setLineSize(this.props.bitBrushSize),this.tool.activate()}deactivateTool(){this.tool.deactivateTool(),this.tool.remove(),this.tool=null}render(){return h.a.createElement(wn,{isSelected:this.props.isBitLineModeActive,onMouseDown:this.props.handleMouseDown})}}In.propTypes={bitBrushSize:a.a.number.isRequired,clearGradient:a.a.func.isRequired,clearSelectedItems:a.a.func.isRequired,color:a.a.string,handleMouseDown:a.a.func.isRequired,isBitLineModeActive:a.a.bool.isRequired,onChangeFillColor:a.a.func.isRequired,onUpdateImage:a.a.func.isRequired};var xn=Object(p.connect)(e=>({bitBrushSize:e.scratchPaint.bitBrushSize,color:e.scratchPaint.color.fillColor,isBitLineModeActive:e.scratchPaint.mode===E.BIT_LINE}),e=>({clearSelectedItems:()=>{e(Qt())},clearGradient:()=>{e(Yo())},handleMouseDown:()=>{e(Vo(E.BIT_LINE))},onChangeFillColor:t=>{e(Eo(t))}}))(In);var Tn={DEFAULT:"default",GRAB:"grab",GRABBING:"grabbing",NONE:"none",RESIZE_EW:"ew-resize",RESIZE_NS:"ns-resize",RESIZE_NESW:"nesw-resize",RESIZE_NWSE:"nwse-resize"};const yn="scratch-paint/eye-dropper/ACTIVATE_COLOR_PICKER",Mn="scratch-paint/eye-dropper/DEACTIVATE_COLOR_PICKER",En={active:!1,callback:()=>{},previousTool:null},Rn=function(){return{type:Mn}},kn=Tn.DEFAULT,On=function(e){return{type:"scratch-paint/cursor/CHANGE_CURSOR",cursorString:e}};var Dn=class{constructor(e,t){this.isBitmap=e in M,this.active=!1,this.boundsPath=null,this.pivot=null,this.origPivot=null,this.corner=null,this.origSize=null,this.origCenter=null,this.itemGroup=null,this.itemToInsertBelow=null,this.lastPoint=null,this.onUpdateImage=t}onMouseDown(e,t,o){if(this.active)return;this.active=!0;const n=e.item.data.index;this.pivot=t.bounds[this._getOpposingRectCornerNameByIndex(n)].clone(),this.origPivot=t.bounds[this._getOpposingRectCornerNameByIndex(n)].clone(),this.corner=t.bounds[this._getRectCornerNameByIndex(n)].clone(),this.selectionAnchor=t.selectionAnchor,this.origSize=this.corner.subtract(this.pivot),this.origCenter=t.bounds.center,this.isCorner=this._isCorner(n),this.centered=!1,this.lastSx=1,this.lastSy=1,this.boundsPath=t;const s=Q({match:function(e){for(const t of o)if(!t.isBelow(e))return!1;return!0}});s.length>0&&(this.itemToInsertBelow=s[0]),this.itemGroup=new i.a.Group(o),this.itemGroup.addChild(t),this.itemGroup.insertBelow(this.itemToInsertBelow),this.itemGroup.data.isHelperItem=!0}onMouseDrag(e){if(!this.active)return;const t=e.point,o=bt(this.isBitmap);t.x=Math.max(o.left,Math.min(t.x,o.right)),t.y=Math.max(o.top,Math.min(t.y,o.bottom)),this.lastPoint||(this.lastPoint=e.lastPoint);const n=t.subtract(this.lastPoint);this.lastPoint=t,e.modifiers.alt?(this.centered=!0,this.itemGroup.position=this.origCenter,this.pivot=this.origCenter):(this.centered&&(this.centered=!1,this.itemGroup.scale(1/this.lastSx,1/this.lastSy,this.pivot),this.selectionAnchor&&this.selectionAnchor.scale(this.lastSx,this.lastSy),this.lastSx=1,this.lastSy=1),this.pivot=this.origPivot),this.corner=this.corner.add(n);let i=this.corner.subtract(this.pivot);e.modifiers.alt&&(i=i.multiply(2));let s=1,a=1;if(Math.abs(this.origSize.x)>1e-7&&(s=i.x/this.origSize.x),Math.abs(this.origSize.y)>1e-7&&(a=i.y/this.origSize.y),this.isCorner&&!e.modifiers.shift){const e=s>0?1:-1,t=a>0?1:-1;s=a=Math.max(Math.abs(s),Math.abs(a)),s*=e,a*=t}this.itemGroup.scale(s/this.lastSx,a/this.lastSy,this.pivot),this.selectionAnchor&&this.selectionAnchor.scale(this.lastSx/s,this.lastSy/a),this.lastSx=s,this.lastSy=a}onMouseUp(){if(this.active&&(this.lastPoint=null,this.pivot=null,this.origPivot=null,this.corner=null,this.origSize=null,this.origCenter=null,this.lastSx=1,this.lastSy=1,this.centered=!1,this.itemGroup)){this.boundsPath.remove(),this.boundsPath=null;for(let e=0;e<this.itemGroup.children.length;e++){const t=this.itemGroup.children[e];t.data.isPGTextItem&&(t.data.wasScaled=!0)}if(this.itemToInsertBelow){for(const e=0;e<this.itemGroup.children.length;)this.itemGroup.children[e].insertBelow(this.itemToInsertBelow);this.itemToInsertBelow=null}else this.itemGroup.layer&&this.itemGroup.layer.addChildren(this.itemGroup.children);this.itemGroup.remove(),this.onUpdateImage(),this.active=!1}}_getRectCornerNameByIndex(e){switch(e){case 0:return"bottomLeft";case 1:return"leftCenter";case 2:return"topLeft";case 3:return"topCenter";case 4:return"topRight";case 5:return"rightCenter";case 6:return"bottomRight";case 7:return"bottomCenter"}}_getOpposingRectCornerNameByIndex(e){switch(e){case 0:return"topRight";case 1:return"rightCenter";case 2:return"bottomRight";case 3:return"bottomCenter";case 4:return"bottomLeft";case 5:return"leftCenter";case 6:return"topLeft";case 7:return"topCenter"}}_isCorner(e){switch(e){case 0:case 2:case 4:case 6:return!0;default:return!1}}};var Pn=class{constructor(e){this.rotItems=[],this.rotGroupPivot=null,this.prevRot=90,this.onUpdateImage=e}onMouseDown(e,t,o){this.rotGroupPivot=t.bounds.center;for(const e of o)e.parent instanceof i.a.Layer&&this.rotItems.push(e);this.prevRot=90}onMouseDrag(e){let t=e.point.subtract(this.rotGroupPivot).angle;e.modifiers.shift&&(t=45*Math.round(t/45));for(let e=0;e<this.rotItems.length;e++){const o=this.rotItems[e];o.data.origRot||(o.data.origRot=o.rotation),o.rotate(t-this.prevRot,this.rotGroupPivot)}this.prevRot=t}onMouseUp(e){e.event.button>0||(this.rotItems.length=0,this.rotGroupPivot=null,this.prevRot=90,this.onUpdateImage())}};const _n=4,Ln=10;var Bn=class{constructor(e,t,o,n,i){this.mode=e,this.setSelectedItems=t,this.clearSelectedItems=o,this.selectedItems=null,this.selectionCenter=null,this.onUpdateImage=n,this.switchToTextTool=i,this.boundsPath=null,this.firstDrag=!1}onMouseDown(e){let t,o=e.hitResult.item;if(!e.subselect){const t=R(e.hitResult.item);o=O(t)||L(t)?t:e.hitResult.item}if(o.selected)if(e.doubleClicked){if(!e.multiselect){if(this.switchToTextTool&&o instanceof i.a.PointText)return void this.switchToTextTool();re(this.clearSelectedItems)}this._select(o,!0,e.subselect,!0)}else e.multiselect&&this._select(o,!1,e.subselect);else e.multiselect||re(this.clearSelectedItems),this._select(o,!0,e.subselect);if(e.clone&&ue(e.subselect,this.onUpdateImage),this.selectedItems=this.mode===E.RESHAPE?ce():le(),0!==this.selectedItems.length){for(const e of this.selectedItems)t=t?t.unite(e.bounds):e.bounds;this.selectionCenter=t.center,this.boundsPath&&this.selectedItems.push(this.boundsPath),this.firstDrag=!0}}setBoundsPath(e){this.boundsPath=e}_select(e,t,o,n){o?(e.selected=!1,n?e.fullySelected=t:e.selected=t):ie(e,t),this.setSelectedItems()}onMouseDrag(e){const t=e.point,o=bt(this.mode in M);t.x=Math.max(o.left,Math.min(t.x,o.right)),t.y=Math.max(o.top,Math.min(t.y,o.bottom));const n=t.subtract(e.downPoint);let s,a;if(e.modifiers.shift||this.mode===E.RESHAPE||j(this.selectionCenter.add(n),it,_n/i.a.view.zoom)&&(s=it.subtract(this.selectionCenter)),0===this.selectedItems.length)return;for(const t of this.selectedItems)t.data.origPos||(t.data.origPos=t.position),s?t.position=t.data.origPos.add(s):e.modifiers.shift?t.position=t.data.origPos.add(V(n,Math.PI/4)):t.position=t.data.origPos.add(n),a=a?a.unite(t.bounds):t.bounds;this.firstDrag&&(Mt().visible=!0,this.firstDrag=!1);let r=1;const l=this.selectionCenter.add(n);if(it.y<a.top&&it.x<a.left||it.y>a.bottom&&it.x<a.left||it.y<a.top&&it.x>a.right||it.y>a.bottom&&it.x>a.right){const e=Math.max(it.x-a.right,a.left-it.x),t=Math.max(it.y-a.bottom,a.top-it.y),o=Math.sqrt(e*e+t*t);r=Math.max(0,1-o/(Ln/i.a.view.zoom))}else it.y<a.top||it.y>a.bottom?r=Math.max(0,1-(Math.abs(it.y-l.y)-a.height/2)/(Ln/i.a.view.zoom)):(it.x<a.left||it.x>a.right)&&(r=Math.max(0,1-(Math.abs(it.x-l.x)-a.width/2)/(Ln/i.a.view.zoom)));Mt().opacity=St*r}onMouseUp(){this.firstDrag=!1;let e=!1;for(const t of this.selectedItems)t.data&&t.data.origPos&&!t.position.equals(t.data.origPos)&&(e=!0),t.data.origPos=null;this.selectedItems=null,this.selectionCenter=null,e&&this.onUpdateImage(),Mt().visible=!1}};const An=12,Nn="M19.28,1.09C19.28.28,19,0,18.2,0c-1.67,0-3.34,0-5,0-.34,0-.88.24-1,.47a1.4,1.4,0,0,0,.36,1.08,15.27,15.27,0,0,0,1.46,1.36A6.4,6.4,0,0,1,6.52,4,5.85,5.85,0,0,1,5.24,3,15.27,15.27,0,0,0,6.7,1.61,1.4,1.4,0,0,0,7.06.54C7,.3,6.44.07,6.1.06c-1.67,0-3.34,0-5,0C.28,0,0,.31,0,1.12c0,1.67,0,3.34,0,5a1.23,1.23,0,0,0,.49,1,1.22,1.22,0,0,0,1-.31A14.38,14.38,0,0,0,2.84,5.26l.73.62a9.45,9.45,0,0,0,7.34,2,9.45,9.45,0,0,0,4.82-2.05l.73-.62a14.38,14.38,0,0,0,1.29,1.51,1.22,1.22,0,0,0,1,.31,1.23,1.23,0,0,0,.49-1C19.31,4.43,19.29,2.76,19.28,1.09Z",Un=w()({SCALE:null,ROTATE:null,MOVE:null});var zn=class{constructor(e,t,o,n,i,s){this.dispatchSetCursor=n,this.onUpdateImage=i,this.mode=null,this.boundsPath=null,this.boundsScaleHandles=[],this.boundsRotHandles=[],this._modeMap={},this._modeMap[Un.SCALE]=new Dn(e,i),this._modeMap[Un.ROTATE]=new Pn(i),this._modeMap[Un.MOVE]=new Bn(e,t,o,i,s),this._currentCursor=null}onSelectionChanged(e){e&&e.length?this.setSelectionBounds():this.removeBoundsPath()}onMouseDown(e,t,o,n,i){if(e.event.button>0)return;const{hitResult:s,mode:a}=this._determineMode(e,o,i);if(!s)return o||this.removeBoundsPath(),!1;this.mode=a;const r={hitResult:s,clone:t,multiselect:o,doubleClicked:n};return this.mode===Un.MOVE?(this._modeMap[this.mode].onMouseDown(r),this.removeBoundsHandles()):this.mode===Un.SCALE?(this._modeMap[this.mode].onMouseDown(s,this.boundsPath,le()),this.removeBoundsHandles()):this.mode===Un.ROTATE&&(this.setCursor(Tn.GRABBING),this._modeMap[this.mode].onMouseDown(s,this.boundsPath,le()),this.removeBoundsPath()),!0}onMouseMove(e,t){this._updateCursor(e,t)}_updateCursor(e,t){const{mode:o,hitResult:n}=this._determineMode(e,!1,t);n?o===Un.MOVE?this.setCursor(Tn.DEFAULT):o===Un.ROTATE?this.setCursor(Tn.GRAB):o===Un.SCALE&&(this.setSelectionBounds(),this._impreciseEqual(n.item.position.x,this.boundsPath.position.x)?this.setCursor(Tn.RESIZE_NS):this._impreciseEqual(n.item.position.y,this.boundsPath.position.y)?this.setCursor(Tn.RESIZE_EW):n.item.position.equals(this.boundsPath.bounds.bottomLeft)||n.item.position.equals(this.boundsPath.bounds.topRight)?this.setCursor(Tn.RESIZE_NESW):this.setCursor(Tn.RESIZE_NWSE)):this.setCursor(Tn.DEFAULT)}_impreciseEqual(e,t){return Math.abs(e-t)<1e-8}_determineMode(e,t,o){const n=i.a.project.hitTestAll(e.point,o);let s,a=n[0];for(let e=0;e<n.length;e++){if(n[e].item.data&&n[e].item.data.isScaleHandle){a=n[e],s=Un.SCALE;break}n[e].item.data&&n[e].item.data.isRotHandle&&(a=n[e],s=Un.ROTATE)}return s||(s=Un.MOVE),{mode:s,hitResult:a}}onMouseDrag(e){e.event.button>0||!this.mode||(this._modeMap[this.mode].onMouseDrag(e),this.mode===Un.MOVE&&this.setCursor(Tn.GRABBING))}onMouseUp(e,t){e.event.button>0||!this.mode||(this._modeMap[this.mode].onMouseUp(e),this.setSelectionBounds(),this.mode=null,this._updateCursor(e,t))}setSelectionBounds(){this.removeBoundsPath();const e=le();if(e.length<=0)return;let t=null;for(const o of e){if(o instanceof i.a.Raster&&!1===o.loaded)return void(o.onLoad=this.setSelectionBounds.bind(this));t=t?t.unite(o.bounds):o.bounds}if(!this.boundsPath){this.boundsPath=new i.a.Group,this.boundsRect=i.a.Path.Rectangle(t),this.boundsRect.curves[0].divideAtTime(.5),this.boundsRect.curves[2].divideAtTime(.5),this.boundsRect.curves[4].divideAtTime(.5),this.boundsRect.curves[6].divideAtTime(.5),this.boundsPath.addChild(this.boundsRect);const e=new i.a.Path.Rectangle({point:[-1,-6],size:[2,12],radius:1,insert:!1}),o=new i.a.Path.Rectangle({point:[-6,-1],size:[12,2],radius:1,insert:!1}),n=e.unite(o);this.boundsPath.addChild(n),this.boundsPath.selectionAnchor=n,this._modeMap[Un.MOVE].setBoundsPath(this.boundsPath)}Pt(this.boundsPath),this.boundsPath.data.isSelectionBound=!0,this.boundsPath.data.isHelperItem=!0,this.boundsPath.fillColor=null,this.boundsPath.parent=Dt(),this.boundsPath.strokeWidth=1/i.a.view.zoom,this.boundsPath.strokeColor=Ie(),this.boundsPath.selectionAnchor.scale(An/i.a.view.zoom/this.boundsPath.selectionAnchor.bounds.width),this.boundsPath.selectionAnchor.position=t.center;const o=new i.a.Path.Circle({center:new i.a.Point(0,0),radius:5.5/i.a.view.zoom,fillColor:"black",opacity:.12,data:{isHelperItem:!0,noSelect:!0,noHover:!0}}),n=new i.a.Path.Circle({center:new i.a.Point(0,0),radius:4/i.a.view.zoom,fillColor:Ie(),data:{isScaleHandle:!0,isHelperItem:!0,noSelect:!0,noHover:!0}}),s=new i.a.Group([o,n]);s.parent=Dt();for(let e=0;e<this.boundsRect.segments.length;e++){const t=this.boundsRect.segments[e];if(7===e){const o=new i.a.Point(0,20),n=new i.a.Path(Nn);n.translate(t.point.add(o).add(-10.5,-5));const s=new i.a.Path.Rectangle(t.point.add(o).subtract(1,0),t.point),a=n.unite(s);s.remove(),n.remove(),a.scale(1/i.a.view.zoom,t.point),a.data={offset:o,isRotHandle:!0,isHelperItem:!0,noSelect:!0,noHover:!0},a.fillColor=Ie(),a.parent=Dt(),this.boundsRotHandles[e]=a}this.boundsScaleHandles[e]=s.clone(),this.boundsScaleHandles[e].position=t.point;for(const t of this.boundsScaleHandles[e].children)t.data.index=e;this.boundsScaleHandles[e].data={index:e,isScaleHandle:!0,isHelperItem:!0,noSelect:!0,noHover:!0}}s.remove()}removeBoundsPath(){Te(),this.boundsPath=null,this.boundsRect=null,this.boundsScaleHandles.length=0,this.boundsRotHandles.length=0}removeBoundsHandles(){ye(),this.boundsScaleHandles.length=0,this.boundsRotHandles.length=0}deactivateTool(){this.removeBoundsPath(),this.setCursor(Tn.DEFAULT)}setCursor(e){this._currentCursor!==e&&(this.dispatchSetCursor(e),this._currentCursor=e)}};const Fn=15;var Hn=class{constructor(e,t,o){this.boundingBoxTool=t,this.onUpdateImage=o,this.boundingBoxTool.isBitmap=e in M}onKeyDown(e){if(e.event.target instanceof HTMLInputElement)return;let t=1/i.a.view.zoom;e.modifiers.shift&&(t*=Fn);const o=le();if(0===o.length)return;let n;for(const e of o)n=n?n.unite(e.bounds):e.bounds;const s=bt(this.boundingBoxTool.isBitmap),a=s.bottom-n.top-1,r=s.top-n.bottom+1,l=s.left-n.right+1,c=s.right-n.left-1;let d;if("up"===e.key?d=new i.a.Point(0,Math.min(a,Math.max(-t,r))):"down"===e.key?d=new i.a.Point(0,Math.max(r,Math.min(t,a))):"left"===e.key?d=new i.a.Point(Math.min(c,Math.max(-t,l)),0):"right"===e.key&&(d=new i.a.Point(Math.max(l,Math.min(t,c)),0)),d){for(const e of o)e.translate(d);this.boundingBoxTool.setSelectionBounds(),e.preventDefault()}}onKeyUp(e){0!==le().length&&("up"!==e.key&&"down"!==e.key&&"left"!==e.key&&"right"!==e.key||this.onUpdateImage())}};class qn extends i.a.Tool{static get TOLERANCE(){return 2}constructor(e,t,o,n){super(),this.setSelectedItems=e,this.clearSelectedItems=t,this.onUpdateImage=n,this.boundingBoxTool=new zn(E.BIT_OVAL,e,t,o,n);const i=new Hn(E.BIT_OVAL,this.boundingBoxTool,n);this.onMouseDown=this.handleMouseDown,this.onMouseDrag=this.handleMouseDrag,this.onMouseMove=this.handleMouseMove,this.onMouseUp=this.handleMouseUp,this.onKeyUp=i.onKeyUp,this.onKeyDown=i.onKeyDown,this.oval=null,this.color=null,this.active=!1}getHitOptions(){return{segments:!1,stroke:!0,curves:!1,fill:!0,guide:!1,match:e=>e.item.data&&(e.item.data.isScaleHandle||e.item.data.isRotHandle)||e.item.selected,tolerance:qn.TOLERANCE/i.a.view.zoom}}onSelectionChanged(e){if(this.boundingBoxTool.onSelectionChanged(e),this.oval&&this.oval.isInserted()||!e||1!==e.length||"ellipse"!==e[0].shape)this.oval&&this.oval.isInserted()&&!this.oval.selected&&this.commitOval();else{this.oval=e[0],this.oval.data.zoomLevel!==i.a.view.zoom&&(this.oval.strokeWidth=this.oval.strokeWidth/this.oval.data.zoomLevel*i.a.view.zoom,this.oval.data.zoomLevel=i.a.view.zoom,this.thickness=this.oval.strokeWidth),this.filled=0===this.oval.strokeWidth;const t=this.filled?this.oval.fillColor:this.oval.strokeColor;this.color=t?t.toCSS():null}}setColor(e){this.color=e,this.oval&&(this.filled?this.oval.fillColor=this.color:this.oval.strokeColor=this.color)}setFilled(e){this.filled!==e&&(this.filled=e,this.oval&&this.oval.isInserted()&&(this.filled?(this.oval.fillColor=this.color,this.oval.strokeWidth=0,this.oval.strokeColor=null):(this.oval.fillColor=null,this.oval.strokeWidth=this.thickness,this.oval.strokeColor=this.color),this.onUpdateImage()))}setThickness(e){this.thickness!==e*i.a.view.zoom&&(this.thickness=e*i.a.view.zoom,this.oval&&this.oval.isInserted()&&!this.filled&&(this.oval.strokeWidth=this.thickness),this.oval&&this.oval.isInserted()&&(this.oval.data.zoomLevel=i.a.view.zoom,this.onUpdateImage()))}handleMouseDown(e){e.event.button>0||(this.active=!0,this.boundingBoxTool.onMouseDown(e,!1,!1,!1,this.getHitOptions())?this.isBoundingBoxMode=!0:(this.isBoundingBoxMode=!1,re(this.clearSelectedItems),this.commitOval(),this.filled?this.oval=new i.a.Shape.Ellipse({fillColor:this.color,point:e.downPoint,strokeWidth:0,strokeScaling:!1,size:0}):this.oval=new i.a.Shape.Ellipse({strokeColor:this.color,strokeWidth:this.thickness,point:e.downPoint,strokeScaling:!1,size:0}),this.oval.data={zoomLevel:i.a.view.zoom}))}handleMouseDrag(e){if(e.event.button>0||!this.active)return;if(this.isBoundingBoxMode)return void this.boundingBoxTool.onMouseDrag(e);const t=new i.a.Point(e.downPoint.x,e.downPoint.y),o=new i.a.Point(e.point.x,e.point.y),n=J(e.downPoint,e.point);e.modifiers.shift?this.oval.size=n.size.abs():this.oval.size=t.subtract(o),e.modifiers.alt?this.oval.position=t:e.modifiers.shift?this.oval.position=n.position:this.oval.position=t.subtract(this.oval.size.multiply(.5))}handleMouseMove(e){this.boundingBoxTool.onMouseMove(e,this.getHitOptions())}handleMouseUp(e){if(!(e.event.button>0)&&this.active){if(this.isBoundingBoxMode)return this.boundingBoxTool.onMouseUp(e),void(this.isBoundingBoxMode=null);this.oval&&(Math.abs(this.oval.size.width*this.oval.size.height)<qn.TOLERANCE/i.a.view.zoom?(this.oval.remove(),this.oval=null):(this.oval.size=new i.a.Point(Math.abs(this.oval.size.width),Math.abs(this.oval.size.height)),this.oval.selected=!0,this.setSelectedItems())),this.active=!1,this.onUpdateImage()}}commitOval(){this.oval&&this.oval.isInserted()&&(Ze(this.oval,yt()),this.oval.remove(),this.oval=null)}deactivateTool(){this.commitOval(),this.boundingBoxTool.deactivateTool()}}var Gn=qn,jn=o(889),Vn=o.n(jn);const Wn=e=>h.a.createElement(an,{imgDescriptor:rn.oval,imgSrc:Vn.a,isSelected:e.isSelected,onMouseDown:e.onMouseDown});Wn.propTypes={isSelected:a.a.bool.isRequired,onMouseDown:a.a.func.isRequired};var Kn=Wn;class Xn extends h.a.Component{constructor(e){super(e),b()(this,["activateTool","deactivateTool"])}componentDidMount(){this.props.isOvalModeActive&&this.activateTool(this.props)}componentWillReceiveProps(e){this.tool&&(e.color!==this.props.color&&this.tool.setColor(e.color),e.selectedItems!==this.props.selectedItems&&this.tool.onSelectionChanged(e.selectedItems),e.filled!==this.props.filled&&this.tool.setFilled(e.filled),e.thickness===this.props.thickness&&e.zoom===this.props.zoom||this.tool.setThickness(e.thickness)),e.isOvalModeActive&&!this.props.isOvalModeActive?this.activateTool():!e.isOvalModeActive&&this.props.isOvalModeActive&&this.deactivateTool()}shouldComponentUpdate(e){return e.isOvalModeActive!==this.props.isOvalModeActive}componentWillUnmount(){this.tool&&this.deactivateTool()}activateTool(){re(this.props.clearSelectedItems),this.props.clearGradient(),this.props.color!==Ro&&null!==this.props.color||this.props.onChangeFillColor(To),this.tool=new Gn(this.props.setSelectedItems,this.props.clearSelectedItems,this.props.setCursor,this.props.onUpdateImage),this.tool.setColor(this.props.color),this.tool.setFilled(this.props.filled),this.tool.setThickness(this.props.thickness),this.tool.activate()}deactivateTool(){this.tool.deactivateTool(),this.tool.remove(),this.tool=null}render(){return h.a.createElement(Kn,{isSelected:this.props.isOvalModeActive,onMouseDown:this.props.handleMouseDown})}}Xn.propTypes={clearGradient:a.a.func.isRequired,clearSelectedItems:a.a.func.isRequired,color:a.a.string,filled:a.a.bool,handleMouseDown:a.a.func.isRequired,isOvalModeActive:a.a.bool.isRequired,onChangeFillColor:a.a.func.isRequired,onUpdateImage:a.a.func.isRequired,selectedItems:a.a.arrayOf(a.a.instanceOf(i.a.Item)),setCursor:a.a.func.isRequired,setSelectedItems:a.a.func.isRequired,thickness:a.a.number.isRequired,zoom:a.a.number.isRequired};var $n=Object(p.connect)(e=>({color:e.scratchPaint.color.fillColor,filled:e.scratchPaint.fillBitmapShapes,isOvalModeActive:e.scratchPaint.mode===E.BIT_OVAL,selectedItems:e.scratchPaint.selectedItems,thickness:e.scratchPaint.bitBrushSize,zoom:e.scratchPaint.viewBounds.scaling.x}),e=>({clearSelectedItems:()=>{e(Qt())},clearGradient:()=>{e(Yo())},setCursor:t=>{e(On(t))},setSelectedItems:()=>{e(Jt(ce(),!0))},handleMouseDown:()=>{e(Vo(E.BIT_OVAL))},onChangeFillColor:t=>{e(Eo(t))}}))(Xn);class Yn extends i.a.Tool{static get TOLERANCE(){return 2}constructor(e,t,o,n){super(),this.setSelectedItems=e,this.clearSelectedItems=t,this.onUpdateImage=n,this.boundingBoxTool=new zn(E.BIT_RECT,e,t,o,n);const i=new Hn(E.BIT_RECT,this.boundingBoxTool,n);this.onMouseDown=this.handleMouseDown,this.onMouseDrag=this.handleMouseDrag,this.onMouseMove=this.handleMouseMove,this.onMouseUp=this.handleMouseUp,this.onKeyUp=i.onKeyUp,this.onKeyDown=i.onKeyDown,this.rect=null,this.color=null,this.active=!1}getHitOptions(){return{segments:!1,stroke:!0,curves:!1,fill:!0,guide:!1,match:e=>e.item.data&&(e.item.data.isScaleHandle||e.item.data.isRotHandle)||e.item.selected,tolerance:Yn.TOLERANCE/i.a.view.zoom}}onSelectionChanged(e){if(this.boundingBoxTool.onSelectionChanged(e),this.rect&&this.rect.isInserted()||!e||1!==e.length||"rectangle"!==e[0].shape)this.rect&&this.rect.isInserted()&&!this.rect.selected&&this.commitRect();else{this.rect=e[0],this.rect.data.zoomLevel!==i.a.view.zoom&&(this.rect.strokeWidth=this.rect.strokeWidth/this.rect.data.zoomLevel*i.a.view.zoom,this.rect.data.zoomLevel=i.a.view.zoom,this.thickness=this.rect.strokeWidth),this.filled=0===this.rect.strokeWidth;const t=this.filled?this.rect.fillColor:this.rect.strokeColor;this.color=t?t.toCSS():null}}setColor(e){this.color=e,this.rect&&(this.filled?this.rect.fillColor=this.color:this.rect.strokeColor=this.color)}setFilled(e){this.filled!==e&&(this.filled=e,this.rect&&this.rect.isInserted()&&(this.filled?(this.rect.fillColor=this.color,this.rect.strokeWidth=0,this.rect.strokeColor=null):(this.rect.fillColor=null,this.rect.strokeWidth=this.thickness,this.rect.strokeColor=this.color),this.onUpdateImage()))}setThickness(e){this.thickness!==e*i.a.view.zoom&&(this.thickness=e*i.a.view.zoom,this.rect&&this.rect.isInserted()&&!this.filled&&(this.rect.strokeWidth=this.thickness),this.rect&&this.rect.isInserted()&&(this.rect.data.zoomLevel=i.a.view.zoom,this.onUpdateImage()))}handleMouseDown(e){e.event.button>0||(this.active=!0,this.boundingBoxTool.onMouseDown(e,!1,!1,!1,this.getHitOptions())?this.isBoundingBoxMode=!0:(this.isBoundingBoxMode=!1,re(this.clearSelectedItems),this.commitRect()))}handleMouseDrag(e){if(e.event.button>0||!this.active)return;if(this.isBoundingBoxMode)return void this.boundingBoxTool.onMouseDrag(e);const t=e.point.subtract(e.downPoint),o=new i.a.Rectangle(e.downPoint,e.point),n=J(e.downPoint,e.point);e.modifiers.shift&&(o.size=n.size.abs()),this.rect&&this.rect.remove(),this.rect=new i.a.Shape.Rectangle(o),this.filled?(this.rect.fillColor=this.color,this.rect.strokeWidth=0):(this.rect.strokeColor=this.color,this.rect.strokeWidth=this.thickness),this.rect.strokeJoin="round",this.rect.strokeScaling=!1,this.rect.data={zoomLevel:i.a.view.zoom},e.modifiers.alt?this.rect.position=e.downPoint:e.modifiers.shift?this.rect.position=n.position:this.rect.position=e.downPoint.add(t.multiply(.5))}handleMouseMove(e){this.boundingBoxTool.onMouseMove(e,this.getHitOptions())}handleMouseUp(e){if(!(e.event.button>0)&&this.active){if(this.isBoundingBoxMode)return this.boundingBoxTool.onMouseUp(e),void(this.isBoundingBoxMode=null);this.rect&&(Math.abs(this.rect.size.width*this.rect.size.height)<Yn.TOLERANCE/i.a.view.zoom?(this.rect.remove(),this.rect=null):(this.rect.size=new i.a.Point(Math.abs(this.rect.size.width),Math.abs(this.rect.size.height)),this.rect.selected=!0,this.setSelectedItems())),this.active=!1,this.onUpdateImage()}}commitRect(){this.rect&&this.rect.isInserted()&&(Je(this.rect,yt()),this.rect.remove(),this.rect=null)}deactivateTool(){this.commitRect(),this.boundingBoxTool.deactivateTool()}}var Zn=Yn,Jn=o(890),Qn=o.n(Jn);const ei=e=>h.a.createElement(an,{imgDescriptor:rn.rect,imgSrc:Qn.a,isSelected:e.isSelected,onMouseDown:e.onMouseDown});ei.propTypes={isSelected:a.a.bool.isRequired,onMouseDown:a.a.func.isRequired};var ti=ei;class oi extends h.a.Component{constructor(e){super(e),b()(this,["activateTool","deactivateTool"])}componentDidMount(){this.props.isRectModeActive&&this.activateTool(this.props)}componentWillReceiveProps(e){this.tool&&(e.color!==this.props.color&&this.tool.setColor(e.color),e.selectedItems!==this.props.selectedItems&&this.tool.onSelectionChanged(e.selectedItems),e.filled!==this.props.filled&&this.tool.setFilled(e.filled),e.thickness===this.props.thickness&&e.zoom===this.props.zoom||this.tool.setThickness(e.thickness)),e.isRectModeActive&&!this.props.isRectModeActive?this.activateTool():!e.isRectModeActive&&this.props.isRectModeActive&&this.deactivateTool()}shouldComponentUpdate(e){return e.isRectModeActive!==this.props.isRectModeActive}componentWillUnmount(){this.tool&&this.deactivateTool()}activateTool(){re(this.props.clearSelectedItems),this.props.clearGradient(),this.props.color!==Ro&&null!==this.props.color||this.props.onChangeFillColor(To),this.tool=new Zn(this.props.setSelectedItems,this.props.clearSelectedItems,this.props.setCursor,this.props.onUpdateImage),this.tool.setColor(this.props.color),this.tool.setFilled(this.props.filled),this.tool.setThickness(this.props.thickness),this.tool.activate()}deactivateTool(){this.tool.deactivateTool(),this.tool.remove(),this.tool=null}render(){return h.a.createElement(ti,{isSelected:this.props.isRectModeActive,onMouseDown:this.props.handleMouseDown})}}oi.propTypes={clearGradient:a.a.func.isRequired,clearSelectedItems:a.a.func.isRequired,color:a.a.string,filled:a.a.bool,handleMouseDown:a.a.func.isRequired,isRectModeActive:a.a.bool.isRequired,onChangeFillColor:a.a.func.isRequired,onUpdateImage:a.a.func.isRequired,selectedItems:a.a.arrayOf(a.a.instanceOf(i.a.Item)),setCursor:a.a.func.isRequired,setSelectedItems:a.a.func.isRequired,thickness:a.a.number.isRequired,zoom:a.a.number.isRequired};var ni=Object(p.connect)(e=>({color:e.scratchPaint.color.fillColor,filled:e.scratchPaint.fillBitmapShapes,isRectModeActive:e.scratchPaint.mode===E.BIT_RECT,selectedItems:e.scratchPaint.selectedItems,thickness:e.scratchPaint.bitBrushSize,zoom:e.scratchPaint.viewBounds.scaling.x}),e=>({clearSelectedItems:()=>{e(Qt())},clearGradient:()=>{e(Yo())},setCursor:t=>{e(On(t))},setSelectedItems:()=>{e(Jt(ce(),!0))},handleMouseDown:()=>{e(Vo(E.BIT_RECT))},onChangeFillColor:t=>{e(Eo(t))}}))(oi),ii=o(907),si=o.n(ii);const ai=e=>h.a.createElement(an,{imgDescriptor:rn.fill,imgSrc:si.a,isSelected:e.isSelected,onMouseDown:e.onMouseDown});ai.propTypes={isSelected:a.a.bool.isRequired,onMouseDown:a.a.func.isRequired};var ri=ai;const li=/^#([0-9a-f]{3}){1,2}$/i,ci=function(e){return{type:"scratch-paint/fill-color/CHANGE_FILL_COLOR_2",fillColor:e}},di="rgba(0,0,0,0)";class hi extends i.a.Tool{constructor(e){super(),this.onUpdateImage=e,this.onMouseDown=this.handleMouseDown,this.onMouseDrag=this.handleMouseDrag,this.color=null,this.color2=null,this.gradientType=null,this.active=!1}setColor(e){this.color=e}setColor2(e){this.color2=e}setGradientType(e){this.gradientType=e}handleMouseDown(e){this.paint(e)}handleMouseDrag(e){this.paint(e)}paint(e){const t=yt().getContext("2d");let o=t,n=this.color;if(this.gradientType!==Co.SOLID){o=xt().getContext("2d"),n="black"}else n||(n=di);let s=!1;if(s=e.event.shiftKey?Ve(e.point.x,e.point.y,n,t,o):je(e.point.x,e.point.y,n,t,o),s&&this.gradientType!==Co.SOLID){const t=new i.a.Raster({insert:!1});t.canvas=o.canvas,t.onLoad=()=>{t.position=yt().position,yt().getContext().globalCompositeOperation="destination-out",yt().drawImage(t.canvas,new i.a.Point),yt().getContext().globalCompositeOperation="source-over";const o=Be(t);if(!o.area)return;const n=new i.a.Shape.Rectangle({insert:!1,rectangle:{topLeft:o.topLeft,bottomRight:o.bottomRight}});n.fillColor=_o(this.color,this.color2,this.gradientType,n.bounds,e.point);const s=n.rasterize(yt().resolution.width,!1);t.getContext().globalCompositeOperation="source-in",t.drawImage(s.canvas,s.bounds.topLeft),yt().drawImage(t.canvas,new i.a.Point),this.onUpdateImage()}}else s&&this.onUpdateImage()}deactivateTool(){}}var pi=hi;class ui extends h.a.Component{constructor(e){super(e),b()(this,["activateTool","deactivateTool"])}componentDidMount(){this.props.isFillModeActive&&this.activateTool(this.props)}componentWillReceiveProps(e){this.tool&&(e.color!==this.props.color&&this.tool.setColor(e.color),e.color2!==this.props.color2&&this.tool.setColor2(e.color2),e.fillModeGradientType!==this.props.fillModeGradientType&&this.tool.setGradientType(e.fillModeGradientType)),e.isFillModeActive&&!this.props.isFillModeActive?this.activateTool():!e.isFillModeActive&&this.props.isFillModeActive&&this.deactivateTool()}shouldComponentUpdate(e){return e.isFillModeActive!==this.props.isFillModeActive}componentWillUnmount(){this.tool&&this.deactivateTool()}activateTool(){re(this.props.clearSelectedItems);let e=this.props.color;this.props.color===Ro&&(e=To,this.props.onChangeFillColor(To,0));const t=this.props.fillModeGradientType?this.props.fillModeGradientType:this.props.selectModeGradientType;let o=this.props.color2;t!==this.props.selectModeGradientType&&(this.props.selectModeGradientType===Co.SOLID&&(o=Po(e),this.props.onChangeFillColor(o,1)),this.props.changeGradientType(t)),this.props.color2===Ro&&(o=Po(),this.props.onChangeFillColor(o,1)),this.tool=new pi(this.props.onUpdateImage),this.tool.setColor(e),this.tool.setColor2(o),this.tool.setGradientType(t),this.tool.activate()}deactivateTool(){this.tool.deactivateTool(),this.tool.remove(),this.tool=null}render(){return h.a.createElement(ri,{isSelected:this.props.isFillModeActive,onMouseDown:this.props.handleMouseDown})}}ui.propTypes={changeGradientType:a.a.func.isRequired,clearSelectedItems:a.a.func.isRequired,color:a.a.string,color2:a.a.string,fillModeGradientType:a.a.oneOf(Object.keys(Co)),handleMouseDown:a.a.func.isRequired,isFillModeActive:a.a.bool.isRequired,onChangeFillColor:a.a.func.isRequired,onUpdateImage:a.a.func.isRequired,selectModeGradientType:a.a.oneOf(Object.keys(Co)).isRequired};var mi=Object(p.connect)(e=>({fillModeGradientType:e.scratchPaint.fillMode.gradientType,color:e.scratchPaint.color.fillColor,color2:e.scratchPaint.color.fillColor2,isFillModeActive:e.scratchPaint.mode===E.BIT_FILL,selectModeGradientType:e.scratchPaint.color.gradientType}),e=>({clearSelectedItems:()=>{e(Qt())},changeGradientType:t=>{e(Ko(t))},handleMouseDown:()=>{e(Vo(E.BIT_FILL))},onChangeFillColor:(t,o)=>{0===o?e(Eo(t)):1===o&&e(ci(t))}}))(ui),fi=o(891),gi=o.n(fi);const bi=e=>h.a.createElement(an,{imgDescriptor:rn.eraser,imgSrc:gi.a,isSelected:e.isSelected,onMouseDown:e.onMouseDown});bi.propTypes={isSelected:a.a.bool.isRequired,onMouseDown:a.a.func.isRequired};var vi=bi;class wi extends h.a.Component{constructor(e){super(e),b()(this,["activateTool","deactivateTool"])}componentDidMount(){this.props.isBitEraserModeActive&&this.activateTool(this.props)}componentWillReceiveProps(e){this.tool&&e.bitEraserSize!==this.props.bitEraserSize&&this.tool.setBrushSize(e.bitEraserSize),e.isBitEraserModeActive&&!this.props.isBitEraserModeActive?this.activateTool():!e.isBitEraserModeActive&&this.props.isBitEraserModeActive&&this.deactivateTool()}shouldComponentUpdate(e){return e.isBitEraserModeActive!==this.props.isBitEraserModeActive}componentWillUnmount(){this.tool&&this.deactivateTool()}activateTool(){re(this.props.clearSelectedItems),this.tool=new un(this.props.onUpdateImage,!0),this.tool.setBrushSize(this.props.bitEraserSize),this.tool.activate()}deactivateTool(){this.tool.deactivateTool(),this.tool.remove(),this.tool=null}render(){return h.a.createElement(vi,{isSelected:this.props.isBitEraserModeActive,onMouseDown:this.props.handleMouseDown})}}wi.propTypes={bitEraserSize:a.a.number.isRequired,clearSelectedItems:a.a.func.isRequired,handleMouseDown:a.a.func.isRequired,isBitEraserModeActive:a.a.bool.isRequired,onUpdateImage:a.a.func.isRequired};var Si=Object(p.connect)(e=>({bitEraserSize:e.scratchPaint.bitEraserSize,isBitEraserModeActive:e.scratchPaint.mode===E.BIT_ERASER}),e=>({clearSelectedItems:()=>{e(Qt())},handleMouseDown:()=>{e(Vo(E.BIT_ERASER))}}))(wi);var Ci=class{constructor(e,t,o){this.selectionRect=null,this.mode=e,this.setSelectedItems=t,this.clearSelectedItems=o}onMouseDown(e){e||(re(this.clearSelectedItems),this.clearSelectedItems())}onMouseDrag(e){e.event.button>0||(this.selectionRect&&this.selectionRect.remove(),this.selectionRect=Ce(e))}onMouseUpVector(e){e.event.button>0||this.selectionRect&&(ge(e,this.selectionRect,this.mode),this.selectionRect.remove(),this.selectionRect=null,this.setSelectedItems())}onMouseUpBitmap(e){if(!(e.event.button>0)&&this.selectionRect){let e=new i.a.Rectangle({from:new i.a.Point(Math.max(0,Math.round(this.selectionRect.bounds.topLeft.x)),Math.max(0,Math.round(this.selectionRect.bounds.topLeft.y))),to:new i.a.Point(Math.min(ot,Math.round(this.selectionRect.bounds.bottomRight.x)),Math.min(nt,Math.round(this.selectionRect.bounds.bottomRight.y)))});if(e=Be(yt(),e),e.area){const t=yt().getSubRaster(e);t.parent=i.a.project.activeLayer,t.canvas.getContext("2d").imageSmoothingEnabled=!1,t.selected=!0;const o=yt().getSubRaster(e.expand(4));o.remove(),t.data={expanded:o},yt().getContext(!0).clearRect(e.x,e.y,e.width,e.height),this.setSelectedItems()}this.selectionRect.remove(),this.selectionRect=null}}};class Ii extends i.a.Tool{static get TOLERANCE(){return 2}constructor(e,t,o,n){super(),this.onUpdateImage=n,this.boundingBoxTool=new zn(E.BIT_SELECT,e,t,o,n);const i=new Hn(E.BIT_SELECT,this.boundingBoxTool,n);this.selectionBoxTool=new Ci(E.BIT_SELECT,e,t),this.selectionBoxMode=!1,this.selection=null,this.active=!1,this.onMouseDown=this.handleMouseDown,this.onMouseDrag=this.handleMouseDrag,this.onMouseMove=this.handleMouseMove,this.onMouseUp=this.handleMouseUp,this.onKeyUp=i.onKeyUp,this.onKeyDown=i.onKeyDown,this.boundingBoxTool.setSelectionBounds()}onSelectionChanged(e){this.boundingBoxTool.onSelectionChanged(e),this.selection&&this.selection.parent&&!this.selection.selected&&this.commitSelection(),(!this.selection||!this.selection.parent)&&e&&1===e.length&&e[0]instanceof i.a.Raster&&(this.selection=e[0])}getHitOptions(){return{segments:!0,stroke:!0,curves:!0,fill:!0,guide:!1,tolerance:Ii.TOLERANCE/i.a.view.zoom,match:e=>!e.item.data||!e.item.data.isHelperItem||(e.item.data.isScaleHandle||e.item.data.isRotHandle)}}handleMouseDown(e){e.event.button>0||(this.active=!0,this.boundingBoxTool.onMouseDown(e,e.modifiers.alt,e.modifiers.shift,!1,this.getHitOptions())||(this.commitSelection(),this.selectionBoxMode=!0,this.selectionBoxTool.onMouseDown(e.modifiers.shift)))}handleMouseDrag(e){e.event.button>0||!this.active||(this.selectionBoxMode?this.selectionBoxTool.onMouseDrag(e):this.boundingBoxTool.onMouseDrag(e))}handleMouseMove(e){this.boundingBoxTool.onMouseMove(e,this.getHitOptions())}handleMouseUp(e){e.event.button>0||!this.active||(this.selectionBoxMode?this.selectionBoxTool.onMouseUpBitmap(e):this.boundingBoxTool.onMouseUp(e),this.selectionBoxMode=!1,this.active=!1)}commitSelection(){this.selection&&this.selection.parent&&(Ye(this.selection,yt()),this.selection.remove(),this.selection=null,this.onUpdateImage())}deactivateTool(){this.commitSelection(),this.boundingBoxTool.deactivateTool(),this.boundingBoxTool=null,this.selectionBoxTool=null}}var xi=Ii,Ti=o(908),yi=o.n(Ti);const Mi=e=>h.a.createElement(an,{imgDescriptor:rn.select,imgSrc:yi.a,isSelected:e.isSelected,onMouseDown:e.onMouseDown});Mi.propTypes={isSelected:a.a.bool.isRequired,onMouseDown:a.a.func.isRequired};var Ei=Mi;class Ri extends h.a.Component{constructor(e){super(e),b()(this,["activateTool","deactivateTool"])}componentDidMount(){this.props.isSelectModeActive&&this.activateTool(this.props)}componentWillReceiveProps(e){this.tool&&e.selectedItems!==this.props.selectedItems&&this.tool.onSelectionChanged(e.selectedItems),e.isSelectModeActive&&!this.props.isSelectModeActive?this.activateTool():!e.isSelectModeActive&&this.props.isSelectModeActive&&this.deactivateTool()}shouldComponentUpdate(e){return e.isSelectModeActive!==this.props.isSelectModeActive}componentWillUnmount(){this.tool&&this.deactivateTool()}activateTool(){this.props.clearGradient(),this.tool=new xi(this.props.setSelectedItems,this.props.clearSelectedItems,this.props.setCursor,this.props.onUpdateImage),this.tool.activate()}deactivateTool(){this.tool.deactivateTool(),this.tool.remove(),this.tool=null}render(){return h.a.createElement(Ei,{isSelected:this.props.isSelectModeActive,onMouseDown:this.props.handleMouseDown})}}Ri.propTypes={clearGradient:a.a.func.isRequired,clearSelectedItems:a.a.func.isRequired,handleMouseDown:a.a.func.isRequired,isSelectModeActive:a.a.bool.isRequired,onUpdateImage:a.a.func.isRequired,selectedItems:a.a.arrayOf(a.a.instanceOf(i.a.Item)),setCursor:a.a.func.isRequired,setSelectedItems:a.a.func.isRequired};var ki=Object(p.connect)(e=>({isSelectModeActive:e.scratchPaint.mode===E.BIT_SELECT,selectedItems:e.scratchPaint.selectedItems}),e=>({clearGradient:()=>{e(Yo())},clearSelectedItems:()=>{e(Qt())},setCursor:t=>{e(On(t))},setSelectedItems:()=>{e(Jt(ce()))},handleMouseDown:()=>{e(Vo(E.BIT_SELECT))}}))(Ri),Oi=o(323),Di=o.n(Oi);!function(){const e=function(e){let t=601,o=987654321;const n=4294967295;return function(){o=36969*(65535&o)+(o>>16)&n,t=18e3*(65535&t)+(t>>16)&n;let e=(o<<16)+t&n;return e/=4294967296,e+1}}()}();const Pi=e=>{const{alignContent:t,alignItems:o,alignSelf:n,basis:i,children:s,className:a,componentRef:r,direction:l,element:c,grow:d,height:p,justifyContent:u,width:m,wrap:f,shrink:g,style:b,...v}=e;return h.a.createElement(c,{className:a,ref:r,style:Object.assign({alignContent:t,alignItems:o,alignSelf:n,flexBasis:i,flexDirection:l,flexGrow:d,flexShrink:g,flexWrap:f,justifyContent:u,width:m,height:p},{},b),...v},s)};Pi.propTypes={alignContent:a.a.oneOf(["flex-start","flex-end","center","space-between","space-around","stretch"]),alignItems:a.a.oneOf(["flex-start","flex-end","center","baseline","stretch"]),alignSelf:a.a.oneOf(["auto","flex-start","flex-end","center","baseline","stretch"]),basis:a.a.oneOfType([a.a.number,a.a.oneOf(["auto"])]),children:a.a.node,className:a.a.string,componentRef:a.a.func,direction:a.a.oneOf(["row","row-reverse","column","column-reverse"]),element:a.a.string,grow:a.a.number,height:a.a.oneOfType([a.a.number,a.a.string]),justifyContent:a.a.oneOf(["flex-start","flex-end","center","space-between","space-around"]),shrink:a.a.number,style:Di.a,width:a.a.oneOfType([a.a.number,a.a.string]),wrap:a.a.oneOf(["nowrap","wrap","wrap-reverse"])},Pi.defaultProps={element:"div",style:{}};var _i=Pi,Li=o(909),Bi=o.n(Li);const Ai=e=>h.a.createElement("div",{className:m()(e.className,Bi.a.buttonGroup)},e.children);Ai.propTypes={children:a.a.node.isRequired,className:a.a.string};var Ni=Ai;var Ui=class{constructor(){this.lastVec=null,this.lastPoint=null,this.finalPath=null,this.smoothed=0,this.smoothingThreshold=20,this.steps=0,this.endCaps=[]}onBroadMouseDown(e,t,o){this.steps=0,this.smoothed=0,t.minDistance=Math.min(5,Math.max(2/i.a.view.zoom,o.brushSize/2)),t.maxDistance=o.brushSize,e.event.button>0||(this.finalPath=new i.a.Path.Circle({center:e.point,radius:o.brushSize/2}),Fo(this.finalPath,o),this.lastPoint=e.point)}onBroadMouseDrag(e,t,o){this.steps++;const n=e.delta.normalize(o.brushSize/2);if(this.lastVec){const t=this.lastVec.getDirectedAngle(n);if(Math.abs(t)>126){this.simplify(1),this.smoothed++;const t=new i.a.Path.Circle(this.lastPoint,o.brushSize/2);t.fillColor=o.fillColor;const s=new i.a.Path.Rectangle(this.lastPoint.subtract(new i.a.Point(-o.brushSize/2,0)),this.lastPoint.subtract(new i.a.Point(o.brushSize/2,this.lastVec.length)));s.fillColor=o.fillColor,s.rotate(this.lastVec.angle-90,this.lastPoint);const a=new i.a.Path.Rectangle(e.point.subtract(new i.a.Point(-o.brushSize/2,0)),e.point.subtract(new i.a.Point(o.brushSize/2,e.delta.length)));a.fillColor=o.fillColor,a.rotate(n.angle-90,e.point),this.endCaps.push(this.union(t,this.union(s,a)))}}if(this.lastVec=e.delta,n.angle+=90,1===this.steps){this.finalPath.remove(),this.finalPath=new i.a.Path;const t=e.delta.normalize(o.brushSize/2);this.finalPath.add(new i.a.Segment(this.lastPoint.subtract(t),t.rotate(-90),t.rotate(90))),Fo(this.finalPath,o),this.finalPath.insert(0,new i.a.Segment(this.lastPoint.subtract(n))),this.finalPath.add(new i.a.Segment(this.lastPoint.add(n)))}const s=e.middlePoint.add(n),a=e.middlePoint.subtract(n);this.finalPath.add(s),this.finalPath.add(e.point.add(n)),this.finalPath.insert(0,a),this.finalPath.insert(0,e.point.subtract(n)),this.finalPath.segments.length>this.smoothed+2*this.smoothingThreshold&&this.simplify(1),this.lastPoint=e.point}simplify(e){const t=this.finalPath.segments.length,o=Math.floor((t-this.smoothed)/2)+1,n=Math.min(o+1,Math.floor(t/2)),s=Math.max(t-1-o,Math.floor(t/2)+1);if(n<=1||s>=t-1)return;const a=new i.a.Path(this.finalPath.segments.slice(1,n)),r=new i.a.Path(this.finalPath.segments.slice(n,s)),l=new i.a.Path(this.finalPath.segments.slice(s,t-1)),c=a.segments[a.segments.length-1],d=l.segments[0];a.simplify(e),l.simplify(e);const h=a.segments[a.segments.length-1],p=l.segments[0];h.handleOut=c.handleOut,p.handleIn=d.handleIn,this.finalPath.removeSegments(1,this.finalPath.segments.length-1),this.finalPath.insertSegments(1,a.segments.concat(r.segments).concat(l.segments)),a.remove(),l.remove(),r.remove(),this.smoothed=Math.max(2,this.finalPath.segments.length)}union(e,t){const o=e.unite(t);return e.remove(),t.remove(),o}onBroadMouseUp(e,t,o){if(0===this.steps)return this.endCaps.length=0,this.finalPath;if(!e.point.equals(this.lastPoint)){const t=e.delta.normalize(o.brushSize/2);t.angle+=90;const n=e.point.add(t),i=e.point.subtract(t);this.finalPath.add(n),this.finalPath.insert(0,i)}this.simplify(1);const n=e.delta.normalize(o.brushSize/2);this.finalPath.add(new i.a.Segment(e.point.add(n),n.rotate(90),n.rotate(-90))),this.finalPath.closePath();const s=this.finalPath.resolveCrossings().reorient(!0,!0).reduce({simplify:!0});s!==this.finalPath&&(s.copyAttributes(this.finalPath),s.fillColor=this.finalPath.fillColor,this.finalPath.remove(),this.finalPath=s);for(const e of this.endCaps){const t=this.union(this.finalPath,e);t.area>=this.finalPath.area&&(!(t instanceof i.a.CompoundPath)||this.finalPath instanceof i.a.CompoundPath)?this.finalPath=t:(this.finalPath.insertAbove(t),t.remove(),c.warn("Skipping a merge."))}return this.endCaps.length=0,this.finalPath}};var zi=class{constructor(){this.lastPoint=null,this.finalPath=null,this.firstCircle=null}onSegmentMouseDown(e,t,o){e.event.button>0||(t.minDistance=2/i.a.view.zoom,t.maxDistance=o.brushSize,this.firstCircle=new i.a.Path.Circle({center:e.point,radius:o.brushSize/2}),this.finalPath=this.firstCircle,Fo(this.finalPath,o),this.lastPoint=e.point)}onSegmentMouseDrag(e,t,o){if(e.event.button>0)return;const n=e.delta.normalize(o.brushSize/2),s=n.clone();s.length=o.brushSize/2,s.angle+=90;const a=new i.a.Path;Fo(a,o),a.add(new i.a.Segment(this.lastPoint.subtract(n),s.multiply(-1),s)),n.angle+=90,a.add(e.lastPoint.add(n)),a.insert(0,e.lastPoint.subtract(n)),a.add(e.point.add(n)),a.insert(0,e.point.subtract(n)),n.angle-=90,a.add(new i.a.Segment(e.point.add(n),s,s.multiply(-1))),a.closed=!0,a.flatten(Math.min(5,o.brushSize/5)),this.lastPoint=e.point;const r=this.finalPath.unite(a);a.remove(),this.finalPath.remove(),this.finalPath=r}onSegmentMouseUp(e){if(!(e.event.button>0)){if(this.finalPath.segments&&this.finalPath.segments.length>4){this.finalPath.closed=!1,this.finalPath.simplify(2),this.finalPath.closed=!0;const e=this.finalPath.unite(this.firstCircle);this.finalPath.remove(),this.finalPath=e}return this.finalPath}}};class Fi{static get BROAD(){return"broadbrush"}static get SEGMENT(){return"segmentbrush"}static get THRESHOLD(){return 30/i.a.view.zoom}constructor(e,t){this.broadBrushHelper=new Ui,this.segmentBrushHelper=new zi,this.onUpdateImage=e,this.clearSelectedItems=t,this.strokeColor=null,this.brushSize=null,this.fillColor=null}setOptions(e){const t=this.options?this.options.fillColor:"black",o=this.options?this.options.strokeColor:null,n=this.options?this.options.strokeWidth:null;this.options={...e,fillColor:e.fillColor===Ro?t:e.fillColor,strokeColor:e.strokeColor===Ro?o:e.strokeColor,strokeWidth:null===e.strokeWidth?n:e.strokeWidth},this.resizeCursorIfNeeded()}activateTool(e){this.tool=new i.a.Tool,this.cursorPreviewLastPoint=new i.a.Point(-1e4,-1e4),this.setOptions(e),this.tool.active=!1,this.tool.fixedDistance=1;const t=this;this.tool.onMouseMove=function(e){t.resizeCursorIfNeeded(e.point),qo(t.cursorPreview,t.options),t.cursorPreview.bringToFront(),t.cursorPreview.position=e.point},this.tool.onMouseDown=function(e){t.resizeCursorIfNeeded(e.point),e.event.button>0||(this.active=!0,t.options.brushSize<Fi.THRESHOLD?(t.brush=Fi.BROAD,t.broadBrushHelper.onBroadMouseDown(e,t.tool,t.options)):(t.brush=Fi.SEGMENT,t.segmentBrushHelper.onSegmentMouseDown(e,t.tool,t.options)),t.cursorPreview.bringToFront(),t.cursorPreview.position=e.point)},this.tool.onMouseDrag=function(e){e.event.button>0||!this.active||(t.brush===Fi.BROAD?t.broadBrushHelper.onBroadMouseDrag(e,t.tool,t.options):t.brush===Fi.SEGMENT?t.segmentBrushHelper.onSegmentMouseDrag(e,t.tool,t.options):c.warn(`Brush type does not exist: ${t.brush}`),t.cursorPreview.bringToFront(),t.cursorPreview.position=e.point)},this.tool.onMouseUp=function(e){if(e.event.button>0||!this.active)return;let o;t.brush===Fi.BROAD?o=t.broadBrushHelper.onBroadMouseUp(e,t.tool,t.options):t.brush===Fi.SEGMENT?o=t.segmentBrushHelper.onSegmentMouseUp(e,t.tool,t.options):c.warn(`Brush type does not exist: ${t.brush}`),t.options.isEraser?t.mergeEraser(o):t.mergeBrush(o),t.cursorPreview.remove(),t.onUpdateImage(),t.cursorPreview.parent=Dt(),t.brush=null,this.fixedDistance=1,this.active=!1},this.tool.activate()}resizeCursorIfNeeded(e){this.options&&(this.cursorPreview&&!this.cursorPreview.parent&&(this.cursorPreview=null),this.cursorPreview&&this.brushSize===this.options.brushSize&&this.fillColor===this.options.fillColor&&this.strokeColor===this.options.strokeColor&&this.cursorPreviewLastPoint.equals(e)||(void 0!==e&&(this.cursorPreviewLastPoint=e),this.cursorPreview||(this.cursorPreview=new i.a.Shape.Ellipse({point:this.cursorPreviewLastPoint,size:this.options.brushSize/2}),this.cursorPreview.parent=Dt(),this.cursorPreview.data.isHelperItem=!0,Pt(this.cursorPreview)),this.cursorPreview.position=this.cursorPreviewLastPoint,this.cursorPreview.radius=this.options.brushSize/2,this.brushSize=this.options.brushSize,this.fillColor=this.options.fillColor,this.strokeColor=this.options.strokeColor,qo(this.cursorPreview,this.options)))}mergeBrush(e){const t=this,o=Q({match:function(o){return t.isMergeable(e,o)&&o.parent instanceof i.a.Layer}});let n,s=e;for(n=o.length-1;n>=0&&!this.touches(o[n],e);n--);let a=n;for(;n>=0;n--)if(this.touches(o[n],e))if(o[n].getFillColor()){if(this.colorMatch(o[n],e)){for(let e=a;e>n;e--)this.touches(o[e],o[n]);const t=s.unite(o[n]);t.strokeColor=o[n].strokeColor,t.strokeWidth=o[n].strokeWidth,s===e?t.insertAbove(o[n]):(t.insertAbove(s),a--),s.remove(),s=t,o[n].remove(),o.splice(n,1)}}else;}mergeEraser(e){const t=this;let o=Q({match:function(o){return o.selected&&t.isMergeable(e,o)&&t.touches(e,o)&&!H(o)},class:i.a.PathItem});0===o.length&&(re(this.clearSelectedItems),o=Q({match:function(o){return t.isMergeable(e,o)&&t.touches(e,o)&&!H(o)},class:i.a.PathItem}));for(let t=o.length-1;t>=0;t--){if(o[t]instanceof i.a.Path&&(!o[t].fillColor||0===o[t].fillColor._alpha)){const n=[],i=o[t],s=i.getIntersections(e);for(let e=s.length-1;e>=0;e--){const t=i.splitAt(s[e]);t&&(t.insertAbove(i),n.push(t))}n.push(i);for(let t=n.length-1;t>=0;t--){const o=n[t].getLocationAt(n[t].length/2).point;e.contains(o)&&(n[t].remove(),n.splice(t,1))}e.remove();continue}const n=o[t].subtract(e);n.insertBelow(o[t]);const s=[];if(o[t]instanceof i.a.Path&&!o[t].closed){const n=o[t].clone(),i=n.getIntersections(e);for(let e=i.length-1;e>=0;e--){const t=n.splitAt(i[e]);t.insertAbove(n),s.push(t)}s.push(n)}for(let t=s.length-1;t>=0;t--){const o=s[t].getLocationAt(s[t].length/2).point;(e.contains(o)||n.contains(o))&&(s[t].remove(),s.splice(t,1))}n.children&&(this.separateCompoundPath(n),n.remove()),o[t].remove()}e.remove()}separateCompoundPath(e){e.isClockwise()||e.reverse();const t=[],o=[];for(let n=e.children.length-1;n>=0;n--){const i=e.children[n];i.isClockwise()?t.push(i):o.push(i)}t.sort((e,t)=>e.area-t.area),o.sort((e,t)=>Math.abs(e.area)-Math.abs(t.area));for(let n=0;n<t.length;n++){const i=t[n];i.copyAttributes(e),i.fillColor=e.fillColor,i.strokeColor=e.strokeColor,i.strokeWidth=e.strokeWidth,i.insertAbove(e);let s=i;for(let t=o.length-1;t>=0;t--){const n=o[t];if(this.firstEnclosesSecond(i,n)){const i=s.subtract(n);i.insertAbove(e),s.remove(),s=i,n.remove(),o.splice(t,1)}}}}colorMatch(e,t){return e.getFillColor().equals(t.getFillColor())&&(t.getStrokeColor()===e.getStrokeColor()||t.getStrokeColor()&&t.getStrokeColor().equals(e.getStrokeColor()))&&t.getStrokeWidth()===e.getStrokeWidth()&&this.touches(e,t)}touches(e,t){return!!(e&&t&&e.intersects(t))||(this.firstEnclosesSecond(e,t)||this.firstEnclosesSecond(t,e))}firstEnclosesSecond(e,t){return!!(e&&t&&t.firstSegment&&t.firstSegment.point&&e.hitTest(t.firstSegment.point))}matchesAnyChild(e,t){for(const o of e.children){if(o.children&&this.matchesAnyChild(t,o))return!0;if(t===o)return!0}return!1}isMergeable(e,t){if(t instanceof i.a.PathItem)return(!e.children||!this.matchesAnyChild(e,t))&&t!==e}deactivateTool(){this.cursorPreview&&(this.cursorPreview.remove(),this.cursorPreview=null),this.tool.remove(),this.tool=null}}var Hi=Fi,qi=o(892),Gi=o.n(qi);const ji=e=>h.a.createElement(an,{imgDescriptor:rn.brush,imgSrc:Gi.a,isSelected:e.isSelected,onMouseDown:e.onMouseDown});ji.propTypes={isSelected:a.a.bool.isRequired,onMouseDown:a.a.func.isRequired};var Vi=ji;class Wi extends h.a.Component{constructor(e){super(e),b()(this,["activateTool","deactivateTool"]),this.blob=new Hi(this.props.onUpdateImage,this.props.clearSelectedItems)}componentDidMount(){this.props.isBrushModeActive&&this.activateTool(this.props)}componentWillReceiveProps(e){e.isBrushModeActive&&!this.props.isBrushModeActive?this.activateTool():!e.isBrushModeActive&&this.props.isBrushModeActive?this.deactivateTool():e.isBrushModeActive&&this.props.isBrushModeActive&&this.blob.setOptions({isEraser:!1,...e.colorState,...e.brushModeState})}shouldComponentUpdate(e){return e.isBrushModeActive!==this.props.isBrushModeActive}componentWillUnmount(){this.blob.tool&&this.deactivateTool()}activateTool(){re(this.props.clearSelectedItems),this.props.clearGradient();const{fillColor:e}=this.props.colorState;e!==Ro&&null!==e||this.props.onChangeFillColor(To),this.blob.activateTool({isEraser:!1,...this.props.colorState,...this.props.brushModeState})}deactivateTool(){this.blob.deactivateTool()}render(){return h.a.createElement(Vi,{isSelected:this.props.isBrushModeActive,onMouseDown:this.props.handleMouseDown})}}Wi.propTypes={brushModeState:a.a.shape({brushSize:a.a.number.isRequired}),clearGradient:a.a.func.isRequired,clearSelectedItems:a.a.func.isRequired,colorState:a.a.shape({fillColor:a.a.string,strokeColor:a.a.string,strokeWidth:a.a.number}).isRequired,handleMouseDown:a.a.func.isRequired,isBrushModeActive:a.a.bool.isRequired,onChangeFillColor:a.a.func.isRequired,onUpdateImage:a.a.func.isRequired};var Ki=Object(p.connect)(e=>({brushModeState:e.scratchPaint.brushMode,colorState:e.scratchPaint.color,isBrushModeActive:e.scratchPaint.mode===E.BRUSH}),e=>({clearSelectedItems:()=>{e(Qt())},clearGradient:()=>{e(Yo())},handleMouseDown:()=>{e(Vo(E.BRUSH))},onChangeFillColor:t=>{e(Eo(t))}}))(Wi);const Xi={brushSize:40},$i=function(e){return{type:"scratch-paint/eraser-mode/CHANGE_ERASER_SIZE",brushSize:e}};var Yi=o(893),Zi=o.n(Yi);const Ji=e=>h.a.createElement(an,{imgDescriptor:rn.eraser,imgSrc:Zi.a,isSelected:e.isSelected,onMouseDown:e.onMouseDown});Ji.propTypes={isSelected:a.a.bool.isRequired,onMouseDown:a.a.func.isRequired};var Qi=Ji;class es extends h.a.Component{constructor(e){super(e),b()(this,["activateTool","deactivateTool"]),this.blob=new Hi(this.props.onUpdateImage,this.props.clearSelectedItems)}componentDidMount(){this.props.isEraserModeActive&&this.activateTool()}componentWillReceiveProps(e){e.isEraserModeActive&&!this.props.isEraserModeActive?this.activateTool():!e.isEraserModeActive&&this.props.isEraserModeActive?this.deactivateTool():e.isEraserModeActive&&this.props.isEraserModeActive&&this.blob.setOptions({isEraser:!0,...e.eraserModeState})}shouldComponentUpdate(e){return e.isEraserModeActive!==this.props.isEraserModeActive}componentWillUnmount(){this.blob.tool&&this.deactivateTool()}activateTool(){this.blob.activateTool({isEraser:!0,...this.props.eraserModeState})}deactivateTool(){this.blob.deactivateTool()}render(){return h.a.createElement(Qi,{isSelected:this.props.isEraserModeActive,onMouseDown:this.props.handleMouseDown})}}es.propTypes={clearSelectedItems:a.a.func.isRequired,eraserModeState:a.a.shape({brushSize:a.a.number.isRequired}),handleMouseDown:a.a.func.isRequired,isEraserModeActive:a.a.bool.isRequired,onUpdateImage:a.a.func.isRequired};var ts=Object(p.connect)(e=>({eraserModeState:e.scratchPaint.eraserMode,isEraserModeActive:e.scratchPaint.mode===E.ERASER}),e=>({clearSelectedItems:()=>{e(Qt())},changeBrushSize:t=>{e($i(t))},handleMouseDown:()=>{e(Vo(E.ERASER))}}))(es);const os=function(e){return{type:"scratch-paint/color-index/CHANGE_COLOR_INDEX",index:e}},ns="scratch-paint/modals/OPEN_MODAL",is={fillColor:!1,strokeColor:!1},ss=function(e){return{type:ns,modal:e}},as=function(e){return{type:"scratch-paint/modals/CLOSE_MODAL",modal:e}};var rs=o(250),ls=o.n(rs),cs=o(894),ds=o.n(cs),hs=o(895),ps=o.n(hs),us=o(911),ms=o.n(us);const fs=(e,t,o)=>{if(e===Ro||t===Ro)return"white";switch(null===e&&(e="white"),null===t&&(t="white"),o){case Co.SOLID:return e;case Co.HORIZONTAL:return`linear-gradient(to right, ${e}, ${t})`;case Co.VERTICAL:return`linear-gradient(${e}, ${t})`;case Co.RADIAL:return`radial-gradient(${e}, ${t})`;default:c.error(`Unrecognized gradient type: ${o}`)}},gs=e=>h.a.createElement("div",{className:ms.a.colorButton,onClick:e.onClick},h.a.createElement("div",{className:m()(ms.a.colorButtonSwatch,{[ms.a.outlineSwatch]:e.outline&&!(e.color===Ro)}),style:{background:fs(e.color,e.color2,e.gradientType)}},null!==e.color||e.gradientType!==Co.SOLID&&null!==e.color2?e.color===Ro||e.gradientType!==Co.SOLID&&e.color2===Ro?h.a.createElement("img",{className:ms.a.swatchIcon,draggable:!1,src:ps.a}):null:h.a.createElement("img",{className:ms.a.swatchIcon,draggable:!1,src:ds.a})),h.a.createElement("div",{className:ms.a.colorButtonArrow},""));gs.propTypes={color:a.a.string,color2:a.a.string,gradientType:a.a.oneOf(Object.keys(Co)).isRequired,onClick:a.a.func.isRequired,outline:a.a.bool.isRequired},gs.defaultProps={outline:!1};var bs=gs,vs=o(913),ws=o.n(vs);const Ss=150,Cs=26;class Is extends h.a.Component{constructor(e){super(e),b()(this,["handleMouseDown","handleMouseUp","handleMouseMove","handleClickBackground","setBackground"])}handleMouseDown(){document.addEventListener("mousemove",this.handleMouseMove),document.addEventListener("mouseup",this.handleMouseUp),document.addEventListener("touchmove",this.handleMouseMove,{passive:!1}),document.addEventListener("touchend",this.handleMouseUp)}handleMouseUp(){document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp),document.removeEventListener("touchmove",this.handleMouseMove,{passive:!1}),document.removeEventListener("touchend",this.handleMouseUp)}handleMouseMove(e){e.preventDefault(),this.props.onChange(this.scaleMouseToSliderPosition(e))}handleClickBackground(e){this.props.onChange(this.scaleMouseToSliderPosition(e))}scaleMouseToSliderPosition(e){const{x:t}=vo(e),o=this.background.getBoundingClientRect(),n=t-o.left;return Math.max(0,Math.min(100,100*n/o.width))}setBackground(e){this.background=e}render(){const e=Cs/2,t=e+(Ss-e-e)*(this.props.value/100)-e;return h.a.createElement("div",{className:m()({[ws.a.container]:!0,[ws.a.last]:this.props.lastSlider}),ref:this.setBackground,style:{backgroundImage:this.props.background},onClick:this.handleClickBackground},h.a.createElement("div",{className:ws.a.handle,style:{left:`${t}px`},onMouseDown:this.handleMouseDown,onTouchStart:this.handleMouseDown}))}}Is.propTypes={background:a.a.string,lastSlider:a.a.bool,onChange:a.a.func.isRequired,value:a.a.number.isRequired},Is.defaultProps={background:"yellow"};var xs=Is,Ts=o(915),ys=o.n(Ts);function Ms(){return(Ms=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e}).apply(this,arguments)}const Es=({className:e,hideLabel:t,imgAlt:o,imgSrc:n,onClick:i,title:s,...a})=>h.a.createElement(tn,Ms({className:m()(e,ys.a.modEditField),onClick:i},a),h.a.createElement("img",{alt:o||s,className:ys.a.editFieldIcon,draggable:!1,src:n,title:s}),!t&&h.a.createElement("span",{className:ys.a.editFieldTitle},s));Es.propTypes={className:a.a.string,hideLabel:a.a.bool,highlighted:a.a.bool,imgAlt:a.a.string,imgSrc:a.a.string.isRequired,onClick:a.a.func.isRequired,title:a.a.string.isRequired};var Rs=Es,ks=o(917),Os=o.n(ks),Ds=o(919),Ps=o.n(Ds),_s=o(920),Ls=o.n(_s),Bs=o(921),As=o.n(Bs),Ns=o(922),Us=o.n(Ns),zs=o(923),Fs=o.n(zs),Hs=o(924),qs=o.n(Hs);const Gs=(e,t,o)=>xo()(`hsv(${3.6*e}, ${t}, ${o})`).hex,js=Object(f.defineMessages)({swap:{defaultMessage:"Swap",description:"Label for button that swaps the two colors in a gradient",id:"paint.colorPicker.swap"}});class Vs extends h.a.Component{_makeBackground(e){const t=[];for(let o=100;o>=0;o-=10)switch(e){case"hue":t.push(Gs(o,this.props.saturation,this.props.brightness));break;case"saturation":t.push(Gs(this.props.hue,o,this.props.brightness));break;case"brightness":t.push(Gs(this.props.hue,this.props.saturation,o));break;default:throw new Error(`Unknown channel for color sliders: ${e}`)}return`linear-gradient(to left, ${t.join(",")})`}render(){return h.a.createElement("div",{className:Os.a.colorPickerContainer,dir:this.props.rtl?"rtl":"ltr"},this.props.shouldShowGradientTools?h.a.createElement("div",null,h.a.createElement("div",{className:Os.a.row},h.a.createElement("div",{className:Os.a.gradientPickerRow},h.a.createElement("img",{className:m()({[Os.a.inactiveGradient]:this.props.gradientType!==Co.SOLID,[Os.a.clickable]:!0}),draggable:!1,src:Us.a,onClick:this.props.onChangeGradientTypeSolid}),h.a.createElement("img",{className:m()({[Os.a.inactiveGradient]:this.props.gradientType!==Co.HORIZONTAL,[Os.a.clickable]:!0}),draggable:!1,src:Ls.a,onClick:this.props.onChangeGradientTypeHorizontal}),h.a.createElement("img",{className:m()({[Os.a.inactiveGradient]:this.props.gradientType!==Co.VERTICAL,[Os.a.clickable]:!0}),draggable:!1,src:Fs.a,onClick:this.props.onChangeGradientTypeVertical}),h.a.createElement("img",{className:m()({[Os.a.inactiveGradient]:this.props.gradientType!==Co.RADIAL,[Os.a.clickable]:!0}),draggable:!1,src:As.a,onClick:this.props.onChangeGradientTypeRadial}))),h.a.createElement("div",{className:Os.a.divider}),this.props.gradientType===Co.SOLID?null:h.a.createElement("div",{className:Os.a.row},h.a.createElement("div",{className:m()(Os.a.gradientPickerRow,Os.a.gradientSwatchesRow)},h.a.createElement("div",{className:m()({[Os.a.clickable]:!0,[Os.a.swatch]:!0,[Os.a.largeSwatch]:!0,[Os.a.activeSwatch]:0===this.props.colorIndex}),style:{backgroundColor:null===this.props.color||this.props.color===Ro?"white":this.props.color},onClick:this.props.onSelectColor},null===this.props.color?h.a.createElement("img",{className:Os.a.largeSwatchIcon,draggable:!1,src:ds.a}):this.props.color===Ro?h.a.createElement("img",{className:Os.a.largeSwatchIcon,draggable:!1,src:ps.a}):null),h.a.createElement(Rs,{className:Os.a.swapButton,imgSrc:qs.a,title:this.props.intl.formatMessage(js.swap),onClick:this.props.onSwap}),h.a.createElement("div",{className:m()({[Os.a.clickable]:!0,[Os.a.swatch]:!0,[Os.a.largeSwatch]:!0,[Os.a.activeSwatch]:1===this.props.colorIndex}),style:{backgroundColor:null===this.props.color2||this.props.color2===Ro?"white":this.props.color2},onClick:this.props.onSelectColor2},null===this.props.color2?h.a.createElement("img",{className:Os.a.largeSwatchIcon,draggable:!1,src:ds.a}):this.props.color2===Ro?h.a.createElement("img",{className:Os.a.largeSwatchIcon,draggable:!1,src:ps.a}):null)))):null,h.a.createElement("div",{className:Os.a.row},h.a.createElement("div",{className:Os.a.rowHeader},h.a.createElement("span",{className:Os.a.labelName},h.a.createElement(f.FormattedMessage,{defaultMessage:"Color",description:"Label for the hue component in the color picker",id:"paint.paintEditor.hue"})),h.a.createElement("span",{className:Os.a.labelReadout},Math.round(this.props.hue))),h.a.createElement("div",{className:Os.a.rowSlider},h.a.createElement(xs,{background:this._makeBackground("hue"),value:this.props.hue,onChange:this.props.onHueChange}))),h.a.createElement("div",{className:Os.a.row},h.a.createElement("div",{className:Os.a.rowHeader},h.a.createElement("span",{className:Os.a.labelName},h.a.createElement(f.FormattedMessage,{defaultMessage:"Saturation",description:"Label for the saturation component in the color picker",id:"paint.paintEditor.saturation"})),h.a.createElement("span",{className:Os.a.labelReadout},Math.round(this.props.saturation))),h.a.createElement("div",{className:Os.a.rowSlider},h.a.createElement(xs,{background:this._makeBackground("saturation"),value:this.props.saturation,onChange:this.props.onSaturationChange}))),h.a.createElement("div",{className:Os.a.row},h.a.createElement("div",{className:Os.a.rowHeader},h.a.createElement("span",{className:Os.a.labelName},h.a.createElement(f.FormattedMessage,{defaultMessage:"Brightness",description:"Label for the brightness component in the color picker",id:"paint.paintEditor.brightness"})),h.a.createElement("span",{className:Os.a.labelReadout},Math.round(this.props.brightness))),h.a.createElement("div",{className:Os.a.rowSlider},h.a.createElement(xs,{lastSlider:!0,background:this._makeBackground("brightness"),value:this.props.brightness,onChange:this.props.onBrightnessChange}))),h.a.createElement("div",{className:Os.a.swatchRow},h.a.createElement("div",{className:Os.a.swatches},this.props.mode===E.BIT_LINE||this.props.mode===E.BIT_RECT||this.props.mode===E.BIT_OVAL||this.props.mode===E.BIT_TEXT?null:h.a.createElement("div",{className:m()({[Os.a.clickable]:!0,[Os.a.swatch]:!0,[Os.a.activeSwatch]:0===this.props.colorIndex&&null===this.props.color||1===this.props.colorIndex&&null===this.props.color2}),onClick:this.props.onTransparent},h.a.createElement("img",{className:Os.a.swatchIcon,draggable:!1,src:ds.a}))),h.a.createElement("div",{className:Os.a.swatches},h.a.createElement("div",{className:m()({[Os.a.clickable]:!0,[Os.a.swatch]:!0,[Os.a.activeSwatch]:this.props.isEyeDropping}),onClick:this.props.onActivateEyeDropper},h.a.createElement("img",{className:Os.a.swatchIcon,draggable:!1,src:Ps.a})))))}}Vs.propTypes={brightness:a.a.number.isRequired,color:a.a.string,color2:a.a.string,colorIndex:a.a.number.isRequired,gradientType:a.a.oneOf(Object.keys(Co)).isRequired,hue:a.a.number.isRequired,intl:f.intlShape.isRequired,isEyeDropping:a.a.bool.isRequired,mode:a.a.oneOf(Object.keys(E)),onActivateEyeDropper:a.a.func.isRequired,onBrightnessChange:a.a.func.isRequired,onChangeGradientTypeHorizontal:a.a.func.isRequired,onChangeGradientTypeRadial:a.a.func.isRequired,onChangeGradientTypeSolid:a.a.func.isRequired,onChangeGradientTypeVertical:a.a.func.isRequired,onHueChange:a.a.func.isRequired,onSaturationChange:a.a.func.isRequired,onSelectColor:a.a.func.isRequired,onSelectColor2:a.a.func.isRequired,onSwap:a.a.func,onTransparent:a.a.func.isRequired,rtl:a.a.bool.isRequired,saturation:a.a.number.isRequired,shouldShowGradientTools:a.a.bool.isRequired};var Ws=Object(f.injectIntl)(Vs);const Ks=e=>{const t=xo()(e).hsv;return t[0]=t[0]/3.6,0===t[1]&&0===t[2]&&(t[1]=100),t},Xs=(e,t,o)=>xo()(`hsv(${3.6*e}, ${t}, ${o})`).hex;class $s extends h.a.Component{constructor(e){super(e),b()(this,["getHsv","handleChangeGradientTypeHorizontal","handleChangeGradientTypeRadial","handleChangeGradientTypeSolid","handleChangeGradientTypeVertical","handleHueChange","handleSaturationChange","handleBrightnessChange","handleTransparent","handleActivateEyeDropper"]);const t=0===e.colorIndex?e.color:e.color2,o=this.getHsv(t);this.state={hue:o[0],saturation:o[1],brightness:o[2]}}componentWillReceiveProps(e){const t=0===e.colorIndex?this.props.color:this.props.color2,o=0===e.colorIndex?e.color:e.color2;if(this.props.isEyeDropping&&t!==o||this.props.colorIndex!==e.colorIndex){const e=this.getHsv(o);this.setState({hue:e[0],saturation:e[1],brightness:e[2]})}}getHsv(e){return null===e||e===Ro?[50,100,100]:Ks(e)}handleHueChange(e){this.setState({hue:e},()=>{this.handleColorChange()})}handleSaturationChange(e){this.setState({saturation:e},()=>{this.handleColorChange()})}handleBrightnessChange(e){this.setState({brightness:e},()=>{this.handleColorChange()})}handleColorChange(){this.props.onChangeColor(Xs(this.state.hue,this.state.saturation,this.state.brightness))}handleTransparent(){this.props.onChangeColor(null)}handleActivateEyeDropper(){this.props.onActivateEyeDropper(i.a.tool,this.props.onChangeColor)}handleChangeGradientTypeHorizontal(){this.props.onChangeGradientType(Co.HORIZONTAL)}handleChangeGradientTypeRadial(){this.props.onChangeGradientType(Co.RADIAL)}handleChangeGradientTypeSolid(){this.props.onChangeGradientType(Co.SOLID)}handleChangeGradientTypeVertical(){this.props.onChangeGradientType(Co.VERTICAL)}render(){return h.a.createElement(Ws,{brightness:this.state.brightness,color:this.props.color,color2:this.props.color2,colorIndex:this.props.colorIndex,gradientType:this.props.gradientType,hue:this.state.hue,isEyeDropping:this.props.isEyeDropping,mode:this.props.mode,rtl:this.props.rtl,saturation:this.state.saturation,shouldShowGradientTools:this.props.shouldShowGradientTools,onActivateEyeDropper:this.handleActivateEyeDropper,onBrightnessChange:this.handleBrightnessChange,onChangeGradientTypeHorizontal:this.handleChangeGradientTypeHorizontal,onChangeGradientTypeRadial:this.handleChangeGradientTypeRadial,onChangeGradientTypeSolid:this.handleChangeGradientTypeSolid,onChangeGradientTypeVertical:this.handleChangeGradientTypeVertical,onHueChange:this.handleHueChange,onSaturationChange:this.handleSaturationChange,onSelectColor:this.props.onSelectColor,onSelectColor2:this.props.onSelectColor2,onSwap:this.props.onSwap,onTransparent:this.handleTransparent})}}$s.propTypes={color:a.a.string,color2:a.a.string,colorIndex:a.a.number.isRequired,gradientType:a.a.oneOf(Object.keys(Co)).isRequired,isEyeDropping:a.a.bool.isRequired,mode:a.a.oneOf(Object.keys(E)),onActivateEyeDropper:a.a.func.isRequired,onChangeColor:a.a.func.isRequired,onChangeGradientType:a.a.func,onSelectColor:a.a.func.isRequired,onSelectColor2:a.a.func.isRequired,onSwap:a.a.func,rtl:a.a.bool.isRequired,shouldShowGradientTools:a.a.bool.isRequired};var Ys=Object(p.connect)(e=>({colorIndex:e.scratchPaint.fillMode.colorIndex,isEyeDropping:e.scratchPaint.color.eyeDropper.active,mode:e.scratchPaint.mode,rtl:e.scratchPaint.layout.rtl}),e=>({clearSelectedItems:()=>{e(Qt())},onActivateEyeDropper:(t,o)=>{e(function(e,t){return{type:yn,callback:t,previousMode:e}}(t,o))},onSelectColor:()=>{e(os(0))},onSelectColor2:()=>{e(os(1))}}))($s),Zs=o(925),Js=o.n(Zs);const Qs=e=>h.a.createElement("div",{className:m()(e.className,Js.a.inputGroup,{[Js.a.disabled]:e.disabled}),dir:e.rtl?"rtl":""},e.children);Qs.propTypes={children:a.a.node.isRequired,className:a.a.string,disabled:a.a.bool,rtl:a.a.bool};var ea=Qs,ta=o(927),oa=o.n(ta);const na=e=>h.a.createElement("label",{className:oa.a.inputGroup},h.a.createElement("span",{className:e.secondary?oa.a.inputLabelSecondary:oa.a.inputLabel},e.text),e.children);na.propTypes={children:a.a.node,secondary:a.a.bool,text:a.a.string.isRequired},na.defaultProps={secondary:!1};var ia=na;const sa=Object(f.defineMessages)({fill:{id:"paint.paintEditor.fill",description:"Label for the color picker for the fill color",defaultMessage:"Fill"}}),aa=e=>h.a.createElement(ea,{className:e.className,disabled:e.disabled},h.a.createElement(ls.a,{body:h.a.createElement(Ys,{color:e.fillColor,color2:e.fillColor2,gradientType:e.gradientType,shouldShowGradientTools:e.shouldShowGradientTools,onChangeColor:e.onChangeFillColor,onChangeGradientType:e.onChangeGradientType,onSwap:e.onSwap}),isOpen:e.fillColorModalVisible,preferPlace:"below",onOuterAction:e.onCloseFillColor},h.a.createElement(ia,{text:e.intl.formatMessage(sa.fill)},h.a.createElement(bs,{color:e.fillColor,color2:e.fillColor2,gradientType:e.gradientType,onClick:e.onOpenFillColor}))));aa.propTypes={className:a.a.string,disabled:a.a.bool.isRequired,fillColor:a.a.string,fillColor2:a.a.string,fillColorModalVisible:a.a.bool.isRequired,gradientType:a.a.oneOf(Object.keys(Co)).isRequired,intl:f.intlShape,onChangeFillColor:a.a.func.isRequired,onChangeGradientType:a.a.func.isRequired,onCloseFillColor:a.a.func.isRequired,onOpenFillColor:a.a.func.isRequired,onSwap:a.a.func.isRequired,shouldShowGradientTools:a.a.bool.isRequired};var ra=Object(f.injectIntl)(aa);function la(){return(la=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e}).apply(this,arguments)}class ca extends h.a.Component{constructor(e){super(e),b()(this,["handleChangeFillColor","handleChangeGradientType","handleCloseFillColor","handleSwap"]),this._hasChanged=!1}componentWillReceiveProps(e){const{fillColorModalVisible:t,onUpdateImage:o}=this.props;t&&!e.fillColorModalVisible&&(this._hasChanged&&o(),this._hasChanged=!1)}handleChangeFillColor(e){const t=Lo(e,this.props.colorIndex,this.props.gradientType===Co.SOLID,I(this.props.format),this.props.textEditTarget);this._hasChanged=this._hasChanged||t,this.props.onChangeFillColor(e,this.props.colorIndex)}handleChangeGradientType(e){const t=Ao(e,I(this.props.format),this.props.textEditTarget);this._hasChanged=this._hasChanged||t;const o=ce().length>0;o&&t&&this.props.setSelectedItems(),this.props.gradientType===Co.SOLID&&e!==Co.SOLID&&(o||this.props.onChangeFillColor(Po(this.props.fillColor),1),this.props.onChangeColorIndex(1)),this.props.onChangeGradientType(e)}handleCloseFillColor(){this.props.isEyeDropping||(this.props.onCloseFillColor(),this.props.onChangeColorIndex(0))}handleSwap(){if(ce().length){const e=Bo(I(this.props.format),this.props.textEditTarget);this.props.setSelectedItems(),this._hasChanged=this._hasChanged||e}else{let e=this.props.fillColor,t=this.props.fillColor2;e=null===e||e===Ro?e:xo()(e).hex,t=null===t||t===Ro?t:xo()(t).hex,this.props.onChangeFillColor(e,1),this.props.onChangeFillColor(t,0)}}render(){return h.a.createElement(ra,la({},this.props,{onChangeFillColor:this.handleChangeFillColor,onChangeGradientType:this.handleChangeGradientType,onCloseFillColor:this.handleCloseFillColor,onSwap:this.handleSwap}))}}ca.propTypes={colorIndex:a.a.number.isRequired,disabled:a.a.bool.isRequired,fillColor:a.a.string,fillColor2:a.a.string,fillColorModalVisible:a.a.bool.isRequired,format:a.a.oneOf(Object.keys(S)),gradientType:a.a.oneOf(Object.keys(Co)).isRequired,isEyeDropping:a.a.bool.isRequired,onChangeColorIndex:a.a.func.isRequired,onChangeFillColor:a.a.func.isRequired,onChangeGradientType:a.a.func.isRequired,onCloseFillColor:a.a.func.isRequired,onUpdateImage:a.a.func.isRequired,setSelectedItems:a.a.func.isRequired,textEditTarget:a.a.number};var da=Object(p.connect)(e=>({colorIndex:e.scratchPaint.fillMode.colorIndex,disabled:e.scratchPaint.mode===E.LINE,fillColor:e.scratchPaint.color.fillColor,fillColor2:e.scratchPaint.color.fillColor2,fillColorModalVisible:e.scratchPaint.modals.fillColor,format:e.scratchPaint.format,gradientType:e.scratchPaint.color.gradientType,isEyeDropping:e.scratchPaint.color.eyeDropper.active,mode:e.scratchPaint.mode,shouldShowGradientTools:e.scratchPaint.mode===E.SELECT||e.scratchPaint.mode===E.RESHAPE||e.scratchPaint.mode===E.FILL||e.scratchPaint.mode===E.BIT_SELECT||e.scratchPaint.mode===E.BIT_FILL,textEditTarget:e.scratchPaint.textEditTarget}),e=>({onChangeColorIndex:t=>{e(os(t))},onChangeFillColor:(t,o)=>{0===o?e(Eo(t)):1===o&&e(ci(t))},onOpenFillColor:()=>{e(ss("fillColor"))},onCloseFillColor:()=>{e(as("fillColor"))},onChangeGradientType:t=>{e(Ko(t))},setSelectedItems:t=>{e(Jt(ce(),I(t)))}}))(ca);const ha=function(e,t,o){const n=t.match;t.match=e=>(!e.item.data||!e.item.data.noHover)&&(!n||n(e));const s=i.a.project.hitTestAll(e.point,t);if(0===s.length)return null;let a;for(const e of s)(!a||K(a.item,e.item)<0)&&(a=e);const r=a.item;return!r||r.selected?null:k(r)?Se(r):!o&&function(e){const t=R(e);return L(t)}(r)?Se(R(r)):we(r)};class pa extends i.a.Tool{static get TOLERANCE(){return 2}constructor(e,t,o){super(),this.setHoveredItem=e,this.clearHoveredItem=t,this.onUpdateImage=o,this.onMouseMove=this.handleMouseMove,this.onMouseUp=this.handleMouseUp,this.fillColor=null,this.fillColor2=null,this.gradientType=null,this.fillItem=null,this.addedFillItem=null,this.fillItemOrigColor=null,this.prevHoveredItemId=null}getHitOptions(){return{segments:!0,stroke:!0,curves:!0,fill:!0,guide:!1,match:function(e){return!!(e.item instanceof i.a.Path&&(e.item.hasFill()||e.item.closed||(t=e.item,t instanceof i.a.Path&&t.segments.length>2&&t.lastSegment.point.getDistance(t.firstSegment.point)<8)))||(e.item instanceof i.a.PointText||void 0);var t},hitUnfilledPaths:!0,tolerance:pa.TOLERANCE/i.a.view.zoom}}setFillColor(e){this.fillColor=e}setFillColor2(e){this.fillColor2=e}setGradientType(e){this.gradientType=e}setPrevHoveredItemId(e){this.prevHoveredItemId=e}handleMouseMove(e){const t=ha(e,this.getHitOptions(),!0);(!t&&this.prevHoveredItemId||t&&!this.prevHoveredItemId||t&&this.prevHoveredItemId&&t.id!==this.prevHoveredItemId)&&this.setHoveredItem(t?t.id:null);const o=t?t.data.origItem:null;if((o||this.fillItem)&&this.fillItem!==o){if(this.fillItem&&(this.addedFillItem?(this.addedFillItem.remove(),this.addedFillItem=null):this._setFillItemColor(this.fillItemOrigColor),this.fillItemOrigColor=null,this.fillItem=null),o){if(this.fillItem=o,this.fillItemOrigColor=o.fillColor,o.parent instanceof i.a.CompoundPath&&o.area<0){if(!this.fillColor)return this.fillItem=null,void(this.fillItemOrigColor=null);this.addedFillItem=o.clone(),this.addedFillItem.setClockwise(!0),this.addedFillItem.data.noHover=!0,this.addedFillItem.data.origItem=o,X(this.addedFillItem,.1),this.addedFillItem.insertAbove(o.parent)}else this.fillItem.parent instanceof i.a.CompoundPath&&(this.fillItemOrigColor=o.parent.fillColor);this._setFillItemColor(this.fillColor,this.fillColor2,this.gradientType,e.point)}}else this.gradientType===Co.RADIAL&&this._setFillItemColor(this.fillColor,this.fillColor2,this.gradientType,e.point)}handleMouseUp(e){if(!(e.event.button>0)&&this.fillItem){if(this.addedFillItem&&this._noStroke(this.fillItem.parent)&&"gradient"!==this.addedFillItem.fillColor.type&&this.fillItem.parent.fillColor.toCSS()===this.addedFillItem.fillColor.toCSS()){this.addedFillItem.remove(),this.addedFillItem=null;let e=this.fillItem.parent;this.fillItem.remove(),e=e.reduce(),e.fillColor=this.fillColor}else if(this.addedFillItem)this.addedFillItem.data.noHover=!1;else if(!this.fillColor&&this.fillItem.data&&this.fillItem.data.origItem){const e=this.fillItem.parent;this.fillItem.remove(),e instanceof i.a.Layer||1!==e.children.length||e.reduce()}this.clearHoveredItem(),this.fillItem=null,this.addedFillItem=null,this.fillItemOrigColor=null,this.onUpdateImage()}}_noStroke(e){return!e.strokeColor||0===e.strokeColor.alpha||0===e.strokeWidth}_setFillItemColor(e,t,o,n){const i=this._getFillItem();i&&(o&&o!==Co.SOLID?i.fillColor=_o(e,t,o,i.bounds,n):i.fillColor=e)}_getFillItem(){return this.addedFillItem?this.addedFillItem:this.fillItem&&this.fillItem.parent instanceof i.a.CompoundPath?this.fillItem.parent:this.fillItem}deactivateTool(){this.fillItem&&(this._setFillItemColor(this.fillItemOrigColor),this.fillItemOrigColor=null,this.fillItem=null),this.clearHoveredItem(),this.setHoveredItem=null,this.clearHoveredItem=null}}var ua=pa,ma=o(929),fa=o.n(ma);const ga=e=>h.a.createElement(an,{imgDescriptor:rn.fill,imgSrc:fa.a,isSelected:e.isSelected,onMouseDown:e.onMouseDown});ga.propTypes={isSelected:a.a.bool.isRequired,onMouseDown:a.a.func.isRequired};var ba=ga;class va extends h.a.Component{constructor(e){super(e),b()(this,["activateTool","deactivateTool"])}componentDidMount(){this.props.isFillModeActive&&this.activateTool(this.props)}componentWillReceiveProps(e){this.tool&&(e.fillColor!==this.props.fillColor&&this.tool.setFillColor(e.fillColor),e.fillColor2!==this.props.fillColor2&&this.tool.setFillColor2(e.fillColor2),e.hoveredItemId!==this.props.hoveredItemId&&this.tool.setPrevHoveredItemId(e.hoveredItemId),e.fillModeGradientType!==this.props.fillModeGradientType&&this.tool.setGradientType(e.fillModeGradientType)),e.isFillModeActive&&!this.props.isFillModeActive?this.activateTool():!e.isFillModeActive&&this.props.isFillModeActive&&this.deactivateTool()}shouldComponentUpdate(e){return e.isFillModeActive!==this.props.isFillModeActive}componentWillUnmount(){this.tool&&this.deactivateTool()}activateTool(){re(this.props.clearSelectedItems);let e=this.props.fillColor;this.props.fillColor===Ro&&(e=To,this.props.onChangeFillColor(To,0));const t=this.props.fillModeGradientType?this.props.fillModeGradientType:this.props.selectModeGradientType;let o=this.props.fillColor2;t!==this.props.selectModeGradientType&&(this.props.selectModeGradientType===Co.SOLID&&(o=Po(e),this.props.onChangeFillColor(o,1)),this.props.changeGradientType(t)),this.props.fillColor2===Ro&&(o=Po(e),this.props.onChangeFillColor(o,1)),this.tool=new ua(this.props.setHoveredItem,this.props.clearHoveredItem,this.props.onUpdateImage),this.tool.setFillColor(e),this.tool.setFillColor2(o),this.tool.setGradientType(t),this.tool.setPrevHoveredItemId(this.props.hoveredItemId),this.tool.activate()}deactivateTool(){this.tool.deactivateTool(),this.tool.remove(),this.tool=null}render(){return h.a.createElement(ba,{isSelected:this.props.isFillModeActive,onMouseDown:this.props.handleMouseDown})}}va.propTypes={changeGradientType:a.a.func.isRequired,clearHoveredItem:a.a.func.isRequired,clearSelectedItems:a.a.func.isRequired,fillColor:a.a.string,fillColor2:a.a.string,fillModeGradientType:a.a.oneOf(Object.keys(Co)),handleMouseDown:a.a.func.isRequired,hoveredItemId:a.a.number,isFillModeActive:a.a.bool.isRequired,onChangeFillColor:a.a.func.isRequired,onUpdateImage:a.a.func.isRequired,selectModeGradientType:a.a.oneOf(Object.keys(Co)).isRequired,setHoveredItem:a.a.func.isRequired};var wa=Object(p.connect)(e=>({fillModeGradientType:e.scratchPaint.fillMode.gradientType,fillColor:e.scratchPaint.color.fillColor,fillColor2:e.scratchPaint.color.fillColor2,hoveredItemId:e.scratchPaint.hoveredItemId,isFillModeActive:e.scratchPaint.mode===E.FILL,selectModeGradientType:e.scratchPaint.color.gradientType}),e=>({setHoveredItem:t=>{e(to(t))},clearHoveredItem:()=>{e(oo())},clearSelectedItems:()=>{e(Qt())},changeGradientType:t=>{e(Ko(t))},handleMouseDown:()=>{e(Vo(E.FILL))},onChangeFillColor:(t,o)=>{0===o?e(Eo(t)):1===o&&e(ci(t))}}))(va);const Sa=function(e,t,o){return e.getDistance(t,!0)<Math.pow(o/i.a.view.zoom,2)},Ca=function(e,t,o){const n=Q({class:i.a.Path});for(let s=n.length-1;s>=0;s--)if(!n[s].closed&&n[s].parent instanceof i.a.Layer&&(!o||n[s]!==o)){if(n[s].firstSegment&&Sa(n[s].firstSegment.point,e,t))return{path:n[s],segment:n[s].firstSegment,isFirst:!0};if(n[s].lastSegment&&Sa(n[s].lastSegment.point,e,t))return{path:n[s],segment:n[s].lastSegment,isFirst:!1}}return null},Ia="scratch-paint/stroke-width/CHANGE_STROKE_WIDTH",xa=function(e){return{type:Ia,strokeWidth:e}},Ta=/^#([0-9a-f]{3}){1,2}$/i,ya=function(e){return{type:"scratch-paint/stroke-color/CHANGE_STROKE_COLOR",strokeColor:e}};var Ma=o(930),Ea=o.n(Ma);const Ra=e=>h.a.createElement(an,{imgDescriptor:rn.line,imgSrc:Ea.a,isSelected:e.isSelected,onMouseDown:e.onMouseDown});Ra.propTypes={isSelected:a.a.bool.isRequired,onMouseDown:a.a.func.isRequired};var ka=Ra;class Oa extends h.a.Component{static get SNAP_TOLERANCE(){return 6}static get DEFAULT_COLOR(){return"#000000"}constructor(e){super(e),b()(this,["activateTool","deactivateTool","drawHitPoint","onMouseDown","onMouseMove","onMouseDrag","onMouseUp"])}componentDidMount(){this.props.isLineModeActive&&this.activateTool()}componentWillReceiveProps(e){e.isLineModeActive&&!this.props.isLineModeActive?this.activateTool():!e.isLineModeActive&&this.props.isLineModeActive&&this.deactivateTool()}shouldComponentUpdate(e){return e.isLineModeActive!==this.props.isLineModeActive}componentWillUnmount(){this.tool&&this.deactivateTool()}activateTool(){re(this.props.clearSelectedItems);const{strokeColor:e}=this.props.colorState;e!==Ro&&null!==e||this.props.onChangeStrokeColor(Oa.DEFAULT_COLOR),this.props.colorState.strokeWidth||this.props.onChangeStrokeWidth(1),this.tool=new i.a.Tool,this.active=!1,this.path=null,this.hitResult=null;const t=this;this.tool.onMouseDown=function(e){e.event.button>0||t.onMouseDown(e)},this.tool.onMouseMove=function(e){t.onMouseMove(e)},this.tool.onMouseDrag=function(e){e.event.button>0||t.onMouseDrag(e)},this.tool.onMouseUp=function(e){e.event.button>0||t.onMouseUp(e)},this.tool.activate()}onMouseDown(e){e.event.button>0||(this.active=!0,this.hitResult=Ca(e.point,Oa.SNAP_TOLERANCE),this.hitResult&&(this.path=this.hitResult.path,Ho(this.path,this.props.colorState.strokeColor,this.props.colorState.strokeWidth),this.hitResult.isFirst&&this.path.reverse(),this.path.lastSegment.handleOut=null,this.path.add(this.hitResult.segment.point)),this.path||(this.path=new i.a.Path,this.path.strokeCap="round",Ho(this.path,this.props.colorState.strokeColor,this.props.colorState.strokeWidth),this.path.add(e.point),this.path.add(e.point)))}drawHitPoint(e){if(e){const t=e.path;e.isFirst?Ee(t.firstSegment.point):Ee(t.lastSegment.point)}}onMouseMove(e){this.hitResult&&Me(),this.hitResult=Ca(e.point,Oa.SNAP_TOLERANCE),this.drawHitPoint(this.hitResult)}onMouseDrag(e){if(e.event.button>0||!this.active)return;this.hitResult&&(Me(),this.hitResult=null);let t=e.point;if(e.modifiers.shift){const o=e.point.subtract(this.path.lastSegment.previous.point);t=this.path.lastSegment.previous.point.add(V(o,Math.PI/4))}if(this.path&&!this.path.closed&&this.path.segments.length>3&&Sa(this.path.firstSegment.point,t,Oa.SNAP_TOLERANCE)?this.hitResult={path:this.path,segment:this.path.firstSegment,isFirst:!0}:this.hitResult=Ca(t,Oa.SNAP_TOLERANCE,this.path),this.hitResult&&e.modifiers.shift){const e=this.hitResult.segment.point.subtract(this.path.lastSegment.previous.point),o=t.subtract(this.path.lastSegment.previous.point);e.normalize().getDistance(o.normalize())>.01&&(this.hitResult=null)}this.hitResult?(this.drawHitPoint(this.hitResult),this.path.lastSegment.point=this.hitResult.segment.point):this.path.lastSegment.point=t}onMouseUp(e){if(!(e.event.button>0)&&this.active){if(this.path.segments.length<2||2===this.path.segments.length&&Sa(this.path.firstSegment.point,e.point,Oa.SNAP_TOLERANCE)&&!this.hitResult)return this.path.remove(),void(this.path=null);if(!this.hitResult&&Sa(this.path.lastSegment.point,this.path.segments[this.path.segments.length-2].point,Oa.SNAP_TOLERANCE))return this.path.removeSegment(this.path.segments.length-1),void(this.path=null);this.hitResult&&(this.path.removeSegment(this.path.segments.length-1),this.path.firstSegment.point.equals(this.hitResult.segment.point)?(this.path.firstSegment.handleIn=null,this.path.closed=!0):(this.hitResult.isFirst||this.hitResult.path.reverse(),this.hitResult.path.firstSegment.handleIn=null,this.path.join(this.hitResult.path)),Me(),this.hitResult=null),this.path&&(this.props.onUpdateImage(),this.path=null),this.active=!1}}deactivateTool(){this.tool.remove(),this.tool=null,this.hitResult&&(Me(),this.hitResult=null),this.path&&(this.path=null)}render(){return h.a.createElement(ka,{isSelected:this.props.isLineModeActive,onMouseDown:this.props.handleMouseDown})}}Oa.propTypes={clearSelectedItems:a.a.func.isRequired,colorState:a.a.shape({fillColor:a.a.string,strokeColor:a.a.string,strokeWidth:a.a.number}).isRequired,handleMouseDown:a.a.func.isRequired,isLineModeActive:a.a.bool.isRequired,onChangeStrokeColor:a.a.func.isRequired,onChangeStrokeWidth:a.a.func.isRequired,onUpdateImage:a.a.func.isRequired};var Da=Object(p.connect)(e=>({colorState:e.scratchPaint.color,isLineModeActive:e.scratchPaint.mode===E.LINE}),e=>({clearSelectedItems:()=>{e(Qt())},handleMouseDown:()=>{e(Vo(E.LINE))},onChangeStrokeColor:t=>{e(ya(t))},onChangeStrokeWidth:t=>{e(xa(t))}}))(Oa);const Pa=20,_a=3;class La extends i.a.Tool{constructor(e,t,o,n,s,a,r,l){super();const c=(l?yt().layer:i.a.project.activeLayer).rasterize(72*_a*i.a.view.zoom,!1,i.a.view.bounds),d=Et().rasterize(72*_a*i.a.view.zoom,!1,i.a.view.bounds);this.bufferCanvas=xt(e.width*_a,e.height*_a);const h=this.bufferCanvas.getContext("2d");this.colorCanvas=xt(e.width*_a,e.height*_a);const p=this.colorCanvas.getContext("2d");d.onLoad=()=>{h.drawImage(d.canvas,0,0),c.onLoad=()=>{p.drawImage(c.canvas,0,0),h.drawImage(this.colorCanvas,0,0),this.bufferLoaded=!0},c.loaded&&c.onLoad()},this.onMouseDown=this.handleMouseDown,this.onMouseUp=this.handleMouseUp,this.onMouseMove=this.handleMouseMove,this.canvas=e,this.pixelRatio=n,this.zoom=s,this.offsetX=a,this.offsetY=r,this.width=t*this.zoom*this.pixelRatio,this.height=o*this.zoom*this.pixelRatio,this.rect=e.getBoundingClientRect(),this.colorString="",this.pickX=-1,this.pickY=-1,this.hideLoupe=!0}handleMouseMove(e){this.pickX=(e.point.x-this.offsetX)*this.zoom*this.pixelRatio,this.pickY=(e.point.y-this.offsetY)*this.zoom*this.pixelRatio,this.hideLoupe=this.pickX>this.width||this.pickX<0||this.pickY>this.height||this.pickY<0}handleMouseDown(e){this.handleMouseMove(e)}handleMouseUp(){if(!this.hideLoupe){const e=this.getColorInfo(this.pickX,this.pickY,this.hideLoupe);if(!e)return;if(0===e.color[3])return void(this.colorString=null);const t=e.color[0],o=e.color[1],n=e.color[2],i=e=>{const t=e.toString(16);return 1===t.length?`0${t}`:t};this.colorString=`#${i(t)}${i(o)}${i(n)}`}}getColorInfo(e,t,o){const n=e/this.pixelRatio,i=t/this.pixelRatio;if(!this.bufferLoaded)return null;const s=this.colorCanvas.getContext("2d"),a=this.bufferCanvas.getContext("2d");return{x:e,y:t,color:s.getImageData(n*_a,i*_a,1,1).data,data:a.getImageData(_a*(n-Pa),_a*(i-Pa),2*Pa*_a,2*Pa*_a).data,hideLoupe:o}}}var Ba=o(931),Aa=o.n(Ba);function Na(){return(Na=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e}).apply(this,arguments)}class Ua extends h.a.Component{constructor(e){super(e),b()(this,["setCanvas"])}componentDidUpdate(){this.draw()}draw(){const e=_a*Pa,t=2*e,o=this.props.colorInfo.color,n=this.canvas.getContext("2d");this.canvas.width=t,this.canvas.height=t,n.fillStyle="white",n.fillRect(0,0,t,t);const i=document.createElement("canvas");i.width=t,i.height=t;const s=i.getContext("2d"),a=s.createImageData(t,t);this.props.colorInfo.data.length===a.data.length?a.data.set(this.props.colorInfo.data):console.warn("Image data size mismatch drawing loupe"),s.putImageData(a,0,0),n.drawImage(i,0,0),n.lineWidth=1,n.strokeStyle="black",n.fillStyle=`rgba(${o[0]}, ${o[1]}, ${o[2]}, ${o[3]})`,n.beginPath(),n.rect(e-2.5,e-2.5,5,5),n.fill(),n.stroke(),n.strokeStyle=`rgba(${o[0]}, ${o[1]}, ${o[2]}, ${o[3]})`,n.lineWidth=15,n.beginPath(),n.moveTo(t,t),n.arc(e,e,e,0,2*Math.PI),n.stroke()}setCanvas(e){this.canvas=e,this.canvas&&this.draw()}render(){const{colorInfo:e,pixelRatio:t,...o}=this.props,n=_a*Pa*2;return h.a.createElement(_i,Na({},o,{className:Aa.a.eyeDropper,componentRef:this.setCanvas,element:"canvas",height:2*Pa,style:{top:e.y/t-n/2,left:e.x/t-n/2,width:n,height:n},width:2*Pa}))}}Ua.propTypes={colorInfo:a.a.shape({color:a.a.instanceOf(Uint8ClampedArray),x:a.a.number,y:a.a.number,data:a.a.instanceOf(Uint8ClampedArray)}),pixelRatio:a.a.number.isRequired};var za=Ua,Fa=o(867),Ha=o.n(Fa);const qa=function(e){const t=le();for(const e of t)e.bringToFront();e()},Ga=function(e){const t=le();for(let e=t.length-1;e>=0;e--)t[e].sendToBack();e()},ja=function(e){const t=le();if(0===t.length||!t[t.length-1].nextSibling)return;const o=t[t.length-1].nextSibling;for(let e=t.length-1;e>=0;e--)t[e].insertAbove(o);e()},Va=function(e){const t=le();if(0===t.length||!t[0].previousSibling)return;const o=t[0].previousSibling;for(const e of t)e.insertBelow(o);e()},Wa=function(){const e=le();return!(0===e.length||!e[0].previousSibling)},Ka=function(){const e=le();return!(0===e.length||!e[e.length-1].nextSibling)};function Xa(){return(Xa=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e}).apply(this,arguments)}var $a=o(933),Ya=o.n($a),Za=o(935),Ja=o.n(Za);function Qa(){return(Qa=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e}).apply(this,arguments)}class er extends h.a.Component{constructor(e){super(e),b()(this,["handleClosePopover","handleToggleOpenState","isOpen"]),this.state={isOpen:!1}}handleClosePopover(){this.setState({isOpen:!1})}handleToggleOpenState(){const e=!this.state.isOpen;this.setState({isOpen:e}),e&&this.props.onOpen&&this.props.onOpen()}isOpen(){return this.state.isOpen}render(){return h.a.createElement(ls.a,Qa({body:this.props.popoverContent,isOpen:this.state.isOpen,preferPlace:"below",onOuterAction:this.props.onOuterAction?this.props.onOuterAction:this.handleClosePopover},this.props),h.a.createElement("div",{className:m()(Ya.a.dropdown,this.props.className,{[Ya.a.modOpen]:this.state.isOpen,[Ya.a.modClosed]:!this.state.isOpen}),onClick:this.handleToggleOpenState},this.props.children,h.a.createElement("img",{className:m()(Ya.a.dropdownIcon,{[Ya.a.modCaretUp]:this.state.isOpen}),draggable:!1,src:Ja.a})))}}er.propTypes={children:a.a.node.isRequired,className:a.a.string,onOpen:a.a.func,onOuterAction:a.a.func,popoverContent:a.a.node.isRequired};var tr=er,or=o(936),nr=o.n(or);function ir(){return(ir=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e}).apply(this,arguments)}const sr=e=>{const{small:t,range:o,...n}=e;return h.a.createElement("input",ir({},n,{className:m()(nr.a.inputForm,e.className,{[nr.a.inputSmall]:t&&!o,[nr.a.inputSmallRange]:t&&o})}))};sr.propTypes={className:a.a.string,range:a.a.bool,small:a.a.bool},sr.defaultProps={range:!1,small:!1};var ar=sr,rr=1274;const lr=["ab","ca","cy","de","et","el","ga","gd","gl","mi","nl","ja","ja-Hira","nb","nn","rap","th","sr","sk","sl","fi","sv","sw","vi","tr","uk"],cr=e=>lr.includes(e);var dr=o(938),hr=o.n(dr),pr=o(940),ur=o.n(pr),mr=o(941),fr=o.n(mr),gr=o(942),br=o.n(gr),vr=o(943),wr=o.n(vr),Sr=o(944),Cr=o.n(Sr),Ir=o(945),xr=o.n(Ir),Tr=o(946),yr=o.n(Tr),Mr=o(947),Er=o.n(Mr);const Rr=function(e){class t extends h.a.Component{constructor(e){super(e),b()(this,["handleChange","handleKeyPress","handleFlush"]),this.state={value:null}}handleKeyPress(e){"Enter"===e.key&&(this.handleFlush(),e.target.blur())}handleFlush(){const e="number"==typeof this.props.value,t=!e||!isNaN(this.state.value);null!==this.state.value&&t&&this.props.onSubmit(e?Number(this.state.value):this.state.value),this.setState({value:null})}handleChange(e){this.setState({value:e.target.value})}render(){const t=null===this.state.value?this.props.value:this.state.value;return h.a.createElement(e,Xa({},this.props,{value:t,onBlur:this.handleFlush,onChange:this.handleChange,onKeyPress:this.handleKeyPress}))}}return t.propTypes={onSubmit:a.a.func.isRequired,value:a.a.oneOfType([a.a.string,a.a.number])},t}(ar),kr=Object(f.defineMessages)({costume:{id:"paint.paintEditor.costume",description:"Label for the name of a costume",defaultMessage:"Costume"},group:{defaultMessage:"Group",description:"Label for the button to group shapes",id:"paint.paintEditor.group"},ungroup:{defaultMessage:"Ungroup",description:"Label for the button to ungroup shapes",id:"paint.paintEditor.ungroup"},undo:{defaultMessage:"Undo",description:"Alt to image for the button to undo an action",id:"paint.paintEditor.undo"},redo:{defaultMessage:"Redo",description:"Alt to image for the button to redo an action",id:"paint.paintEditor.redo"},forward:{defaultMessage:"Forward",description:"Label for the `Send forward on canvas` button",id:"paint.paintEditor.forward"},backward:{defaultMessage:"Backward",description:"Label for the `Send backward on canvas` button",id:"paint.paintEditor.backward"},front:{defaultMessage:"Front",description:"Label for the `Send to front of canvas` button",id:"paint.paintEditor.front"},back:{defaultMessage:"Back",description:"Label for the `Send to back of canvas` button",id:"paint.paintEditor.back"},more:{defaultMessage:"More",description:"Label for dropdown to access more action buttons",id:"paint.paintEditor.more"}}),Or=e=>{const t=!e.canRedo(),o=!e.canUndo();return h.a.createElement("div",{className:hr.a.row},h.a.createElement(ea,null,h.a.createElement(Ha.a,{minWidth:rr},h.a.createElement(ia,{text:e.intl.formatMessage(kr.costume)},h.a.createElement(Rr,{className:hr.a.costumeInput,type:"text",value:e.name,onSubmit:e.onUpdateName}))),h.a.createElement(Ha.a,{maxWidth:rr-1},h.a.createElement(Rr,{className:hr.a.costumeInput,type:"text",value:e.name,onSubmit:e.onUpdateName}))),h.a.createElement(ea,null,h.a.createElement(Ni,null,h.a.createElement(tn,{className:m()(hr.a.buttonGroupButton,{[hr.a.modNoEndBorder]:!t}),disabled:o,onClick:e.onUndo},h.a.createElement("img",{alt:e.intl.formatMessage(kr.undo),className:m()(hr.a.buttonGroupButtonIcon,hr.a.undoIcon),draggable:!1,src:yr.a})),h.a.createElement(tn,{className:m()(hr.a.buttonGroupButton,{[hr.a.modStartBorder]:!t}),disabled:t,onClick:e.onRedo},h.a.createElement("img",{alt:e.intl.formatMessage(kr.redo),className:hr.a.buttonGroupButtonIcon,draggable:!1,src:fr.a})))),C(e.format)?h.a.createElement(ea,{className:hr.a.modDashedBorder},h.a.createElement(Rs,{disabled:!(le().length>1),hideLabel:cr(e.intl.locale),imgSrc:ur.a,title:e.intl.formatMessage(kr.group),onClick:e.onGroup}),h.a.createElement(Rs,{disabled:!z(),hideLabel:cr(e.intl.locale),imgSrc:Er.a,title:e.intl.formatMessage(kr.ungroup),onClick:e.onUngroup})):null,C(e.format)?h.a.createElement(ea,{className:hr.a.modDashedBorder},h.a.createElement(Rs,{disabled:!Ka(),hideLabel:cr(e.intl.locale),imgSrc:Cr.a,title:e.intl.formatMessage(kr.forward),onClick:e.onSendForward}),h.a.createElement(Rs,{disabled:!Wa(),hideLabel:cr(e.intl.locale),imgSrc:wr.a,title:e.intl.formatMessage(kr.backward),onClick:e.onSendBackward})):null,C(e.format)?h.a.createElement(Ha.a,{minWidth:rr},h.a.createElement(ea,{className:hr.a.row},h.a.createElement(Rs,{disabled:!Ka(),hideLabel:cr(e.intl.locale),imgSrc:xr.a,title:e.intl.formatMessage(kr.front),onClick:e.onSendToFront}),h.a.createElement(Rs,{disabled:!Wa(),hideLabel:cr(e.intl.locale),imgSrc:br.a,title:e.intl.formatMessage(kr.back),onClick:e.onSendToBack}))):null,C(e.format)?h.a.createElement(Ha.a,{maxWidth:rr-1},h.a.createElement(ea,null,h.a.createElement(tr,{className:hr.a.modUnselect,enterExitTransitionDurationMs:20,popoverContent:h.a.createElement(ea,{className:hr.a.modContextMenu,rtl:e.rtl},h.a.createElement(tn,{className:m()(hr.a.modMenuItem,{[hr.a.modDisabled]:!Ka()}),disabled:!Ka(),onClick:e.onSendToFront},h.a.createElement("img",{className:hr.a.menuItemIcon,draggable:!1,src:xr.a}),h.a.createElement("span",null,e.intl.formatMessage(kr.front))),h.a.createElement(tn,{className:m()(hr.a.modMenuItem,{[hr.a.modDisabled]:!Wa()}),disabled:!Wa(),onClick:e.onSendToBack},h.a.createElement("img",{className:hr.a.menuItemIcon,draggable:!1,src:br.a}),h.a.createElement("span",null,e.intl.formatMessage(kr.back)))),tipSize:.01},e.intl.formatMessage(kr.more)))):null)};Or.propTypes={canRedo:a.a.func.isRequired,canUndo:a.a.func.isRequired,format:a.a.oneOf(Object.keys(S)),intl:f.intlShape,name:a.a.string,onGroup:a.a.func.isRequired,onRedo:a.a.func.isRequired,onSendBackward:a.a.func.isRequired,onSendForward:a.a.func.isRequired,onSendToBack:a.a.func.isRequired,onSendToFront:a.a.func.isRequired,onUndo:a.a.func.isRequired,onUngroup:a.a.func.isRequired,onUpdateName:a.a.func.isRequired,rtl:a.a.bool.isRequired};var Dr=Object(p.connect)(e=>({format:e.scratchPaint.format,rtl:e.scratchPaint.layout.rtl,selectedItems:e.scratchPaint.selectedItems,undoState:e.scratchPaint.undo}))(Object(f.injectIntl)(Or));const Pr=function(e){return{type:"scratch-paint/text-tool/CHANGE_TEXT_EDIT_TARGET",textEditTargetId:e||null}},_r="scratch-paint/layout/SET_LAYOUT",Lr={rtl:!1},Br=["ltr","rtl"],Ar=function(e){return{type:_r,layout:e}};class Nr extends h.a.Component{constructor(e){super(e),b()(this,["handleSendBackward","handleSendForward","handleSendToBack","handleSendToFront","handleSetSelectedItems","handleGroup","handleUngroup"])}handleGroup(){B(this.props.clearSelectedItems,this.handleSetSelectedItems,this.props.onUpdateImage)}handleUngroup(){U(this.props.clearSelectedItems,this.handleSetSelectedItems,this.props.onUpdateImage)}handleSendBackward(){Va(this.props.onUpdateImage)}handleSendForward(){ja(this.props.onUpdateImage)}handleSendToBack(){Ga(this.props.onUpdateImage)}handleSendToFront(){qa(this.props.onUpdateImage)}handleSetSelectedItems(){this.props.setSelectedItems(this.props.format)}render(){return h.a.createElement(Dr,{canRedo:this.props.canRedo,canUndo:this.props.canUndo,name:this.props.name,onGroup:this.handleGroup,onRedo:this.props.onRedo,onSendBackward:this.handleSendBackward,onSendForward:this.handleSendForward,onSendToBack:this.handleSendToBack,onSendToFront:this.handleSendToFront,onUndo:this.props.onUndo,onUngroup:this.handleUngroup,onUpdateImage:this.props.onUpdateImage,onUpdateName:this.props.onUpdateName})}}Nr.propTypes={canRedo:a.a.func.isRequired,canUndo:a.a.func.isRequired,clearSelectedItems:a.a.func.isRequired,format:a.a.oneOf(Object.keys(S)),name:a.a.string,onRedo:a.a.func.isRequired,onUndo:a.a.func.isRequired,onUpdateImage:a.a.func.isRequired,onUpdateName:a.a.func.isRequired,setSelectedItems:a.a.func.isRequired};var Ur=Object(p.connect)(e=>({changeColorToEyeDropper:e.scratchPaint.color.eyeDropper.callback,format:e.scratchPaint.format,isEyeDropping:e.scratchPaint.color.eyeDropper.active,mode:e.scratchPaint.mode,pasteOffset:e.scratchPaint.clipboard.pasteOffset,previousTool:e.scratchPaint.color.eyeDropper.previousTool,selectedItems:e.scratchPaint.selectedItems,viewBounds:e.scratchPaint.viewBounds}),e=>({changeMode:t=>{e(Vo(t))},clearSelectedItems:()=>{e(Qt())},handleSwitchToBitmap:()=>{e(so(S.BITMAP))},handleSwitchToVector:()=>{e(so(S.VECTOR))},removeTextEditTarget:()=>{e(Pr())},setLayout:t=>{e(Ar(t))},setSelectedItems:t=>{e(Jt(ce(),I(t)))},onDeactivateEyeDropper:()=>{e(Rn())}}))(Nr),zr=o(877),Fr=o.n(zr);function Hr(){return(Hr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e}).apply(this,arguments)}var qr=function(e){class t extends h.a.Component{constructor(e){super(e),b()(this,["handleCopy","handlePaste"])}handleCopy(){let e=[];if(this.props.mode===E.RESHAPE){const t=ce();for(const o of t)o.parent&&o.parent instanceof i.a.CompoundPath?e.push(o.parent):e.push(o)}else e=le();if(0===e.length)if(I(this.props.format)){const t=Ae(!1);if(!t)return;e.push(t)}else e=ee();const t=[];for(let o=0;o<e.length;o++){const n=e[o].exportJSON({asString:!1});t.push(n)}this.props.setClipboardItems(t)}handlePaste(){if(re(this.props.clearSelectedItems),0===this.props.clipboardItems.length)return;let e=[];for(let t=0;t<this.props.clipboardItems.length;t++){const o=i.a.Base.importJSON(this.props.clipboardItems[t]);o&&e.push(o)}if(e.length){if(I(this.props.format)&&!(1===e.length&&e[0]instanceof i.a.Raster)){const t=new i.a.Group(e);e=[t.rasterize()],t.remove()}for(const t of e){const e=i.a.project.getActiveLayer().addChild(t);e.selected=!0,e.position.x+=10*this.props.pasteOffset,e.position.y+=10*this.props.pasteOffset}this.props.incrementPasteOffset(),this.props.setSelectedItems(this.props.format),this.props.onUpdateImage()}}render(){const t=Fr()(this.props,["clearSelectedItems","clipboardItems","format","incrementPasteOffset","mode","pasteOffset","setClipboardItems","setSelectedItems"]);return h.a.createElement(e,Hr({onCopyToClipboard:this.handleCopy,onPasteFromClipboard:this.handlePaste},t))}}t.propTypes={clearSelectedItems:a.a.func.isRequired,clipboardItems:a.a.arrayOf(a.a.array),format:a.a.oneOf(Object.keys(S)),incrementPasteOffset:a.a.func.isRequired,mode:a.a.oneOf(Object.keys(E)),onUpdateImage:a.a.func.isRequired,pasteOffset:a.a.number,setClipboardItems:a.a.func.isRequired,setSelectedItems:a.a.func.isRequired};return Object(p.connect)(e=>({clipboardItems:e.scratchPaint.clipboard.items,format:e.scratchPaint.format,mode:e.scratchPaint.mode,pasteOffset:e.scratchPaint.clipboard.pasteOffset}),e=>({setClipboardItems:t=>{e(function(e){return{type:no,clipboardItems:e}}(t))},incrementPasteOffset:()=>{e({type:"scratch-paint/clipboard/INCREMENT_PASTE_OFFSET"})},clearSelectedItems:()=>{e(Qt())},setSelectedItems:t=>{e(Jt(ce(),I(t)))}}))(t)};const Gr={brushSize:10},jr="scratch-paint/fill-bitmap-shapes/SET_FILLED",Vr=function(e){return{type:jr,filled:e}};var Wr={SANS_SERIF:"Sans Serif",SERIF:"Serif",HANDWRITING:"Handwriting",MARKER:"Marker",CURLY:"Curly",PIXEL:"Pixel",CHINESE:'"Microsoft YaHei", "", STXihei, ""',JAPANESE:'" Pro W3", "Hiragino Kaku Gothic Pro", Osaka, "", Meiryo, " ", "MS PGothic"',KOREAN:"Malgun Gothic"},Kr=o(896),Xr=o.n(Kr);const $r=e=>h.a.createElement(tr,{className:m()(Xr.a.modUnselect,Xr.a.fontDropdown),enterExitTransitionDurationMs:60,popoverContent:h.a.createElement(ea,{className:Xr.a.modContextMenu},h.a.createElement(tn,{className:m()(Xr.a.modMenuItem),onClick:e.onChoose,onMouseOver:e.onHoverSansSerif},h.a.createElement("span",{className:Xr.a.sansSerif},e.getFontName(Wr.SANS_SERIF))),h.a.createElement(tn,{className:m()(Xr.a.modMenuItem),onClick:e.onChoose,onMouseOver:e.onHoverSerif},h.a.createElement("span",{className:Xr.a.serif},e.getFontName(Wr.SERIF))),h.a.createElement(tn,{className:m()(Xr.a.modMenuItem),onClick:e.onChoose,onMouseOver:e.onHoverHandwriting},h.a.createElement("span",{className:Xr.a.handwriting},e.getFontName(Wr.HANDWRITING))),h.a.createElement(tn,{className:m()(Xr.a.modMenuItem),onClick:e.onChoose,onMouseOver:e.onHoverMarker},h.a.createElement("span",{className:Xr.a.marker},e.getFontName(Wr.MARKER))),h.a.createElement(tn,{className:m()(Xr.a.modMenuItem),onClick:e.onChoose,onMouseOver:e.onHoverCurly},h.a.createElement("span",{className:Xr.a.curly},e.getFontName(Wr.CURLY))),h.a.createElement(tn,{className:m()(Xr.a.modMenuItem),onClick:e.onChoose,onMouseOver:e.onHoverPixel},h.a.createElement("span",{className:Xr.a.pixel},e.getFontName(Wr.PIXEL))),h.a.createElement(tn,{className:m()(Xr.a.modMenuItem),onClick:e.onChoose,onMouseOver:e.onHoverChinese},h.a.createElement("span",{className:Xr.a.chinese},e.getFontName(Wr.CHINESE))),h.a.createElement(tn,{className:m()(Xr.a.modMenuItem),onClick:e.onChoose,onMouseOver:e.onHoverJapanese},h.a.createElement("span",{className:Xr.a.japanese},e.getFontName(Wr.JAPANESE))),h.a.createElement(tn,{className:m()(Xr.a.modMenuItem),onClick:e.onChoose,onMouseOver:e.onHoverKorean},h.a.createElement("span",{className:Xr.a.korean},e.getFontName(Wr.KOREAN)))),ref:e.componentRef,tipSize:.01,onOpen:e.onOpenDropdown,onOuterAction:e.onClickOutsideDropdown},h.a.createElement("span",{className:m()(e.getFontStyle(e.font),Xr.a.displayedFontName)},e.getFontName(e.font)));$r.propTypes={componentRef:a.a.func.isRequired,font:a.a.string,getFontName:a.a.func.isRequired,getFontStyle:a.a.func.isRequired,onChoose:a.a.func.isRequired,onClickOutsideDropdown:a.a.func,onHoverChinese:a.a.func,onHoverCurly:a.a.func,onHoverHandwriting:a.a.func,onHoverJapanese:a.a.func,onHoverKorean:a.a.func,onHoverMarker:a.a.func,onHoverPixel:a.a.func,onHoverSansSerif:a.a.func,onHoverSerif:a.a.func,onOpenDropdown:a.a.func};var Yr=$r;const Zr=Wr.SANS_SERIF,Jr=function(e){return{type:"scratch-paint/fonts/CHANGE_FONT",font:e}};class Qr extends h.a.Component{constructor(e){super(e),b()(this,["getFontStyle","getFontName","handleChangeFontSerif","handleChangeFontSansSerif","handleChangeFontHandwriting","handleChangeFontMarker","handleChangeFontCurly","handleChangeFontPixel","handleChangeFontChinese","handleChangeFontJapanese","handleChangeFontKorean","handleOpenDropdown","handleClickOutsideDropdown","setDropdown","handleChoose"])}getFontStyle(e){switch(e){case Wr.SERIF:return Xr.a.serif;case Wr.SANS_SERIF:return Xr.a.sansSerif;case Wr.HANDWRITING:return Xr.a.handwriting;case Wr.MARKER:return Xr.a.marker;case Wr.CURLY:return Xr.a.curly;case Wr.PIXEL:return Xr.a.pixel;case Wr.CHINESE:return Xr.a.chinese;case Wr.JAPANESE:return Xr.a.japanese;case Wr.KOREAN:return Xr.a.korean;default:return""}}getFontName(e){switch(e){case Wr.CHINESE:return"";case Wr.KOREAN:return"";case Wr.JAPANESE:return"";default:return e}}handleChangeFontSansSerif(){this.dropDown.isOpen()&&this.props.changeFont(Wr.SANS_SERIF)}handleChangeFontSerif(){this.dropDown.isOpen()&&this.props.changeFont(Wr.SERIF)}handleChangeFontHandwriting(){this.dropDown.isOpen()&&this.props.changeFont(Wr.HANDWRITING)}handleChangeFontMarker(){this.dropDown.isOpen()&&this.props.changeFont(Wr.MARKER)}handleChangeFontCurly(){this.dropDown.isOpen()&&this.props.changeFont(Wr.CURLY)}handleChangeFontPixel(){this.dropDown.isOpen()&&this.props.changeFont(Wr.PIXEL)}handleChangeFontChinese(){this.dropDown.isOpen()&&this.props.changeFont(Wr.CHINESE)}handleChangeFontJapanese(){this.dropDown.isOpen()&&this.props.changeFont(Wr.JAPANESE)}handleChangeFontKorean(){this.dropDown.isOpen()&&this.props.changeFont(Wr.KOREAN)}handleChoose(){this.dropDown.isOpen()&&(this.dropDown.handleClosePopover(),this.props.onUpdateImage())}handleOpenDropdown(){this.savedFont=this.props.font,this.savedSelection=ce()}handleClickOutsideDropdown(e){e.stopPropagation(),this.dropDown.handleClosePopover();for(const e of this.savedSelection)e instanceof i.a.PointText&&(e.font=this.savedFont);this.props.changeFont(this.savedFont),this.savedFont=null,this.savedSelection=null}setDropdown(e){this.dropDown=e}render(){return h.a.createElement(Yr,{componentRef:this.setDropdown,font:this.props.font,getFontName:this.getFontName,getFontStyle:this.getFontStyle,onChoose:this.handleChoose,onClickOutsideDropdown:this.handleClickOutsideDropdown,onHoverChinese:this.handleChangeFontChinese,onHoverCurly:this.handleChangeFontCurly,onHoverHandwriting:this.handleChangeFontHandwriting,onHoverJapanese:this.handleChangeFontJapanese,onHoverKorean:this.handleChangeFontKorean,onHoverMarker:this.handleChangeFontMarker,onHoverPixel:this.handleChangeFontPixel,onHoverSansSerif:this.handleChangeFontSansSerif,onHoverSerif:this.handleChangeFontSerif,onOpenDropdown:this.handleOpenDropdown})}}Qr.propTypes={changeFont:a.a.func.isRequired,font:a.a.string,onUpdateImage:a.a.func.isRequired};var el=Object(p.connect)(e=>({font:e.scratchPaint.font}),e=>({changeFont:t=>{e(Jr(t))}}))(Qr);function tl(){return(tl=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e}).apply(this,arguments)}var ol=function(e){class t extends h.a.Component{constructor(e){super(e),b()(this,["handleChange","handleKeyPress","handleFlush"]),this.state={value:null}}handleKeyPress(e){"Enter"===e.key&&(this.handleChange(e),e.target.blur())}handleFlush(){this.setState({value:null})}handleChange(e){const t=!("number"==typeof this.props.value)||!isNaN(e.target.value);if(null!==e.target.value&&t){let t=Number(e.target.value);void 0!==this.props.max&&t>Number(this.props.max)&&(t=this.props.max),void 0!==this.props.min&&t<Number(this.props.min)&&(t=this.props.min),this.props.onSubmit(t)}this.setState({value:e.target.value})}render(){const t=null===this.state.value?this.props.value:this.state.value;return h.a.createElement(e,tl({},this.props,{value:t,onBlur:this.handleFlush,onChange:this.handleChange,onKeyPress:this.handleKeyPress}))}}return t.propTypes={max:a.a.oneOfType([a.a.number,a.a.string]),min:a.a.oneOfType([a.a.number,a.a.string]),onSubmit:a.a.func.isRequired,value:a.a.oneOfType([a.a.string,a.a.number])},t},nl=o(949),il=o.n(nl),sl=o(951),al=o.n(sl),rl=o(952),ll=o.n(rl),cl=o(953),dl=o.n(cl),hl=o(954),pl=o.n(hl),ul=o(955),ml=o.n(ul),fl=o(956),gl=o.n(fl),bl=o(957),vl=o.n(bl),wl=o(958),Sl=o.n(wl),Cl=o(959),Il=o.n(Cl);const xl=ol(ar),Tl=e=>{const t=Object(f.defineMessages)({brushSize:{defaultMessage:"Size",description:"Label for the brush size input",id:"paint.modeTools.brushSize"},eraserSize:{defaultMessage:"Eraser size",description:"Label for the eraser size input",id:"paint.modeTools.eraserSize"},copy:{defaultMessage:"Copy",description:"Label for the copy button",id:"paint.modeTools.copy"},paste:{defaultMessage:"Paste",description:"Label for the paste button",id:"paint.modeTools.paste"},delete:{defaultMessage:"Delete",description:"Label for the delete button",id:"paint.modeTools.delete"},curved:{defaultMessage:"Curved",description:"Label for the button that converts selected points to curves",id:"paint.modeTools.curved"},pointed:{defaultMessage:"Pointed",description:"Label for the button that converts selected points to sharp points",id:"paint.modeTools.pointed"},thickness:{defaultMessage:"Thickness",description:"Label for the number input to choose the line thickness",id:"paint.modeTools.thickness"},flipHorizontal:{defaultMessage:"Flip Horizontal",description:"Label for the button to flip the image horizontally",id:"paint.modeTools.flipHorizontal"},flipVertical:{defaultMessage:"Flip Vertical",description:"Label for the button to flip the image vertically",id:"paint.modeTools.flipVertical"},filled:{defaultMessage:"Filled",description:"Label for the button that sets the bitmap rectangle/oval mode to draw outlines",id:"paint.modeTools.filled"},outlined:{defaultMessage:"Outlined",description:"Label for the button that sets the bitmap rectangle/oval mode to draw filled-in shapes",id:"paint.modeTools.outlined"}});switch(e.mode){case E.BRUSH:case E.BIT_BRUSH:case E.BIT_LINE:{const o=C(e.format)?Gi.a:e.mode===E.BIT_LINE?bn.a:cn.a,n=I(e.format)?e.bitBrushSize:e.brushValue,i=I(e.format)?e.onBitBrushSliderChange:e.onBrushSliderChange,s=e.mode===E.BIT_LINE?t.thickness:t.brushSize;return h.a.createElement("div",{className:m()(e.className,il.a.modeTools)},h.a.createElement("div",null,h.a.createElement("img",{alt:e.intl.formatMessage(s),className:il.a.modeToolsIcon,draggable:!1,src:o})),h.a.createElement(xl,{range:!0,small:!0,max:100,min:"1",type:"number",value:n,onSubmit:i}))}case E.BIT_ERASER:case E.ERASER:{const o=C(e.format)?Zi.a:gi.a,n=I(e.format)?e.bitEraserSize:e.eraserValue,i=I(e.format)?e.onBitEraserSliderChange:e.onEraserSliderChange;return h.a.createElement("div",{className:m()(e.className,il.a.modeTools)},h.a.createElement("div",null,h.a.createElement("img",{alt:e.intl.formatMessage(t.eraserSize),className:il.a.modeToolsIcon,draggable:!1,src:o})),h.a.createElement(xl,{range:!0,small:!0,max:100,min:"1",type:"number",value:n,onSubmit:i}))}case E.RESHAPE:return h.a.createElement("div",{className:m()(e.className,il.a.modeTools)},h.a.createElement(ea,{className:m()(il.a.modDashedBorder,il.a.modLabeledIconHeight)},h.a.createElement(Rs,{disabled:!e.hasSelectedUncurvedPoints,hideLabel:cr(e.intl.locale),imgSrc:pl.a,title:e.intl.formatMessage(t.curved),onClick:e.onCurvePoints}),h.a.createElement(Rs,{disabled:!e.hasSelectedUnpointedPoints,hideLabel:cr(e.intl.locale),imgSrc:vl.a,title:e.intl.formatMessage(t.pointed),onClick:e.onPointPoints})),h.a.createElement(ea,{className:m()(il.a.modLabeledIconHeight)},h.a.createElement(Rs,{hideLabel:cr(e.intl.locale),imgSrc:dl.a,title:e.intl.formatMessage(t.delete),onClick:e.onDelete})));case E.BIT_SELECT:case E.SELECT:return h.a.createElement("div",{className:m()(e.className,il.a.modeTools)},h.a.createElement(ea,{className:m()(il.a.modDashedBorder,il.a.modLabeledIconHeight)},h.a.createElement(Rs,{hideLabel:cr(e.intl.locale),imgSrc:al.a,title:e.intl.formatMessage(t.copy),onClick:e.onCopyToClipboard}),h.a.createElement(Rs,{disabled:!(e.clipboardItems.length>0),hideLabel:cr(e.intl.locale),imgSrc:ll.a,title:e.intl.formatMessage(t.paste),onClick:e.onPasteFromClipboard})),h.a.createElement(ea,{className:m()(il.a.modDashedBorder,il.a.modLabeledIconHeight)},h.a.createElement(Rs,{hideLabel:cr(e.intl.locale),imgSrc:dl.a,title:e.intl.formatMessage(t.delete),onClick:e.onDelete})),h.a.createElement(ea,{className:m()(il.a.modLabeledIconHeight)},h.a.createElement(Rs,{hideLabel:"en"!==e.intl.locale,imgSrc:ml.a,title:e.intl.formatMessage(t.flipHorizontal),onClick:e.onFlipHorizontal}),h.a.createElement(Rs,{hideLabel:"en"!==e.intl.locale,imgSrc:gl.a,title:e.intl.formatMessage(t.flipVertical),onClick:e.onFlipVertical})));case E.BIT_TEXT:case E.TEXT:return h.a.createElement("div",{className:m()(e.className,il.a.modeTools)},h.a.createElement(ea,null,h.a.createElement(el,{onUpdateImage:e.onUpdateImage})));case E.BIT_RECT:case E.BIT_OVAL:{const o=e.mode===E.BIT_RECT?Qn.a:Vn.a,n=e.mode===E.BIT_RECT?Il.a:Sl.a;return h.a.createElement("div",{className:m()(e.className,il.a.modeTools)},h.a.createElement(ea,null,h.a.createElement(Rs,{highlighted:e.fillBitmapShapes,imgSrc:o,title:e.intl.formatMessage(t.filled),onClick:e.onFillShapes})),h.a.createElement(ea,null,h.a.createElement(Rs,{highlighted:!e.fillBitmapShapes,imgSrc:n,title:e.intl.formatMessage(t.outlined),onClick:e.onOutlineShapes})),e.fillBitmapShapes?null:h.a.createElement(ea,null,h.a.createElement(ia,{text:e.intl.formatMessage(t.thickness)},h.a.createElement(xl,{range:!0,small:!0,max:100,min:"1",type:"number",value:e.bitBrushSize,onSubmit:e.onBitBrushSliderChange}))))}default:return h.a.createElement("div",{className:m()(e.className,il.a.modeTools)})}};Tl.propTypes={bitBrushSize:a.a.number,bitEraserSize:a.a.number,brushValue:a.a.number,className:a.a.string,clipboardItems:a.a.arrayOf(a.a.array),eraserValue:a.a.number,fillBitmapShapes:a.a.bool,format:a.a.oneOf(Object.keys(S)),hasSelectedUncurvedPoints:a.a.bool,hasSelectedUnpointedPoints:a.a.bool,intl:f.intlShape.isRequired,mode:a.a.string.isRequired,onBitBrushSliderChange:a.a.func.isRequired,onBitEraserSliderChange:a.a.func.isRequired,onBrushSliderChange:a.a.func.isRequired,onCopyToClipboard:a.a.func.isRequired,onCurvePoints:a.a.func.isRequired,onDelete:a.a.func.isRequired,onEraserSliderChange:a.a.func,onFillShapes:a.a.func.isRequired,onFlipHorizontal:a.a.func.isRequired,onFlipVertical:a.a.func.isRequired,onOutlineShapes:a.a.func.isRequired,onPasteFromClipboard:a.a.func.isRequired,onPointPoints:a.a.func.isRequired,onUpdateImage:a.a.func.isRequired};var yl=Object(p.connect)(e=>({mode:e.scratchPaint.mode,format:e.scratchPaint.format,fillBitmapShapes:e.scratchPaint.fillBitmapShapes,bitBrushSize:e.scratchPaint.bitBrushSize,bitEraserSize:e.scratchPaint.bitEraserSize,brushValue:e.scratchPaint.brushMode.brushSize,clipboardItems:e.scratchPaint.clipboard.items,eraserValue:e.scratchPaint.eraserMode.brushSize}),e=>({onBrushSliderChange:t=>{e(function(e){return{type:"scratch-paint/brush-mode/CHANGE_BRUSH_SIZE",brushSize:e}}(t))},onBitBrushSliderChange:t=>{e(function(e){return{type:"scratch-paint/brush-mode/CHANGE_BIT_BRUSH_SIZE",brushSize:e}}(t))},onBitEraserSliderChange:t=>{e(function(e){return{type:"scratch-paint/eraser-mode/CHANGE_BIT_ERASER_SIZE",eraserSize:e}}(t))},onEraserSliderChange:t=>{e($i(t))},onFillShapes:()=>{e(Vr(!0))},onOutlineShapes:()=>{e(Vr(!1))}}))(Object(f.injectIntl)(Tl));class Ml extends h.a.Component{constructor(e){super(e),b()(this,["_getSelectedUncurvedPoints","_getSelectedUnpointedPoints","hasSelectedUncurvedPoints","hasSelectedUnpointedPoints","handleCurvePoints","handleFlipHorizontal","handleFlipVertical","handleDelete","handlePasteFromClipboard","handlePointPoints"])}_getSelectedUncurvedPoints(){const e=[],t=ce();for(const o of t)if(o.segments)for(const t of o.segments)if(t.selected){const o=t.getPrevious(),n=t.getNext();(!o||t.handleIn.length>0)&&(!n||t.handleOut.length>0)&&(!o||!n||t.handleOut.isColinear(t.handleIn))||e.push(t)}return e}_getSelectedUnpointedPoints(){const e=[],t=ce();for(const o of t)if(o.segments)for(const t of o.segments)t.selected&&(t.handleIn.length>0||t.handleOut.length>0)&&e.push(t);return e}hasSelectedUncurvedPoints(){return this._getSelectedUncurvedPoints().length>0}hasSelectedUnpointedPoints(){return this._getSelectedUnpointedPoints().length>0}handleCurvePoints(){let e;const t=this._getSelectedUncurvedPoints();for(const o of t){const t=o.getPrevious(),n=o.getNext(),i=0===o.handleIn.length&&0===o.handleOut.length;if(t||n){if(t&&n&&i)o.handleIn=t.point.subtract(n.point).normalize().multiply(t.getCurve().length*G);else if(t&&!n&&0===o.handleIn.length){const e=t.getCurve().getCurvatureAtTime(.5)<0?-1:1;o.handleIn=t.getCurve().getNormalAtTime(1).multiply(e).add(t.point.subtract(o.point).normalize()).normalize().multiply(t.getCurve().length*G)}else if(n&&!t&&0===o.handleOut.length){const e=o.getCurve().getCurvatureAtTime(.5)<0?-1:1;o.handleOut=o.getCurve().getNormalAtTime(0).multiply(e).add(n.point.subtract(o.point).normalize()).normalize().multiply(o.getCurve().length*G)}o.handleIn.length>0&&n?o.handleOut=o.handleIn.multiply(-1):o.handleOut.length>0&&t&&(o.handleIn=o.handleOut.multiply(-1)),e=!0}}e&&(this.props.setSelectedItems(this.props.format),this.props.onUpdateImage())}handlePointPoints(){let e;const t=this._getSelectedUnpointedPoints();for(const o of t){0===o.handleIn.length&&0===o.handleOut.length||(o.handleIn=null,o.handleOut=null,e=!0)}e&&(this.props.setSelectedItems(this.props.format),this.props.onUpdateImage())}_handleFlip(e,t,o){0===o.length&&(o=ee());for(const e of o)e.data.index=e.index;const n=new i.a.Group(o);n.scale(e,t),Y(n);for(let e=0;e<o.length;e++)n.layer.insertChild(o[e].data.index,o[e]),o[e].data.index=null;n.remove(),this.props.onUpdateImage()}handleFlipHorizontal(){const e=le();I(this.props.format)&&0===e.length?(yt().canvas=Ke(yt().canvas),this.props.onUpdateImage()):this._handleFlip(-1,1,e)}handleFlipVertical(){const e=le();I(this.props.format)&&0===e.length?(yt().canvas=Xe(yt().canvas),this.props.onUpdateImage()):this._handleFlip(1,-1,e)}handlePasteFromClipboard(){this.props.onPasteFromClipboard()&&this.props.onUpdateImage()}handleDelete(){this.props.selectedItems.length||(I(this.props.format)?Qe(this.props.clearSelectedItems):this.props.mode===E.RESHAPE?ae():se()),pe(this.props.mode,this.props.onUpdateImage)&&this.props.setSelectedItems(this.props.format)}render(){return h.a.createElement(yl,{hasSelectedUncurvedPoints:this.hasSelectedUncurvedPoints(),hasSelectedUnpointedPoints:this.hasSelectedUnpointedPoints(),onCopyToClipboard:this.props.onCopyToClipboard,onCurvePoints:this.handleCurvePoints,onDelete:this.handleDelete,onFlipHorizontal:this.handleFlipHorizontal,onFlipVertical:this.handleFlipVertical,onPasteFromClipboard:this.handlePasteFromClipboard,onPointPoints:this.handlePointPoints,onUpdateImage:this.props.onUpdateImage})}}Ml.propTypes={clearSelectedItems:a.a.func.isRequired,format:a.a.oneOf(Object.keys(S)),mode:a.a.oneOf(Object.keys(E)),onCopyToClipboard:a.a.func.isRequired,onPasteFromClipboard:a.a.func.isRequired,onUpdateImage:a.a.func.isRequired,selectedItems:a.a.arrayOf(a.a.instanceOf(i.a.Item)),setSelectedItems:a.a.func.isRequired};var El=qr(Object(p.connect)(e=>({format:e.scratchPaint.format,mode:e.scratchPaint.mode,selectedItems:e.scratchPaint.selectedItems}),e=>({clearSelectedItems:()=>{e(Qt())},setSelectedItems:t=>{e(Jt(ce(),I(t)))}}))(Ml));class Rl extends i.a.Tool{static get TOLERANCE(){return 2}constructor(e,t,o,n){super(),this.setSelectedItems=e,this.clearSelectedItems=t,this.onUpdateImage=n,this.boundingBoxTool=new zn(E.OVAL,e,t,o,n);const i=new Hn(E.OVAL,this.boundingBoxTool,n);this.onMouseDown=this.handleMouseDown,this.onMouseDrag=this.handleMouseDrag,this.onMouseMove=this.handleMouseMove,this.onMouseUp=this.handleMouseUp,this.onKeyUp=i.onKeyUp,this.onKeyDown=i.onKeyDown,this.oval=null,this.colorState=null,this.isBoundingBoxMode=null,this.active=!1}getHitOptions(){return{segments:!0,stroke:!0,curves:!0,fill:!0,guide:!1,match:e=>e.item.data&&(e.item.data.isScaleHandle||e.item.data.isRotHandle)||e.item.selected,tolerance:Rl.TOLERANCE/i.a.view.zoom}}onSelectionChanged(e){this.boundingBoxTool.onSelectionChanged(e)}setColorState(e){this.colorState=e}handleMouseDown(e){e.event.button>0||(this.active=!0,this.boundingBoxTool.onMouseDown(e,!1,!1,!1,this.getHitOptions())?this.isBoundingBoxMode=!0:(this.isBoundingBoxMode=!1,re(this.clearSelectedItems),this.oval=new i.a.Shape.Ellipse({point:e.downPoint,size:0}),Go(this.oval,this.colorState)))}handleMouseDrag(e){if(e.event.button>0||!this.active)return;if(this.isBoundingBoxMode)return void this.boundingBoxTool.onMouseDrag(e);const t=new i.a.Point(e.downPoint.x,e.downPoint.y),o=new i.a.Point(e.point.x,e.point.y),n=J(e.downPoint,e.point);e.modifiers.shift?this.oval.size=n.size.abs():this.oval.size=t.subtract(o),e.modifiers.alt?this.oval.position=t:e.modifiers.shift?this.oval.position=n.position:this.oval.position=t.subtract(this.oval.size.multiply(.5))}handleMouseMove(e){this.boundingBoxTool.onMouseMove(e,this.getHitOptions())}handleMouseUp(e){if(!(e.event.button>0)&&this.active){if(this.isBoundingBoxMode)return this.boundingBoxTool.onMouseUp(e),void(this.isBoundingBoxMode=null);if(this.oval)if(Math.abs(this.oval.size.width*this.oval.size.height)<Rl.TOLERANCE/i.a.view.zoom)this.oval.remove(),this.oval=null;else{const e=this.oval.toPath(!0);this.oval.remove(),this.oval=null,e.selected=!0,this.setSelectedItems(),this.onUpdateImage()}this.active=!1}}deactivateTool(){this.boundingBoxTool.deactivateTool()}}var kl=Rl,Ol=o(960),Dl=o.n(Ol);const Pl=e=>h.a.createElement(an,{imgDescriptor:rn.oval,imgSrc:Dl.a,isSelected:e.isSelected,onMouseDown:e.onMouseDown});Pl.propTypes={isSelected:a.a.bool.isRequired,onMouseDown:a.a.func.isRequired};var _l=Pl;class Ll extends h.a.Component{constructor(e){super(e),b()(this,["activateTool","deactivateTool"])}componentDidMount(){this.props.isOvalModeActive&&this.activateTool(this.props)}componentWillReceiveProps(e){this.tool&&e.colorState!==this.props.colorState&&this.tool.setColorState(e.colorState),this.tool&&e.selectedItems!==this.props.selectedItems&&this.tool.onSelectionChanged(e.selectedItems),e.isOvalModeActive&&!this.props.isOvalModeActive?this.activateTool():!e.isOvalModeActive&&this.props.isOvalModeActive&&this.deactivateTool()}shouldComponentUpdate(e){return e.isOvalModeActive!==this.props.isOvalModeActive}componentWillUnmount(){this.tool&&this.deactivateTool()}activateTool(){re(this.props.clearSelectedItems),this.props.clearGradient();const{fillColor:e,strokeColor:t,strokeWidth:o}=this.props.colorState,n=e!==Ro&&null!==e,i=t!==Ro&&null!==t&&null!==o&&0!==o;n||i?!n&&i?this.props.onChangeFillColor(null):n&&!i&&this.props.onChangeStrokeColor(null):(this.props.onChangeFillColor(To),this.props.onChangeStrokeColor(null)),this.tool=new kl(this.props.setSelectedItems,this.props.clearSelectedItems,this.props.setCursor,this.props.onUpdateImage),this.tool.setColorState(this.props.colorState),this.tool.activate()}deactivateTool(){this.tool.deactivateTool(),this.tool.remove(),this.tool=null}render(){return h.a.createElement(_l,{isSelected:this.props.isOvalModeActive,onMouseDown:this.props.handleMouseDown})}}Ll.propTypes={clearGradient:a.a.func.isRequired,clearSelectedItems:a.a.func.isRequired,colorState:a.a.shape({fillColor:a.a.string,strokeColor:a.a.string,strokeWidth:a.a.number}).isRequired,handleMouseDown:a.a.func.isRequired,isOvalModeActive:a.a.bool.isRequired,onChangeFillColor:a.a.func.isRequired,onChangeStrokeColor:a.a.func.isRequired,onUpdateImage:a.a.func.isRequired,selectedItems:a.a.arrayOf(a.a.instanceOf(i.a.Item)),setCursor:a.a.func.isRequired,setSelectedItems:a.a.func.isRequired};var Bl=Object(p.connect)(e=>({colorState:e.scratchPaint.color,isOvalModeActive:e.scratchPaint.mode===E.OVAL,selectedItems:e.scratchPaint.selectedItems}),e=>({clearSelectedItems:()=>{e(Qt())},clearGradient:()=>{e(Yo())},setCursor:t=>{e(On(t))},setSelectedItems:()=>{e(Jt(ce(),!1))},handleMouseDown:()=>{e(Vo(E.OVAL))},onChangeFillColor:t=>{e(Eo(t))},onChangeStrokeColor:t=>{e(ya(t))}}))(Ll);class Al extends i.a.Tool{static get TOLERANCE(){return 2}constructor(e,t,o,n){super(),this.setSelectedItems=e,this.clearSelectedItems=t,this.onUpdateImage=n,this.boundingBoxTool=new zn(E.RECT,e,t,o,n);const i=new Hn(E.RECT,this.boundingBoxTool,n);this.onMouseDown=this.handleMouseDown,this.onMouseMove=this.handleMouseMove,this.onMouseDrag=this.handleMouseDrag,this.onMouseUp=this.handleMouseUp,this.onKeyUp=i.onKeyUp,this.onKeyDown=i.onKeyDown,this.rect=null,this.colorState=null,this.isBoundingBoxMode=null,this.active=!1}getHitOptions(){return{segments:!0,stroke:!0,curves:!0,fill:!0,guide:!1,match:e=>e.item.data&&(e.item.data.isScaleHandle||e.item.data.isRotHandle)||e.item.selected,tolerance:Al.TOLERANCE/i.a.view.zoom}}onSelectionChanged(e){this.boundingBoxTool.onSelectionChanged(e)}setColorState(e){this.colorState=e}handleMouseDown(e){e.event.button>0||(this.active=!0,this.boundingBoxTool.onMouseDown(e,!1,!1,!1,this.getHitOptions())?this.isBoundingBoxMode=!0:(this.isBoundingBoxMode=!1,re(this.clearSelectedItems)))}handleMouseDrag(e){if(e.event.button>0||!this.active)return;if(this.isBoundingBoxMode)return void this.boundingBoxTool.onMouseDrag(e);this.rect&&this.rect.remove();const t=new i.a.Rectangle(e.downPoint,e.point),o=J(e.downPoint,e.point);if(e.modifiers.shift&&(t.size=o.size.abs()),this.rect=new i.a.Path.Rectangle(t),e.modifiers.alt)this.rect.position=e.downPoint;else if(e.modifiers.shift)this.rect.position=o.position;else{const t=e.point.subtract(e.downPoint);this.rect.position=e.downPoint.add(t.multiply(.5))}Go(this.rect,this.colorState)}handleMouseUp(e){if(!(e.event.button>0)&&this.active){if(this.isBoundingBoxMode)return this.boundingBoxTool.onMouseUp(e),void(this.isBoundingBoxMode=null);this.rect&&(this.rect.area<Al.TOLERANCE/i.a.view.zoom?(this.rect.remove(),this.rect=null):(this.rect.selected=!0,this.setSelectedItems(),this.onUpdateImage(),this.rect=null)),this.active=!1}}handleMouseMove(e){this.boundingBoxTool.onMouseMove(e,this.getHitOptions())}deactivateTool(){this.boundingBoxTool.deactivateTool()}}var Nl=Al,Ul=o(961),zl=o.n(Ul);const Fl=e=>h.a.createElement(an,{imgDescriptor:rn.rect,imgSrc:zl.a,isSelected:e.isSelected,onMouseDown:e.onMouseDown});Fl.propTypes={isSelected:a.a.bool.isRequired,onMouseDown:a.a.func.isRequired};var Hl=Fl;class ql extends h.a.Component{constructor(e){super(e),b()(this,["activateTool","deactivateTool"])}componentDidMount(){this.props.isRectModeActive&&this.activateTool(this.props)}componentWillReceiveProps(e){this.tool&&e.colorState!==this.props.colorState&&this.tool.setColorState(e.colorState),this.tool&&e.selectedItems!==this.props.selectedItems&&this.tool.onSelectionChanged(e.selectedItems),e.isRectModeActive&&!this.props.isRectModeActive?this.activateTool():!e.isRectModeActive&&this.props.isRectModeActive&&this.deactivateTool()}shouldComponentUpdate(e){return e.isRectModeActive!==this.props.isRectModeActive}componentWillUnmount(){this.tool&&this.deactivateTool()}activateTool(){re(this.props.clearSelectedItems),this.props.clearGradient();const{fillColor:e,strokeColor:t,strokeWidth:o}=this.props.colorState,n=e!==Ro&&null!==e,i=t!==Ro&&null!==t&&null!==o&&0!==o;n||i?!n&&i?this.props.onChangeFillColor(null):n&&!i&&this.props.onChangeStrokeColor(null):(this.props.onChangeFillColor(To),this.props.onChangeStrokeColor(null)),this.tool=new Nl(this.props.setSelectedItems,this.props.clearSelectedItems,this.props.setCursor,this.props.onUpdateImage),this.tool.setColorState(this.props.colorState),this.tool.activate()}deactivateTool(){this.tool.deactivateTool(),this.tool.remove(),this.tool=null}render(){return h.a.createElement(Hl,{isSelected:this.props.isRectModeActive,onMouseDown:this.props.handleMouseDown})}}ql.propTypes={clearGradient:a.a.func.isRequired,clearSelectedItems:a.a.func.isRequired,colorState:a.a.shape({fillColor:a.a.string,strokeColor:a.a.string,strokeWidth:a.a.number}).isRequired,handleMouseDown:a.a.func.isRequired,isRectModeActive:a.a.bool.isRequired,onChangeFillColor:a.a.func.isRequired,onChangeStrokeColor:a.a.func.isRequired,onUpdateImage:a.a.func.isRequired,selectedItems:a.a.arrayOf(a.a.instanceOf(i.a.Item)),setCursor:a.a.func.isRequired,setSelectedItems:a.a.func.isRequired};var Gl=Object(p.connect)(e=>({colorState:e.scratchPaint.color,isRectModeActive:e.scratchPaint.mode===E.RECT,selectedItems:e.scratchPaint.selectedItems}),e=>({clearSelectedItems:()=>{e(Qt())},clearGradient:()=>{e(Yo())},setSelectedItems:()=>{e(Jt(ce(),!1))},setCursor:t=>{e(On(t))},handleMouseDown:()=>{e(Vo(E.RECT))},onChangeFillColor:t=>{e(Eo(t))},onChangeStrokeColor:t=>{e(ya(t))}}))(ql);var jl=class{constructor(e,t,o){this.deselectOnMouseUp=null,this.deleteOnMouseUp=null,this.invertDeselect=!1,this.selectedItems=null,this.setSelectedItems=e,this.clearSelectedItems=t,this.lastPoint=null,this.onUpdateImage=o}onMouseDown(e){e.doubleClicked&&(this.deleteOnMouseUp=e.hitResult),e.hitResult.segment.selected?e.multiselect?this.deselectOnMouseUp=e.hitResult.segment:(this.deselectOnMouseUp=e.hitResult.segment,this.invertDeselect=!0,e.hitResult.segment.selected=!0):(e.multiselect||re(this.clearSelectedItems),e.hitResult.segment.selected=!0),this.selectedItems=ce()}addPoint(e){const t=e.hitResult.location.curveOffset,o=e.hitResult.location.curve.length-e.hitResult.location.curveOffset;let n=e.hitResult.location.tangent.multiply(-t*G),s=e.hitResult.location.tangent.multiply(o*G);n.length>3*s.length&&(n=n.multiply(3*s.length/n.length)),s.length>3*n.length&&(s=s.multiply(3*n.length/s.length));const a=e.hitResult.item.segments[e.hitResult.location.index],r=e.hitResult.item.segments[e.hitResult.location.index+1],l=new i.a.Segment(e.hitResult.location.point,n,s);e.hitResult.item.insert(e.hitResult.location.index+1,l),e.hitResult.segment=l,e.multiselect||re(this.clearSelectedItems),l.selected=!0,a&&a.handleOut&&(a.handleOut=r?a.handleOut.multiply(t*G/a.handleOut.length):null),r&&r.handleIn&&(r.handleIn=a?r.handleIn.multiply(o*G/r.handleIn.length):null)}removePoint(e){const t=e.segment.index;e.item.removeSegment(t);const o=e.item.segments[t-1],n=e.item.segments[t],i=o&&o.curve?o.curve.length:null;o&&o.handleOut&&(o.handleOut=n?o.handleOut.multiply(i*G/o.handleOut.length):null),n&&n.handleIn&&(n.handleIn=o?n.handleIn.multiply(i*G/n.handleIn.length):null)}onMouseDrag(e){this.deselectOnMouseUp=null,this.invertDeselect=!1,this.deleteOnMouseUp=null;const t=e.point,o=bt();t.x=Math.max(o.left,Math.min(t.x,o.right)),t.y=Math.max(o.top,Math.min(t.y,o.bottom)),this.lastPoint||(this.lastPoint=e.lastPoint);const n=t.subtract(e.downPoint),i=t.subtract(this.lastPoint);this.lastPoint=t;const s=de();for(const t of s)t.origPoint||(t.origPoint=t.point.clone()),e.modifiers.shift?t.point=t.origPoint.add(V(n,Math.PI/4)):t.point=t.point.add(i)}onMouseUp(){this.lastPoint=null;let e=!1;const t=de();for(const o of t)o.origPoint&&!o.equals(o.origPoint)&&(e=!0),o.origPoint=null;this.deselectOnMouseUp&&(this.invertDeselect?(re(this.clearSelectedItems),this.deselectOnMouseUp.selected=!0):this.deselectOnMouseUp.selected=!1,this.deselectOnMouseUp=null,this.invertDeselect=!1),this.deleteOnMouseUp&&this.removePoint(this.deleteOnMouseUp),this.selectedItems=null,this.setSelectedItems(),(e||this.deleteOnMouseUp)&&(this.deleteOnMouseUp=null,this.onUpdateImage())}};var Vl=class{constructor(e,t,o){this.hitType=null,this.setSelectedItems=e,this.clearSelectedItems=t,this.onUpdateImage=o,this.selectedItems=[]}onMouseDown(e){e.multiselect||re(this.clearSelectedItems),e.hitResult.segment.handleIn.selected=!0,e.hitResult.segment.handleOut.selected=!0,this.hitType=e.hitResult.type}onMouseDrag(e){this.selectedItems=ce();for(const t of this.selectedItems)for(const o of t.segments)o.origPoint||(o.origPoint=o.point.clone()),o.handleOut.selected&&"handle-out"===this.hitType?e.modifiers.option||!o.handleOut.isColinear(o.handleIn)?o.handleOut=o.handleOut.add(e.delta):(o.handleOut=o.handleOut.add(e.delta),o.handleIn=o.handleOut.multiply(-o.handleIn.length/o.handleOut.length)):o.handleIn.selected&&"handle-in"===this.hitType&&(e.modifiers.option||!o.handleOut.isColinear(o.handleIn)?o.handleIn=o.handleIn.add(e.delta):(o.handleIn=o.handleIn.add(e.delta),o.handleOut=o.handleIn.multiply(-o.handleOut.length/o.handleIn.length)))}onMouseUp(){let e=!1;for(const t of this.selectedItems){if(!t.segments)return;for(const o of t.segments)o.origPoint&&!o.equals(o.origPoint)&&(e=!0),o.origPoint=null}e&&(this.setSelectedItems(),this.onUpdateImage()),this.selectedItems=[]}};const Wl=w()({FILL:null,POINT:null,HANDLE:null,SELECTION_BOX:null});class Kl extends i.a.Tool{static get TOLERANCE(){return 4}static get DOUBLE_CLICK_MILLIS(){return 250}constructor(e,t,o,n,s,a){super(),this.setHoveredItem=e,this.clearHoveredItem=t,this.onUpdateImage=s,this.prevHoveredItemId=null,this.lastEvent=null,this.active=!1,this.mode=Wl.SELECTION_BOX,this._modeMap={},this._modeMap[Wl.FILL]=new Bn(E.RESHAPE,o,n,s,a),this._modeMap[Wl.POINT]=new jl(o,n,s),this._modeMap[Wl.HANDLE]=new Vl(o,n,s),this._modeMap[Wl.SELECTION_BOX]=new Ci(E.RESHAPE,o,n),this.onMouseDown=this.handleMouseDown,this.onMouseMove=this.handleMouseMove,this.onMouseDrag=this.handleMouseDrag,this.onMouseUp=this.handleMouseUp,this.onKeyUp=this.handleKeyUp,this.onKeyDown=this.handleKeyDown,i.a.settings.handleSize=8}getSelectedSegmentHitOptions(){return{segments:!0,tolerance:Kl.TOLERANCE/i.a.view.zoom,match:e=>"segment"===e.type&&((!e.item.data||!e.item.data.noHover)&&!!e.item.selected)}}getHandleHitOptions(){return{handles:!0,tolerance:Kl.TOLERANCE/i.a.view.zoom,match:e=>(!e.item.data||!e.item.data.noHover)&&(!(!e.segment||!e.segment.selected)&&!e.item.fullySelected)}}getSelectedStrokeHitOptions(){return{segments:!1,stroke:!0,curves:!0,handles:!1,fill:!1,guide:!1,tolerance:Kl.TOLERANCE/i.a.view.zoom,match:e=>"stroke"===e.type&&"curve"===e.type&&(!!e.item.selected&&(!e.item.data||!e.item.data.noHover))}}getUnselectedAndFillHitOptions(){return{fill:!0,stroke:!0,curves:!0,tolerance:Kl.TOLERANCE/i.a.view.zoom,match:e=>!e.item.data||!e.item.data.noHover}}setPrevHoveredItemId(e){this.prevHoveredItemId=e}getHitResult(e){let t,o=i.a.project.hitTestAll(e,this.getSelectedSegmentHitOptions());if(o.length||(o=i.a.project.hitTestAll(e,this.getHandleHitOptions())),o.length||(o=i.a.project.hitTestAll(e,this.getSelectedStrokeHitOptions())),o.length||(o=i.a.project.hitTestAll(e,this.getUnselectedAndFillHitOptions())),!o.length)return null;for(const e of o)(!t||K(t.item,e.item)<0)&&(t=e);return t}handleMouseDown(e){if(e.event.button>0)return;this.active=!0,this.clearHoveredItem();let t=!1;this.lastEvent&&(t=e.event.timeStamp-this.lastEvent.event.timeStamp<Kl.DOUBLE_CLICK_MILLIS),this.lastEvent=e;const o=this.getHitResult(e.point);if(!o)return void this._modeMap[Wl.SELECTION_BOX].onMouseDown(e.modifiers.shift);const n={hitResult:o,clone:e.modifiers.alt,multiselect:e.modifiers.shift,doubleClicked:t,subselect:!0};!o.item.selected||"fill"===o.type||"segment"!==o.type&&t?(this.mode=Wl.FILL,this._modeMap[this.mode].onMouseDown(n)):"segment"===o.type?(this.mode=Wl.POINT,this._modeMap[this.mode].onMouseDown(n)):"stroke"===o.type||"curve"===o.type?(this.mode=Wl.POINT,this._modeMap[this.mode].addPoint(n),this.onUpdateImage(),this._modeMap[this.mode].onMouseDown(n)):"handle-in"===o.type||"handle-out"===o.type?(this.mode=Wl.HANDLE,this._modeMap[this.mode].onMouseDown(n)):(c.warn(`Unhandled hit result type: ${o.type}`),this.mode=Wl.FILL,this._modeMap[this.mode].onMouseDown(n))}handleMouseMove(e){const t=this.getHitResult(e.point);let o;if(t){const e=t.item;o=e.selected?null:k(e)?Se(e):we(e)}(!o&&this.prevHoveredItemId||o&&!this.prevHoveredItemId||o&&this.prevHoveredItemId&&o.id!==this.prevHoveredItemId)&&this.setHoveredItem(o?o.id:null)}handleMouseDrag(e){e.event.button>0||!this.active||this._modeMap[this.mode].onMouseDrag(e)}handleMouseUp(e){e.event.button>0||!this.active||(this.mode===Wl.SELECTION_BOX?this._modeMap[this.mode].onMouseUpVector(e):this._modeMap[this.mode].onMouseUp(e),this.mode=Wl.SELECTION_BOX,this.active=!1)}handleKeyDown(e){if(e.event.target instanceof HTMLInputElement)return;const t=1/i.a.view.zoom,o=ce();if(0===o.length)return;let n;if("up"===e.key?n=new i.a.Point(0,-t):"down"===e.key?n=new i.a.Point(0,t):"left"===e.key?n=new i.a.Point(-t,0):"right"===e.key&&(n=new i.a.Point(t,0)),n){const e=de();if(0===e.length)for(const e of o)e.translate(n);else for(const t of e)t.point=t.point.add(n)}}handleKeyUp(e){0!==ce().length&&("up"!==e.key&&"down"!==e.key&&"left"!==e.key&&"right"!==e.key||this.onUpdateImage())}deactivateTool(){i.a.settings.handleSize=0,this.clearHoveredItem(),this.setHoveredItem=null,this.clearHoveredItem=null,this.onUpdateImage=null,this.lastEvent=null}}var Xl=Kl,$l=o(962),Yl=o.n($l);const Zl=e=>h.a.createElement(an,{imgDescriptor:rn.reshape,imgSrc:Yl.a,isSelected:e.isSelected,onMouseDown:e.onMouseDown});Zl.propTypes={isSelected:a.a.bool.isRequired,onMouseDown:a.a.func.isRequired};var Jl=Zl;class Ql extends h.a.Component{constructor(e){super(e),b()(this,["activateTool","deactivateTool"])}componentDidMount(){this.props.isReshapeModeActive&&this.activateTool(this.props)}componentWillReceiveProps(e){this.tool&&e.hoveredItemId!==this.props.hoveredItemId&&this.tool.setPrevHoveredItemId(e.hoveredItemId),e.isReshapeModeActive&&!this.props.isReshapeModeActive?this.activateTool():!e.isReshapeModeActive&&this.props.isReshapeModeActive&&this.deactivateTool()}shouldComponentUpdate(e){return e.isReshapeModeActive!==this.props.isReshapeModeActive}componentWillUnmount(){this.tool&&this.deactivateTool()}activateTool(){this.tool=new Xl(this.props.setHoveredItem,this.props.clearHoveredItem,this.props.setSelectedItems,this.props.clearSelectedItems,this.props.onUpdateImage,this.props.switchToTextTool),this.tool.setPrevHoveredItemId(this.props.hoveredItemId),this.tool.activate()}deactivateTool(){this.tool.deactivateTool(),this.tool.remove(),this.tool=null,this.hitResult=null}render(){return h.a.createElement(Jl,{isSelected:this.props.isReshapeModeActive,onMouseDown:this.props.handleMouseDown})}}Ql.propTypes={clearHoveredItem:a.a.func.isRequired,clearSelectedItems:a.a.func.isRequired,handleMouseDown:a.a.func.isRequired,hoveredItemId:a.a.number,isReshapeModeActive:a.a.bool.isRequired,onUpdateImage:a.a.func.isRequired,setHoveredItem:a.a.func.isRequired,setSelectedItems:a.a.func.isRequired,switchToTextTool:a.a.func.isRequired};var ec=Object(p.connect)(e=>({isReshapeModeActive:e.scratchPaint.mode===E.RESHAPE,hoveredItemId:e.scratchPaint.hoveredItemId}),e=>({setHoveredItem:t=>{e(to(t))},clearHoveredItem:()=>{e(oo())},clearSelectedItems:()=>{e(Qt())},setSelectedItems:()=>{e(Jt(ce(),!1))},handleMouseDown:()=>{e(Vo(E.RESHAPE))},switchToTextTool:()=>{e(Vo(E.TEXT))}}))(Ql);class tc extends i.a.Tool{static get TOLERANCE(){return 2}static get DOUBLE_CLICK_MILLIS(){return 250}constructor(e,t,o,n,i,s,a){super(),this.setHoveredItem=e,this.clearHoveredItem=t,this.onUpdateImage=s,this.boundingBoxTool=new zn(E.SELECT,o,n,i,s,a);const r=new Hn(E.SELECT,this.boundingBoxTool,s);this.selectionBoxTool=new Ci(E.SELECT,o,n),this.selectionBoxMode=!1,this.prevHoveredItemId=null,this.active=!1,this.onMouseDown=this.handleMouseDown,this.onMouseMove=this.handleMouseMove,this.onMouseDrag=this.handleMouseDrag,this.onMouseUp=this.handleMouseUp,this.onKeyUp=r.onKeyUp,this.onKeyDown=r.onKeyDown,be(),o(),this.boundingBoxTool.setSelectionBounds()}setPrevHoveredItemId(e){this.prevHoveredItemId=e}onSelectionChanged(e){this.boundingBoxTool.onSelectionChanged(e)}getHitOptions(e){const t={segments:!0,stroke:!0,curves:!0,fill:!0,guide:!1,tolerance:tc.TOLERANCE/i.a.view.zoom,match:e=>!e.item.data||!e.item.data.isHelperItem||(e.item.data.isScaleHandle||e.item.data.isRotHandle)};return e&&(t.selected=!0),t}handleMouseDown(e){if(e.event.button>0)return;this.active=!0,this.clearHoveredItem();let t=!1;this.lastEvent&&(t=e.event.timeStamp-this.lastEvent.event.timeStamp<tc.DOUBLE_CLICK_MILLIS),this.lastEvent=e,this.boundingBoxTool.onMouseDown(e,e.modifiers.alt,e.modifiers.shift,t,this.getHitOptions(!1))||(this.selectionBoxMode=!0,this.selectionBoxTool.onMouseDown(e.modifiers.shift))}handleMouseMove(e){const t=ha(e,this.getHitOptions());(!t&&this.prevHoveredItemId||t&&!this.prevHoveredItemId||t&&this.prevHoveredItemId&&t.id!==this.prevHoveredItemId)&&this.setHoveredItem(t?t.id:null),this.selectionBoxMode||this.boundingBoxTool.onMouseMove(e,this.getHitOptions(!1))}handleMouseDrag(e){e.event.button>0||!this.active||(this.selectionBoxMode?this.selectionBoxTool.onMouseDrag(e):this.boundingBoxTool.onMouseDrag(e))}handleMouseUp(e){e.event.button>0||!this.active||(this.selectionBoxMode?this.selectionBoxTool.onMouseUpVector(e):this.boundingBoxTool.onMouseUp(e,this.getHitOptions(!1)),this.selectionBoxMode=!1,this.active=!1)}deactivateTool(){this.clearHoveredItem(),this.boundingBoxTool.deactivateTool(),this.setHoveredItem=null,this.clearHoveredItem=null,this.onUpdateImage=null,this.boundingBoxTool=null,this.selectionBoxTool=null}}var oc=tc,nc=o(963),ic=o.n(nc);const sc=e=>h.a.createElement(an,{imgDescriptor:rn.select,imgSrc:ic.a,isSelected:e.isSelected,onMouseDown:e.onMouseDown});sc.propTypes={isSelected:a.a.bool.isRequired,onMouseDown:a.a.func.isRequired};var ac=sc;class rc extends h.a.Component{constructor(e){super(e),b()(this,["activateTool","deactivateTool"])}componentDidMount(){this.props.isSelectModeActive&&this.activateTool(this.props)}componentWillReceiveProps(e){this.tool&&e.hoveredItemId!==this.props.hoveredItemId&&this.tool.setPrevHoveredItemId(e.hoveredItemId),this.tool&&e.selectedItems!==this.props.selectedItems&&this.tool.onSelectionChanged(e.selectedItems),e.isSelectModeActive&&!this.props.isSelectModeActive?this.activateTool():!e.isSelectModeActive&&this.props.isSelectModeActive&&this.deactivateTool()}shouldComponentUpdate(e){return e.isSelectModeActive!==this.props.isSelectModeActive}componentWillUnmount(){this.tool&&this.deactivateTool()}activateTool(){this.tool=new oc(this.props.setHoveredItem,this.props.clearHoveredItem,this.props.setSelectedItems,this.props.clearSelectedItems,this.props.setCursor,this.props.onUpdateImage,this.props.switchToTextTool),this.tool.activate()}deactivateTool(){this.tool.deactivateTool(),this.tool.remove(),this.tool=null}render(){return h.a.createElement(ac,{isSelected:this.props.isSelectModeActive,onMouseDown:this.props.handleMouseDown})}}rc.propTypes={clearHoveredItem:a.a.func.isRequired,clearSelectedItems:a.a.func.isRequired,handleMouseDown:a.a.func.isRequired,hoveredItemId:a.a.number,isSelectModeActive:a.a.bool.isRequired,onUpdateImage:a.a.func.isRequired,selectedItems:a.a.arrayOf(a.a.instanceOf(i.a.Item)),setCursor:a.a.func.isRequired,setHoveredItem:a.a.func.isRequired,setSelectedItems:a.a.func.isRequired,switchToTextTool:a.a.func.isRequired};var lc=Object(p.connect)(e=>({isSelectModeActive:e.scratchPaint.mode===E.SELECT,hoveredItemId:e.scratchPaint.hoveredItemId,selectedItems:e.scratchPaint.selectedItems}),e=>({setHoveredItem:t=>{e(to(t))},clearHoveredItem:()=>{e(oo())},clearSelectedItems:()=>{e(Qt())},setSelectedItems:()=>{e(Jt(ce(),!1))},setCursor:t=>{e(On(t))},handleMouseDown:()=>{e(Vo(E.SELECT))},switchToTextTool:()=>{e(Vo(E.TEXT))}}))(rc);const cc=Object(f.defineMessages)({stroke:{id:"paint.paintEditor.stroke",description:"Label for the color picker for the outline color",defaultMessage:"Outline"}}),dc=e=>h.a.createElement(ea,{className:e.className,disabled:e.disabled},h.a.createElement(ls.a,{body:h.a.createElement(Ys,{color:e.strokeColor,color2:null,gradientType:Co.SOLID,shouldShowGradientTools:!1,onChangeColor:e.onChangeStrokeColor}),isOpen:e.strokeColorModalVisible,preferPlace:"below",onOuterAction:e.onCloseStrokeColor},h.a.createElement(ia,{text:e.intl.formatMessage(cc.stroke)},h.a.createElement(bs,{outline:!0,color:e.strokeColor,color2:null,gradientType:Co.SOLID,onClick:e.onOpenStrokeColor}))));dc.propTypes={className:a.a.string,disabled:a.a.bool.isRequired,intl:f.intlShape,onChangeStrokeColor:a.a.func.isRequired,onCloseStrokeColor:a.a.func.isRequired,onOpenStrokeColor:a.a.func.isRequired,strokeColor:a.a.string,strokeColorModalVisible:a.a.bool.isRequired};var hc=Object(f.injectIntl)(dc);function pc(){return(pc=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e}).apply(this,arguments)}class uc extends h.a.Component{constructor(e){super(e),b()(this,["handleChangeStrokeColor","handleCloseStrokeColor"]),this._hasChanged=!1}componentWillReceiveProps(e){const{strokeColorModalVisible:t,onUpdateImage:o}=this.props;t&&!e.strokeColorModalVisible&&(this._hasChanged&&o(),this._hasChanged=!1)}handleChangeStrokeColor(e){null===this.props.strokeColor&&null!==e?(this._hasChanged=Uo(1,this.props.textEditTarget)||this._hasChanged,this.props.onChangeStrokeWidth(1)):null!==this.props.strokeColor&&null===e&&(this._hasChanged=Uo(0,this.props.textEditTarget)||this._hasChanged,this.props.onChangeStrokeWidth(0)),this._hasChanged=No(e,I(this.props.format),this.props.textEditTarget)||this._hasChanged,this.props.onChangeStrokeColor(e)}handleCloseStrokeColor(){this.props.isEyeDropping||this.props.onCloseStrokeColor()}render(){return h.a.createElement(hc,pc({},this.props,{onChangeStrokeColor:this.handleChangeStrokeColor,onCloseStrokeColor:this.handleCloseStrokeColor}))}}uc.propTypes={format:a.a.oneOf(Object.keys(S)),isEyeDropping:a.a.bool.isRequired,onChangeStrokeColor:a.a.func.isRequired,onChangeStrokeWidth:a.a.func.isRequired,onCloseStrokeColor:a.a.func.isRequired,onUpdateImage:a.a.func.isRequired,strokeColor:a.a.string,strokeColorModalVisible:a.a.bool.isRequired,textEditTarget:a.a.number};var mc=Object(p.connect)(e=>({disabled:e.scratchPaint.mode===E.BRUSH||e.scratchPaint.mode===E.TEXT||e.scratchPaint.mode===E.FILL,format:e.scratchPaint.format,isEyeDropping:e.scratchPaint.color.eyeDropper.active,strokeColor:e.scratchPaint.color.strokeColor,strokeColorModalVisible:e.scratchPaint.modals.strokeColor,textEditTarget:e.scratchPaint.textEditTarget}),e=>({onChangeStrokeColor:t=>{e(ya(t))},onChangeStrokeWidth:t=>{e(xa(t))},onOpenStrokeColor:()=>{e(ss("strokeColor"))},onCloseStrokeColor:()=>{e(as("strokeColor"))}}))(uc);const fc=ol(ar),gc=e=>h.a.createElement(ea,{disabled:e.disabled},h.a.createElement(fc,{range:!0,small:!0,disabled:e.disabled,max:100,min:"0",type:"number",value:e.strokeWidth?e.strokeWidth:0,onSubmit:e.onChangeStrokeWidth}));gc.propTypes={disabled:a.a.bool.isRequired,onChangeStrokeWidth:a.a.func.isRequired,strokeWidth:a.a.number};var bc=gc;class vc extends h.a.Component{constructor(e){super(e),b()(this,["handleChangeStrokeWidth"])}handleChangeStrokeWidth(e){let t=Uo(e,this.props.textEditTarget);if((!this.props.strokeWidth||0===this.props.strokeWidth)&&e>0){let e=zo(ce(),I(this.props.format)).strokeColor;null===e?(t=No("#000",I(this.props.format),this.props.textEditTarget)||t,e="#000"):e!==Ro&&(e=xo()(e).hex),this.props.onChangeStrokeColor(e)}this.props.onChangeStrokeWidth(e),t&&this.props.onUpdateImage()}render(){return h.a.createElement(bc,{disabled:this.props.disabled,strokeWidth:this.props.strokeWidth,onChangeStrokeWidth:this.handleChangeStrokeWidth})}}vc.propTypes={disabled:a.a.bool.isRequired,format:a.a.oneOf(Object.keys(S)),onChangeStrokeColor:a.a.func.isRequired,onChangeStrokeWidth:a.a.func.isRequired,onUpdateImage:a.a.func.isRequired,strokeWidth:a.a.number,textEditTarget:a.a.number};var wc=Object(p.connect)(e=>({disabled:e.scratchPaint.mode===E.BRUSH||e.scratchPaint.mode===E.TEXT||e.scratchPaint.mode===E.FILL,format:e.scratchPaint.format,strokeWidth:e.scratchPaint.color.strokeWidth,textEditTarget:e.scratchPaint.textEditTarget}),e=>({onChangeStrokeColor:t=>{e(ya(t))},onChangeStrokeWidth:t=>{e(xa(t))}}))(vc);class Sc extends i.a.Tool{static get TOLERANCE(){return 2}static get TEXT_EDIT_MODE(){return"TEXT_EDIT_MODE"}static get SELECT_MODE(){return"SELECT_MODE"}static get DOUBLE_CLICK_MILLIS(){return 250}static get TYPING_TIMEOUT_MILLIS(){return 1e3}static get TEXT_PADDING(){return 8}constructor(e,t,o,n,i,s,a,r){super(),this.element=e,this.setSelectedItems=t,this.clearSelectedItems=o,this.onUpdateImage=i,this.setTextEditTarget=s,this.changeFont=a;const l=r?E.BIT_TEXT:E.TEXT;this.boundingBoxTool=new zn(l,t,o,n,i),this.nudgeTool=new Hn(l,this.boundingBoxTool,i),this.isBitmap=r,this.onMouseDown=this.handleMouseDown,this.onMouseDrag=this.handleMouseDrag,this.onMouseUp=this.handleMouseUp,this.onMouseMove=this.handleMouseMove,this.onKeyUp=this.handleKeyUp,this.onKeyDown=this.handleKeyDown,this.textBox=null,this.guide=null,this.colorState=null,this.mode=null,this.active=!1,this.lastTypeEvent=null,this.lastEvent=null}getBoundingBoxHitOptions(){return{segments:!0,stroke:!0,curves:!0,fill:!0,guide:!1,match:e=>e.item.data&&(e.item.data.isScaleHandle||e.item.data.isRotHandle)||e.item.selected,tolerance:Sc.TOLERANCE/i.a.view.zoom}}getTextEditHitOptions(){return{class:i.a.PointText,segments:!0,stroke:!0,curves:!0,fill:!0,guide:!1,match:e=>e.item&&!(e.item.data&&e.item.data.isHelperItem)&&!e.item.selected,tolerance:Sc.TOLERANCE/i.a.view.zoom}}onSelectionChanged(e){this.boundingBoxTool.onSelectionChanged(e),(!this.textBox||!this.textBox.parent)&&e&&1===e.length&&e[0]instanceof i.a.PointText&&(this.textBox=e[0],this.mode=Sc.SELECT_MODE)}setFont(e){this.font=e,this.textBox&&(this.textBox.font=e);const t=ce();for(const o of t)o instanceof i.a.PointText&&(o.font=e);this.element.style.fontFamily=e,this.setSelectedItems()}onTextEditCancelled(){this.mode===Sc.TEXT_EDIT_MODE&&(this.endTextEdit(),this.beginSelect())}onViewBoundsChanged(e){this.mode===Sc.TEXT_EDIT_MODE&&this.calculateMatrix(e)}calculateMatrix(e){const t=this.textBox.matrix,o=new i.a.Matrix;let n=0;this.rtl&&this.element.parentElement&&(n=-this.element.parentElement.clientWidth),this.element.style.transformOrigin=`${-this.textBox.internalBounds.x}px ${-this.textBox.internalBounds.y}px`,o.translate(n,this.textBox.internalBounds.y),o.append(e),o.append(t),this.element.style.transform=`matrix(${o.a}, ${o.b}, ${o.c}, ${o.d},\n             ${o.tx}, ${o.ty})`}setColorState(e){this.colorState=e}setRtl(e){this.rtl=e}handleMouseMove(e){i.a.project.hitTestAll(e.point,this.getTextEditHitOptions()).length?document.body.style.cursor="text":document.body.style.cursor="auto",this.boundingBoxTool.onMouseMove(e,this.getBoundingBoxHitOptions())}handleMouseDown(e){if(e.event.button>0)return;this.active=!0;const t=this.lastEvent&&e.event.timeStamp-this.lastEvent.event.timeStamp<Sc.DOUBLE_CLICK_MILLIS;if(this.lastEvent=e,t&&this.mode===Sc.SELECT_MODE&&this.textBox.hitTest(e.point))return this.endSelect(),this.beginTextEdit(this.textBox),void this.element.select();if(this.boundingBoxTool.onMouseDown(e,!1,!1,!1,this.getBoundingBoxHitOptions()))return;const o=this.mode;this.mode===Sc.SELECT_MODE?(this.endSelect(),this.isBitmap&&this.commitText()):this.mode===Sc.TEXT_EDIT_MODE&&this.endTextEdit();const n=i.a.project.hitTestAll(e.point,this.getTextEditHitOptions());n.length?this.beginTextEdit(n[0].item):o===Sc.TEXT_EDIT_MODE?this.beginSelect():(this.textBox=new i.a.PointText({point:e.point,content:"",font:this.font,fontSize:40,fillColor:this.colorState.fillColor,leading:46.15}),this.beginTextEdit(this.textBox))}handleMouseDrag(e){e.event.button>0||!this.active||this.mode!==Sc.SELECT_MODE||this.boundingBoxTool.onMouseDrag(e)}handleMouseUp(e){if(!(e.event.button>0)&&this.active)return this.mode===Sc.SELECT_MODE?(this.boundingBoxTool.onMouseUp(e),void(this.isBoundingBoxMode=null)):void(this.active=!1)}handleKeyUp(e){e.event.target instanceof HTMLInputElement||this.mode===Sc.SELECT_MODE&&this.nudgeTool.onKeyUp(e)}handleKeyDown(e){e.event.target instanceof HTMLInputElement||(this.mode===Sc.TEXT_EDIT_MODE&&"escape"===e.key&&this.endTextEdit(),this.mode===Sc.SELECT_MODE&&this.nudgeTool.onKeyDown(e))}handleTextInput(e){this.lastTypeEvent&&e.timeStamp-this.lastTypeEvent.timeStamp>Sc.TYPING_TIMEOUT_MILLIS&&(this.textBox.selected=!0,this.onUpdateImage(),this.textBox.selected=!1),this.lastTypeEvent=e,this.mode===Sc.TEXT_EDIT_MODE&&(this.textBox.content=this.element.value),this.resizeGuide()}resizeGuide(){this.guide&&this.guide.remove(),this.guide=Se(this.textBox,Sc.TEXT_PADDING),this.guide.dashArray=[4,4],this.element.style.width=`${this.textBox.internalBounds.width+1}px`,this.element.style.height=`${this.textBox.internalBounds.height}px`,this.rtl&&(this.element.style.transformOrigin=`${-this.textBox.internalBounds.x}px ${-this.textBox.internalBounds.y}px`)}beginSelect(){this.textBox&&(this.mode=Sc.SELECT_MODE,this.textBox.selected=!0,this.setSelectedItems())}endSelect(){re(this.clearSelectedItems),this.mode=null}beginTextEdit(e){this.textBox=e,this.mode=Sc.TEXT_EDIT_MODE,this.setTextEditTarget(this.textBox.id),this.font!==this.textBox.font&&this.changeFont(this.textBox.font),this.element.style.fontSize=`${this.textBox.fontSize}px`,this.element.style.lineHeight=this.textBox.leading/this.textBox.fontSize,this.element.style.display="initial",this.element.value=e.content?e.content:"",this.calculateMatrix(i.a.view.matrix),this.rtl?this.textBox.justification="right":this.textBox.justification="left",this.element.focus({preventScroll:!0}),this.eventListener=this.handleTextInput.bind(this),this.element.addEventListener("input",this.eventListener),this.resizeGuide()}endTextEdit(){this.mode===Sc.TEXT_EDIT_MODE&&(this.mode=null,this.textBox&&""===this.textBox.content.trim()&&(this.textBox.remove(),this.textBox=null),this.guide&&(this.guide.remove(),this.guide=null,this.setTextEditTarget()),this.element.style.display="none",this.eventListener&&(this.element.removeEventListener("input",this.eventListener),this.eventListener=null),this.textBox&&this.lastTypeEvent&&(this.textBox.selected=!0,this.onUpdateImage(),this.textBox.selected=!1,this.lastTypeEvent=null))}commitText(){if(!this.textBox||!this.textBox.parent)return;const e=this.textBox.rasterize(72,!1,this.textBox.drawnBounds);this.textBox.remove(),this.textBox=null,yt().drawImage(e.canvas,new i.a.Point(Math.floor(e.bounds.x),Math.floor(e.bounds.y))),this.onUpdateImage()}deactivateTool(){this.textBox&&""===this.textBox.content.trim()&&(this.textBox.remove(),this.textBox=null),this.endTextEdit(),this.isBitmap&&this.commitText(),this.boundingBoxTool.deactivateTool()}}var Cc=Sc,Ic=o(964),xc=o.n(Ic);const Tc=e=>h.a.createElement(an,{imgDescriptor:rn.text,imgSrc:xc.a,isSelected:e.isSelected,onMouseDown:e.onMouseDown});Tc.propTypes={isSelected:a.a.bool.isRequired,onMouseDown:a.a.func.isRequired};var yc=Tc,Mc=o(965),Ec=o.n(Mc);const Rc=e=>h.a.createElement(an,{imgDescriptor:rn.text,imgSrc:Ec.a,isSelected:e.isSelected,onMouseDown:e.onMouseDown});Rc.propTypes={isSelected:a.a.bool.isRequired,onMouseDown:a.a.func.isRequired};var kc=Rc;class Oc extends h.a.Component{constructor(e){super(e),b()(this,["activateTool","deactivateTool"])}componentDidMount(){this.props.isTextModeActive&&this.activateTool(this.props)}componentWillReceiveProps(e){this.tool&&(e.colorState!==this.props.colorState&&this.tool.setColorState(e.colorState),e.selectedItems!==this.props.selectedItems&&this.tool.onSelectionChanged(e.selectedItems),!e.textEditTarget&&this.props.textEditTarget&&this.tool.onTextEditCancelled(),e.viewBounds.equals(this.props.viewBounds)||this.tool.onViewBoundsChanged(e.viewBounds),e.font!==this.props.font&&this.tool.setFont(e.font),e.rtl!==this.props.rtl&&this.tool.setRtl(e.rtl)),e.isTextModeActive&&!this.props.isTextModeActive?this.activateTool(e):!e.isTextModeActive&&this.props.isTextModeActive&&this.deactivateTool()}shouldComponentUpdate(e){return e.isTextModeActive!==this.props.isTextModeActive}componentWillUnmount(){this.tool&&this.deactivateTool()}activateTool(e){const t=ce();let o=null;1===t.length&&t[0]instanceof i.a.PointText&&(o=t[0]),re(this.props.clearSelectedItems),this.props.clearGradient();const{fillColor:n,strokeColor:s,strokeWidth:a}=e.colorState,r=n!==Ro&&null!==n,l=!e.isBitmap&&(s!==Ro&&null!==s&&null!==a&&0!==a);r||l?!r&&l?this.props.onChangeFillColor(null):r&&!l&&this.props.onChangeStrokeColor(null):(this.props.onChangeFillColor(To),this.props.onChangeStrokeColor(null)),(!e.font||Object.keys(Wr).map(e=>Wr[e]).indexOf(e.font)<0)&&this.props.changeFont(Wr.SANS_SERIF),this.tool=new Cc(this.props.textArea,this.props.setSelectedItems,this.props.clearSelectedItems,this.props.setCursor,this.props.onUpdateImage,this.props.setTextEditTarget,this.props.changeFont,e.isBitmap),this.tool.setRtl(this.props.rtl),this.tool.setColorState(e.colorState),this.tool.setFont(e.font),this.tool.activate(),o&&(this.tool.beginTextEdit(o),this.props.textArea.select())}deactivateTool(){this.tool.deactivateTool(),this.tool.remove(),this.tool=null}render(){return this.props.isBitmap?h.a.createElement(kc,{isSelected:this.props.isTextModeActive,onMouseDown:this.props.handleChangeModeBitText}):h.a.createElement(yc,{isSelected:this.props.isTextModeActive,onMouseDown:this.props.handleChangeModeText})}}Oc.propTypes={changeFont:a.a.func.isRequired,clearGradient:a.a.func.isRequired,clearSelectedItems:a.a.func.isRequired,colorState:a.a.shape({fillColor:a.a.string,strokeColor:a.a.string,strokeWidth:a.a.number}).isRequired,font:a.a.string,handleChangeModeBitText:a.a.func.isRequired,handleChangeModeText:a.a.func.isRequired,isBitmap:a.a.bool,isTextModeActive:a.a.bool.isRequired,onChangeFillColor:a.a.func.isRequired,onChangeStrokeColor:a.a.func.isRequired,onUpdateImage:a.a.func.isRequired,rtl:a.a.bool,selectedItems:a.a.arrayOf(a.a.instanceOf(i.a.Item)),setCursor:a.a.func.isRequired,setSelectedItems:a.a.func.isRequired,setTextEditTarget:a.a.func.isRequired,textArea:a.a.instanceOf(Element),textEditTarget:a.a.number,viewBounds:a.a.instanceOf(i.a.Matrix).isRequired};var Dc=Object(p.connect)((e,t)=>({colorState:e.scratchPaint.color,font:e.scratchPaint.font,isTextModeActive:t.isBitmap?e.scratchPaint.mode===E.BIT_TEXT:e.scratchPaint.mode===E.TEXT,rtl:e.scratchPaint.layout.rtl,selectedItems:e.scratchPaint.selectedItems,textEditTarget:e.scratchPaint.textEditTarget,viewBounds:e.scratchPaint.viewBounds}),(e,t)=>({changeFont:t=>{e(Jr(t))},clearSelectedItems:()=>{e(Qt())},clearGradient:()=>{e(Yo())},handleChangeModeBitText:()=>{e(Vo(E.BIT_TEXT))},handleChangeModeText:()=>{e(Vo(E.TEXT))},setCursor:t=>{e(On(t))},setSelectedItems:()=>{e(Jt(ce(),t.isBitmap))},setTextEditTarget:t=>{e(Pr(t))},onChangeFillColor:t=>{e(Eo(t))},onChangeStrokeColor:t=>{e(ya(t))}}))(Oc),Pc=o(966),_c=o.n(Pc),Lc=o(968),Bc=o.n(Lc),Ac=o(969),Nc=o.n(Ac),Uc=o(970),zc=o.n(Uc),Fc=o(971),Hc=o.n(Fc);const qc=Object(f.defineMessages)({bitmap:{defaultMessage:"Convert to Bitmap",description:"Label for button that converts the paint editor to bitmap mode",id:"paint.paintEditor.bitmap"},vector:{defaultMessage:"Convert to Vector",description:"Label for button that converts the paint editor to vector mode",id:"paint.paintEditor.vector"}}),Gc=e=>h.a.createElement("div",{className:_c.a.editorContainer,dir:e.rtl?"rtl":"ltr"},null!==e.canvas?h.a.createElement("div",{className:_c.a.editorContainerTop},h.a.createElement("div",{className:_c.a.row},h.a.createElement(Ur,{canRedo:e.canRedo,canUndo:e.canUndo,name:e.name,onRedo:e.onRedo,onUndo:e.onUndo,onUpdateImage:e.onUpdateImage,onUpdateName:e.onUpdateName})),C(e.format)?h.a.createElement("div",{className:_c.a.row},h.a.createElement(ea,{className:m()(_c.a.row,_c.a.modDashedBorder,_c.a.modLabeledIconHeight)},h.a.createElement(da,{className:_c.a.modMarginAfter,onUpdateImage:e.onUpdateImage}),h.a.createElement(mc,{onUpdateImage:e.onUpdateImage}),h.a.createElement(wc,{onUpdateImage:e.onUpdateImage})),h.a.createElement(ea,{className:_c.a.modModeTools},h.a.createElement(El,{onUpdateImage:e.onUpdateImage}))):I(e.format)?h.a.createElement("div",{className:_c.a.row},h.a.createElement(ea,{className:m()(_c.a.row,_c.a.modDashedBorder,_c.a.modLabeledIconHeight)},h.a.createElement(da,{className:_c.a.modMarginAfter,onUpdateImage:e.onUpdateImage})),h.a.createElement(ea,{className:_c.a.modModeTools},h.a.createElement(El,{onUpdateImage:e.onUpdateImage}))):null):null,h.a.createElement("div",{className:_c.a.topAlignRow},null!==e.canvas&&C(e.format)?h.a.createElement("div",{className:_c.a.modeSelector},h.a.createElement(lc,{onUpdateImage:e.onUpdateImage}),h.a.createElement(ec,{onUpdateImage:e.onUpdateImage}),h.a.createElement(Ki,{onUpdateImage:e.onUpdateImage}),h.a.createElement(ts,{onUpdateImage:e.onUpdateImage}),h.a.createElement(wa,{onUpdateImage:e.onUpdateImage}),h.a.createElement(Dc,{textArea:e.textArea,onUpdateImage:e.onUpdateImage}),h.a.createElement(Da,{onUpdateImage:e.onUpdateImage}),h.a.createElement(Bl,{onUpdateImage:e.onUpdateImage}),h.a.createElement(Gl,{onUpdateImage:e.onUpdateImage})):null,null!==e.canvas&&I(e.format)?h.a.createElement("div",{className:_c.a.modeSelector},h.a.createElement(fn,{onUpdateImage:e.onUpdateImage}),h.a.createElement(xn,{onUpdateImage:e.onUpdateImage}),h.a.createElement($n,{onUpdateImage:e.onUpdateImage}),h.a.createElement(ni,{onUpdateImage:e.onUpdateImage}),h.a.createElement(Dc,{isBitmap:!0,textArea:e.textArea,onUpdateImage:e.onUpdateImage}),h.a.createElement(mi,{onUpdateImage:e.onUpdateImage}),h.a.createElement(Si,{onUpdateImage:e.onUpdateImage}),h.a.createElement(ki,{onUpdateImage:e.onUpdateImage})):null,h.a.createElement("div",{className:_c.a.controlsContainer},h.a.createElement(So,{canvas:e.canvas,hideScrollbars:e.isEyeDropping,style:_c.a.canvasContainer},h.a.createElement(uo,{canvasRef:e.setCanvas,image:e.image,imageFormat:e.imageFormat,imageId:e.imageId,rotationCenterX:e.rotationCenterX,rotationCenterY:e.rotationCenterY,zoomLevelId:e.zoomLevelId,onUpdateImage:e.onUpdateImage}),h.a.createElement("textarea",{className:_c.a.textArea,ref:e.setTextArea,spellCheck:!1}),e.isEyeDropping&&null!==e.colorInfo&&!e.colorInfo.hideLoupe?h.a.createElement(_i,{className:_c.a.colorPickerWrapper},h.a.createElement(za,{colorInfo:e.colorInfo,pixelRatio:i.a.project.view.pixelRatio})):null),h.a.createElement("div",{className:_c.a.canvasControls},C(e.format)?h.a.createElement(tn,{className:_c.a.bitmapButton,onClick:e.onSwitchToBitmap},h.a.createElement("img",{className:_c.a.bitmapButtonIcon,draggable:!1,src:Bc.a}),h.a.createElement("span",{className:_c.a.buttonText},e.intl.formatMessage(qc.bitmap))):I(e.format)?h.a.createElement(tn,{className:_c.a.bitmapButton,onClick:e.onSwitchToVector},h.a.createElement("img",{className:_c.a.bitmapButtonIcon,draggable:!1,src:Bc.a}),h.a.createElement("span",{className:_c.a.buttonText},e.intl.formatMessage(qc.vector))):null,h.a.createElement(ea,{className:_c.a.zoomControls},h.a.createElement(Ni,null,h.a.createElement(tn,{className:_c.a.buttonGroupButton,onClick:e.onZoomOut},h.a.createElement("img",{alt:"Zoom Out",className:_c.a.buttonGroupButtonIcon,draggable:!1,src:zc.a})),h.a.createElement(tn,{className:_c.a.buttonGroupButton,onClick:e.onZoomReset},h.a.createElement("img",{alt:"Zoom Reset",className:_c.a.buttonGroupButtonIcon,draggable:!1,src:Hc.a})),h.a.createElement(tn,{className:_c.a.buttonGroupButton,onClick:e.onZoomIn},h.a.createElement("img",{alt:"Zoom In",className:_c.a.buttonGroupButtonIcon,draggable:!1,src:Nc.a}))))))));Gc.propTypes={canRedo:a.a.func.isRequired,canUndo:a.a.func.isRequired,canvas:a.a.instanceOf(Element),colorInfo:za.propTypes.colorInfo,format:a.a.oneOf(Object.keys(S)),image:a.a.oneOfType([a.a.string,a.a.instanceOf(HTMLImageElement)]),imageFormat:a.a.string,imageId:a.a.string,intl:f.intlShape,isEyeDropping:a.a.bool,name:a.a.string,onRedo:a.a.func.isRequired,onSwitchToBitmap:a.a.func.isRequired,onSwitchToVector:a.a.func.isRequired,onUndo:a.a.func.isRequired,onUpdateImage:a.a.func.isRequired,onUpdateName:a.a.func.isRequired,onZoomIn:a.a.func.isRequired,onZoomOut:a.a.func.isRequired,onZoomReset:a.a.func.isRequired,rotationCenterX:a.a.number,rotationCenterY:a.a.number,rtl:a.a.bool,setCanvas:a.a.func.isRequired,setTextArea:a.a.func.isRequired,textArea:a.a.instanceOf(Element),zoomLevelId:a.a.string};var jc=Object(f.injectIntl)(Gc);function Vc(){return(Vc=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e}).apply(this,arguments)}var Wc=function(e){class t extends h.a.Component{constructor(e){super(e),b()(this,["handleKeyPress","changeToASelectMode","selectAll"])}handleKeyPress(e){e.target instanceof HTMLInputElement||this.props.textEditing||("Escape"===e.key?(e.preventDefault(),re(this.props.clearSelectedItems)):"Delete"===e.key||"Backspace"===e.key?(e.preventDefault(),pe(this.props.mode,this.props.onUpdateImage)&&this.props.setSelectedItems(this.props.format)):(e.metaKey||e.ctrlKey)&&(e.shiftKey&&"z"===e.key.toLowerCase()?this.props.onRedo():"z"===e.key?this.props.onUndo():"c"===e.key?this.props.onCopyToClipboard():"v"===e.key?(this.changeToASelectMode(),this.props.onPasteFromClipboard()):"a"===e.key&&(this.changeToASelectMode(),e.preventDefault(),this.selectAll())))}changeToASelectMode(){I(this.props.format)?this.props.mode!==E.BIT_SELECT&&this.props.changeMode(E.BIT_SELECT):this.props.mode!==E.SELECT&&this.props.mode!==E.RESHAPE&&this.props.changeMode(E.SELECT)}selectAll(){I(this.props.format)?(Qe(this.props.clearSelectedItems),this.props.setSelectedItems(this.props.format)):this.props.mode===E.RESHAPE?ae()&&this.props.setSelectedItems(this.props.format):se()&&this.props.setSelectedItems(this.props.format)}render(){const t=Fr()(this.props,["changeMode","clearSelectedItems","format","mode","onCopyToClipboard","onPasteFromClipboard","setSelectedItems","textEditing"]);return h.a.createElement(e,Vc({onKeyPress:this.handleKeyPress},t))}}t.propTypes={changeMode:a.a.func.isRequired,clearSelectedItems:a.a.func.isRequired,format:a.a.oneOf(Object.keys(S)),mode:a.a.oneOf(Object.keys(E)).isRequired,onCopyToClipboard:a.a.func.isRequired,onPasteFromClipboard:a.a.func.isRequired,onRedo:a.a.func.isRequired,onUndo:a.a.func.isRequired,onUpdateImage:a.a.func.isRequired,setSelectedItems:a.a.func.isRequired,textEditing:a.a.bool.isRequired};return qr(Object(p.connect)(e=>({mode:e.scratchPaint.mode,format:e.scratchPaint.format,textEditing:null!==e.scratchPaint.textEditTarget}),e=>({changeMode:t=>{e(Vo(t))},clearSelectedItems:()=>{e(Qt())},setSelectedItems:t=>{e(Jt(ce(),I(t)))}}))(t))};var Kc=function(e){class t extends h.a.Component{constructor(e){super(e),b()(this,["removeItemById"])}componentDidUpdate(e){(this.props.hoveredItemId&&this.props.hoveredItemId!==e.hoveredItemId||!this.props.hoveredItemId&&e.hoveredItemId)&&this.removeItemById(e.hoveredItemId)}removeItemById(e){if(e){const t=i.a.project.getItem({match:t=>t.id===e});t&&t.remove()}}render(){const{hoveredItemId:t,...o}=this.props;return h.a.createElement(e,o)}}t.propTypes={hoveredItemId:a.a.number};return Object(p.connect)(e=>({hoveredItemId:e.scratchPaint.hoveredItemId}))(t)};function Xc(){return(Xc=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e}).apply(this,arguments)}var $c=function(e){class t extends h.a.Component{constructor(e){super(e),b()(this,["handleUndo","handleRedo","handleSetSelectedItems","shouldShowUndo","shouldShowRedo"])}handleUndo(){Ft(this.props.undoState,this.props.onUndo,this.handleSetSelectedItems,this.props.onUpdateImage)}handleRedo(){Ht(this.props.undoState,this.props.onRedo,this.handleSetSelectedItems,this.props.onUpdateImage)}handleSetSelectedItems(){this.props.setSelectedItems(this.props.format)}shouldShowUndo(){return qt(this.props.undoState)}shouldShowRedo(){return Gt(this.props.undoState)}render(){const t=Fr()(this.props,["format","onUndo","onRedo","setSelectedItems","undoState"]);return h.a.createElement(e,Xc({shouldShowRedo:this.shouldShowRedo,shouldShowUndo:this.shouldShowUndo,onRedo:this.handleRedo,onUndo:this.handleUndo},t))}}t.propTypes={format:a.a.oneOf(Object.keys(S)),onRedo:a.a.func.isRequired,onUndo:a.a.func.isRequired,onUpdateImage:a.a.func.isRequired,setSelectedItems:a.a.func.isRequired,undoState:a.a.shape({stack:a.a.arrayOf(a.a.object).isRequired,pointer:a.a.number.isRequired})};return Object(p.connect)(e=>({format:e.scratchPaint.format,undoState:e.scratchPaint.undo}),e=>({setSelectedItems:t=>{e(Jt(ce(),I(t)))},onUndo:t=>{e(function(e){return{type:jt,format:e}}(t))},onRedo:t=>{e(function(e){return{type:Vt,format:e}}(t))}}))(t)};function Yc(){return(Yc=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e}).apply(this,arguments)}var Zc=function(e){class t extends h.a.Component{constructor(e){super(e),b()(this,["handleUpdateImage","handleUpdateBitmap","handleUpdateVector"])}handleUpdateImage(e,t){const o=t||(M[this.props.mode]?S.BITMAP:S.VECTOR);I(o)?this.handleUpdateBitmap(e):C(o)&&this.handleUpdateVector(e),dt(),this.props.updateViewBounds(i.a.view.matrix)}handleUpdateBitmap(e){if(!yt().loaded)return void c.warn("Bitmap layer should be loaded before calling updateImage.");const t=yt().getSubRaster(yt().bounds);t.remove();const o=ce();if(1===o.length){const e=o[0];if(e instanceof i.a.Raster){if(!e.loaded||e.data&&e.data.expanded&&!e.data.expanded.loaded)return void c.warn("Bitmap layer should be loaded before calling updateImage.");Ye(e,t)}else if(e instanceof i.a.Shape&&"rectangle"===e.type)Je(e,t);else if(e instanceof i.a.Shape&&"ellipse"===e.type)Ze(e,t);else if(e instanceof i.a.PointText){const o=e.drawnBounds,n=e.rasterize(72,!1,o);t.drawImage(n.canvas,new i.a.Point(Math.floor(o.x),Math.floor(o.y)))}}const n=Be(t);0!==n.width&&0!==n.height||(n.width=n.height=1);const s=t.getImageData(n);this.props.onUpdateImage(!1,s,ot/2-n.x,nt/2-n.y),e||Ut(this.props.undoSnapshot,S.BITMAP)}handleUpdateVector(e){let t;if(i.a.project.activeLayer.clipped){for(const e of i.a.project.activeLayer.children)if(e.isClipMask()){t=e;break}i.a.project.activeLayer.clipped=!1,t.remove()}const o=_t(!0);Z(i.a.project.activeLayer,.5,new i.a.Point);const n=i.a.project.activeLayer.drawnBounds,s=0===n.width?0:et/2-n.x,a=0===n.height?0:tt/2-n.y;this.props.onUpdateImage(!0,i.a.project.exportSVG({asString:!0,bounds:"content",matrix:(new i.a.Matrix).translate(-n.x,-n.y)}),s,a),Z(i.a.project.activeLayer,2,new i.a.Point),i.a.project.activeLayer.applyMatrix=!0,Lt(o),t&&(i.a.project.activeLayer.addChild(t),t.clipMask=!0),e||Ut(this.props.undoSnapshot,S.VECTOR)}render(){const t=Fr()(this.props,["format","onUpdateImage","undoSnapshot"]);return h.a.createElement(e,Yc({onUpdateImage:this.handleUpdateImage},t))}}t.propTypes={format:a.a.oneOf(Object.keys(S)),mode:a.a.oneOf(Object.keys(E)).isRequired,onUpdateImage:a.a.func.isRequired,undoSnapshot:a.a.func.isRequired,updateViewBounds:a.a.func.isRequired};return Object(p.connect)(e=>({format:e.scratchPaint.format,mode:e.scratchPaint.mode,undoState:e.scratchPaint.undo}),e=>({setSelectedItems:t=>{e(Jt(ce(),I(t)))},undoSnapshot:t=>{e($t(t))},updateViewBounds:t=>{e(ro(t))}}))(t)};class Jc extends h.a.Component{static get ZOOM_INCREMENT(){return.5}constructor(e){super(e),b()(this,["switchModeForFormat","onMouseDown","onMouseUp","setCanvas","setTextArea","startEyeDroppingLoop","stopEyeDroppingLoop","handleSetSelectedItems","handleZoomIn","handleZoomOut","handleZoomReset"]),this.state={canvas:null,colorInfo:null},this.props.setLayout(this.props.rtl?"rtl":"ltr")}componentDidMount(){document.addEventListener("keydown",this.props.onKeyPress),document.addEventListener("mousedown",this.onMouseDown),document.addEventListener("touchstart",this.onMouseDown),document.addEventListener("mouseup",this.onMouseUp),document.addEventListener("touchend",this.onMouseUp)}componentWillReceiveProps(e){!I(this.props.format)&&I(e.format)?this.switchModeForFormat(S.BITMAP):!C(this.props.format)&&C(e.format)&&this.switchModeForFormat(S.VECTOR),e.rtl!==this.props.rtl&&this.props.setLayout(e.rtl?"rtl":"ltr")}componentDidUpdate(e){this.props.isEyeDropping&&!e.isEyeDropping?this.startEyeDroppingLoop():!this.props.isEyeDropping&&e.isEyeDropping?this.stopEyeDroppingLoop():this.props.isEyeDropping&&this.props.viewBounds!==e.viewBounds&&(this.props.previousTool&&this.props.previousTool.activate(),this.props.onDeactivateEyeDropper(),this.stopEyeDroppingLoop()),this.props.format===S.VECTOR&&I(e.format)?Ue(this.props.clearSelectedItems,this.props.onUpdateImage):C(e.format)&&this.props.format===S.BITMAP&&Ne(this.props.clearSelectedItems,this.props.onUpdateImage)}componentWillUnmount(){document.removeEventListener("keydown",this.props.onKeyPress),this.stopEyeDroppingLoop(),document.removeEventListener("mousedown",this.onMouseDown),document.removeEventListener("touchstart",this.onMouseDown),document.removeEventListener("mouseup",this.onMouseUp),document.removeEventListener("touchend",this.onMouseUp)}switchModeForFormat(e){if(!(C(e)&&this.props.mode in y||I(e)&&this.props.mode in M))if(C(e))switch(this.props.mode){case E.BIT_BRUSH:this.props.changeMode(E.BRUSH);break;case E.BIT_LINE:this.props.changeMode(E.LINE);break;case E.BIT_OVAL:this.props.changeMode(E.OVAL);break;case E.BIT_RECT:this.props.changeMode(E.RECT);break;case E.BIT_TEXT:this.props.changeMode(E.TEXT);break;case E.BIT_FILL:this.props.changeMode(E.FILL);break;case E.BIT_ERASER:this.props.changeMode(E.ERASER);break;case E.BIT_SELECT:this.props.changeMode(E.SELECT);break;default:c.error(`Mode not handled: ${this.props.mode}`),this.props.changeMode(E.BRUSH)}else if(I(e))switch(this.props.mode){case E.BRUSH:this.props.changeMode(E.BIT_BRUSH);break;case E.LINE:this.props.changeMode(E.BIT_LINE);break;case E.OVAL:this.props.changeMode(E.BIT_OVAL);break;case E.RECT:this.props.changeMode(E.BIT_RECT);break;case E.TEXT:this.props.changeMode(E.BIT_TEXT);break;case E.FILL:this.props.changeMode(E.BIT_FILL);break;case E.ERASER:this.props.changeMode(E.BIT_ERASER);break;case E.RESHAPE:case E.SELECT:this.props.changeMode(E.BIT_SELECT);break;default:c.error(`Mode not handled: ${this.props.mode}`),this.props.changeMode(E.BIT_BRUSH)}}handleZoomIn(){let e=Jc.ZOOM_INCREMENT;i.a.view.zoom===st&&(e=.5-st),mt(e),this.props.updateViewBounds(i.a.view.matrix),this.handleSetSelectedItems()}handleZoomOut(){mt(-Jc.ZOOM_INCREMENT),this.props.updateViewBounds(i.a.view.matrix),this.handleSetSelectedItems()}handleZoomReset(){ft(),this.props.updateViewBounds(i.a.view.matrix),this.handleSetSelectedItems()}handleSetSelectedItems(){this.props.setSelectedItems(this.props.format)}setCanvas(e){this.setState({canvas:e}),this.canvas=e}setTextArea(e){this.setState({textArea:e})}onMouseDown(e){e.target===i.a.view.element&&document.activeElement instanceof HTMLInputElement&&document.activeElement.blur(),e.target!==i.a.view.element&&e.target!==this.state.textArea&&this.props.removeTextEditTarget()}onMouseUp(){if(this.props.isEyeDropping){const e=this.eyeDropper.colorString,t=this.props.changeColorToEyeDropper;this.eyeDropper.remove(),this.eyeDropper.hideLoupe||t(e),this.props.previousTool&&this.props.previousTool.activate(),this.props.onDeactivateEyeDropper(),this.stopEyeDroppingLoop()}}startEyeDroppingLoop(){this.eyeDropper=new La(this.canvas,i.a.project.view.bounds.width,i.a.project.view.bounds.height,i.a.project.view.pixelRatio,i.a.view.zoom,i.a.project.view.bounds.x,i.a.project.view.bounds.y,I(this.props.format)),this.eyeDropper.pickX=-1,this.eyeDropper.pickY=-1,this.eyeDropper.activate(),this.intervalId=setInterval(()=>{const e=this.eyeDropper.getColorInfo(this.eyeDropper.pickX,this.eyeDropper.pickY,this.eyeDropper.hideLoupe);e&&(null!==this.state.colorInfo&&this.state.colorInfo.x===e.x&&this.state.colorInfo.y===e.y||this.setState({colorInfo:e}))},30)}stopEyeDroppingLoop(){clearInterval(this.intervalId),this.setState({colorInfo:null})}render(){return h.a.createElement(jc,{canRedo:this.props.shouldShowRedo,canUndo:this.props.shouldShowUndo,canvas:this.state.canvas,colorInfo:this.state.colorInfo,format:this.props.format,image:this.props.image,imageFormat:this.props.imageFormat,imageId:this.props.imageId,isEyeDropping:this.props.isEyeDropping,name:this.props.name,rotationCenterX:this.props.rotationCenterX,rotationCenterY:this.props.rotationCenterY,rtl:this.props.rtl,setCanvas:this.setCanvas,setTextArea:this.setTextArea,textArea:this.state.textArea,zoomLevelId:this.props.zoomLevelId,onRedo:this.props.onRedo,onSwitchToBitmap:this.props.handleSwitchToBitmap,onSwitchToVector:this.props.handleSwitchToVector,onUndo:this.props.onUndo,onUpdateImage:this.props.onUpdateImage,onUpdateName:this.props.onUpdateName,onZoomIn:this.handleZoomIn,onZoomOut:this.handleZoomOut,onZoomReset:this.handleZoomReset})}}Jc.propTypes={changeColorToEyeDropper:a.a.func,changeMode:a.a.func.isRequired,clearSelectedItems:a.a.func.isRequired,format:a.a.oneOf(Object.keys(S)),handleSwitchToBitmap:a.a.func.isRequired,handleSwitchToVector:a.a.func.isRequired,image:a.a.oneOfType([a.a.string,a.a.instanceOf(HTMLImageElement)]),imageFormat:a.a.string,imageId:a.a.string,isEyeDropping:a.a.bool,mode:a.a.oneOf(Object.keys(E)).isRequired,name:a.a.string,onDeactivateEyeDropper:a.a.func.isRequired,onKeyPress:a.a.func.isRequired,onRedo:a.a.func.isRequired,onUndo:a.a.func.isRequired,onUpdateImage:a.a.func.isRequired,onUpdateName:a.a.func.isRequired,previousTool:a.a.shape({activate:a.a.func.isRequired,remove:a.a.func.isRequired}),removeTextEditTarget:a.a.func.isRequired,rotationCenterX:a.a.number,rotationCenterY:a.a.number,rtl:a.a.bool,setLayout:a.a.func.isRequired,setSelectedItems:a.a.func.isRequired,shouldShowRedo:a.a.func.isRequired,shouldShowUndo:a.a.func.isRequired,updateViewBounds:a.a.func.isRequired,viewBounds:a.a.instanceOf(i.a.Matrix).isRequired,zoomLevelId:a.a.string};var Qc=Zc(Kc($c(Wc(Object(p.connect)(e=>({changeColorToEyeDropper:e.scratchPaint.color.eyeDropper.callback,format:e.scratchPaint.format,isEyeDropping:e.scratchPaint.color.eyeDropper.active,mode:e.scratchPaint.mode,previousTool:e.scratchPaint.color.eyeDropper.previousTool,viewBounds:e.scratchPaint.viewBounds}),e=>({changeMode:t=>{e(Vo(t))},clearSelectedItems:()=>{e(Qt())},handleSwitchToBitmap:()=>{e(so(S.BITMAP))},handleSwitchToVector:()=>{e(so(S.VECTOR))},removeTextEditTarget:()=>{e(Pr())},setLayout:t=>{e(Ar(t))},setSelectedItems:t=>{e(Jt(ce(),I(t)))},onDeactivateEyeDropper:()=>{e(Rn())},updateViewBounds:t=>{e(ro(t))}}))(Jc))))),ed=o(102),td=Object(ed.combineReducers)({eyeDropper:function(e,t){switch(void 0===e&&(e=En),t.type){case yn:return Object.assign({},e,{active:!0,callback:t.callback,previousTool:t.previousMode});case Mn:return Object.assign({},e,{active:!1,callback:()=>{},previousTool:null});default:return e}},fillColor:function(e,t){switch(void 0===e&&(e=yo),t.type){case"scratch-paint/fill-color/CHANGE_FILL_COLOR":return Mo.test(t.fillColor)||null===t.fillColor||t.fillColor===Ro?t.fillColor:(c.warn(`Invalid hex color code: ${t.fillColor}`),e);case Yt:return t.selectedItems&&t.selectedItems.length?zo(t.selectedItems,t.bitmapMode).fillColor:e;default:return e}},fillColor2:function(e,t){switch(void 0===e&&(e=null),t.type){case"scratch-paint/fill-color/CHANGE_FILL_COLOR_2":return li.test(t.fillColor)||null===t.fillColor||t.fillColor===Ro?t.fillColor:(c.warn(`Invalid hex color code: ${t.fillColor}`),e);case Yt:{if(!t.selectedItems||!t.selectedItems.length)return e;const o=zo(t.selectedItems);return o.gradientType===Co.SOLID?o.fillColor2===Ro?Ro:e:o.fillColor2}case Xo:return null;default:return e}},gradientType:function(e,t){switch(void 0===e&&(e=$o),t.type){case Wo:return t.gradientType in Co?t.gradientType:(c.warn(`Gradient type does not exist: ${t.gradientType}`),e);case Xo:return Co.SOLID;case Yt:return t.selectedItems&&t.selectedItems.length?zo(t.selectedItems,t.bitmapMode).gradientType:e;default:return e}},strokeColor:function(e,t){switch(void 0===e&&(e="#000"),t.type){case Ia:return 0===Math.max(0,t.strokeWidth)?null:e;case"scratch-paint/stroke-color/CHANGE_STROKE_COLOR":return Ta.test(t.strokeColor)||null===t.strokeColor||t.strokeColor===Ro?t.strokeColor:(c.warn(`Invalid hex color code: ${t.fillColor}`),e);case Yt:return t.selectedItems&&t.selectedItems.length?t.bitmapMode?e:zo(t.selectedItems,t.bitmapMode).strokeColor:e;default:return e}},strokeWidth:function(e,t){switch(void 0===e&&(e=4),t.type){case Ia:return isNaN(t.strokeWidth)?(c.warn(`Invalid brush size: ${t.strokeWidth}`),e):Math.min(100,Math.max(0,t.strokeWidth));case Yt:return t.selectedItems&&t.selectedItems.length?t.bitmapMode?e:zo(t.selectedItems,t.bitmapMode).strokeWidth:e;default:return e}}}),od=Object(ed.combineReducers)({gradientType:function(e,t){switch(void 0===e&&(e=null),t.type){case Wo:if(t.gradientType in Co)return t.gradientType;c.warn(`Gradient type does not exist: ${t.gradientType}`);default:return e}},colorIndex:function(e,t){switch(void 0===e&&(e=0),t.type){case"scratch-paint/color-index/CHANGE_COLOR_INDEX":return 1!==t.index&&0!==t.index?(c.warn(`Invalid color index: ${t.index}`),e):t.index;case Wo:if(t.gradientType===Co.SOLID)return 0;default:return e}}}),nd=Object(ed.combineReducers)({mode:function(e,t){switch(void 0===e&&(e=jo),t.type){case"scratch-paint/modes/CHANGE_MODE":if(t.mode in E)return t.mode;c.warn(`Mode does not exist: ${t.mode}`);default:return e}},bitBrushSize:function(e,t){switch(void 0===e&&(e=10),t.type){case"scratch-paint/brush-mode/CHANGE_BIT_BRUSH_SIZE":return isNaN(t.brushSize)?(c.warn(`Invalid brush size: ${t.brushSize}`),e):Math.max(1,t.brushSize);case Yt:{if(!t.selectedItems||!t.selectedItems.length)return e;if(!t.bitmapMode)return e;const o=zo(t.selectedItems,t.bitmapMode);return o.thickness?o.thickness:e}default:return e}},bitEraserSize:function(e,t){switch(void 0===e&&(e=40),t.type){case"scratch-paint/eraser-mode/CHANGE_BIT_ERASER_SIZE":return isNaN(t.eraserSize)?(c.warn(`Invalid eraser size: ${t.eraserSize}`),e):Math.max(1,t.eraserSize);default:return e}},brushMode:function(e,t){switch(void 0===e&&(e=Gr),t.type){case"scratch-paint/brush-mode/CHANGE_BRUSH_SIZE":return isNaN(t.brushSize)?(c.warn(`Invalid brush size: ${t.brushSize}`),e):{brushSize:Math.max(1,t.brushSize)};default:return e}},color:td,clipboard:function(e,t){switch(void 0===e&&(e=io),t.type){case no:return t.clipboardItems&&t.clipboardItems instanceof Array&&0!==t.clipboardItems.length?{items:t.clipboardItems,pasteOffset:1}:(c.warn("Invalid clipboard item format"),e);case"scratch-paint/clipboard/INCREMENT_PASTE_OFFSET":return{items:e.items,pasteOffset:e.pasteOffset+1};case"scratch-paint/clipboard/CLEAR_PASTE_OFFSET":return{items:e.items,pasteOffset:0};default:return e}},cursor:function(e,t){switch(void 0===e&&(e=kn),t.type){case"scratch-paint/cursor/CHANGE_CURSOR":return void 0===t.cursorString?(c.warn("Cursor should not be set to undefined. Use 'default'."),e):(Object.values(Tn).includes(t.cursorString)||c.warn(`Cursor should be a valid cursor string. Got: ${t.cursorString}`),t.cursorString);case yn:return Tn.NONE;case Mn:return Tn.DEFAULT;default:return e}},eraserMode:function(e,t){switch(void 0===e&&(e=Xi),t.type){case"scratch-paint/eraser-mode/CHANGE_ERASER_SIZE":return isNaN(t.brushSize)?(c.warn(`Invalid brush size: ${t.brushSize}`),e):{brushSize:Math.max(1,t.brushSize)};default:return e}},fillBitmapShapes:function(e,t){switch(void 0===e&&(e=!0),t.type){case jr:return t.filled;case Yt:return t.bitmapMode&&t.selectedItems&&t.selectedItems[0]instanceof i.a.Shape?0===t.selectedItems[0].strokeWidth:e;default:return e}},fillMode:od,font:function(e,t){switch(void 0===e&&(e=Zr),t.type){case"scratch-paint/fonts/CHANGE_FONT":return t.font?t.font:e;default:return e}},format:function(e,t){switch(void 0===e&&(e=null),t.type){case jt:case Vt:case"scratch-paint/formats/CHANGE_FORMAT":if(!t.format)return e;if(t.format in S)return t.format;c.warn(`Format does not exist: ${t.format}`);default:return e}},hoveredItemId:function(e,t){switch(void 0===e&&(e=null),t.type){case eo:return void 0===t.hoveredItemId?(c.warn("Hovered item should not be set to undefined. Use null."),e):void 0===t.hoveredItemId||isNaN(t.hoveredItemId)?(c.warn(`Hovered item should be an item ID number. Got: ${t.hoveredItemId}`),e):t.hoveredItemId;default:return e}},layout:function(e,t){switch(void 0===e&&(e=Lr),t.type){case _r:return-1===Br.indexOf(t.layout)?(c.warn(`Unrecognized layout provided: ${t.layout}`),e):{rtl:"rtl"===t.layout};default:return e}},modals:function(e,t){switch(void 0===e&&(e=is),t.type){case ns:return Object.assign({},is,{[t.modal]:!0});case"scratch-paint/modals/CLOSE_MODAL":return Object.assign({},is,{[t.modal]:!1});default:return e}},selectedItems:function(e,t){switch(void 0===e&&(e=Zt),t.type){case"scratch-paint/select/REDRAW_SELECTION_BOX":return e.length>0?e.slice(0):e;case Yt:return t.selectedItems&&t.selectedItems instanceof Array?t.selectedItems.length>1&&t.bitmapMode?(c.warn(`Multiselect should not be possible in bitmap mode: ${t.selectedItems}`),e):0===t.selectedItems.length&&0===e.length?e:t.selectedItems:(c.warn(`No selected items or wrong format provided: ${t.selectedItems}`),e);default:return e}},textEditTarget:function(e,t){switch(void 0===e&&(e=null),t.type){case"scratch-paint/text-tool/CHANGE_TEXT_EDIT_TARGET":return void 0===t.textEditTargetId?(c.warn("Text edit target should not be set to undefined. Use null."),e):void 0===t.textEditTargetId||isNaN(t.textEditTargetId)?(c.warn(`Text edit target should be an item ID number. Got: ${t.textEditTargetId}`),e):t.textEditTargetId;default:return e}},undo:function(e,t){switch(void 0===e&&(e=Xt),t.type){case jt:return e.pointer<=0?(c.warn("Can't undo, undo stack is empty"),e):{stack:e.stack,pointer:e.pointer-1};case Vt:return e.pointer<=-1||e.pointer===e.stack.length-1?(c.warn("Can't redo, redo stack is empty"),e):{stack:e.stack,pointer:e.pointer+1};case Wt:return t.snapshot?e.pointer>=99?{stack:e.stack.slice(e.pointer-100+2,e.pointer+1).concat(t.snapshot),pointer:99}:{stack:e.stack.slice(0,e.pointer+1).concat(t.snapshot),pointer:e.pointer+1}:(c.warn("Couldn't create undo snapshot, no data provided"),e);case Kt:return Xt;default:return e}},viewBounds:function(e,t){switch(void 0===e&&(e=ao),t.type){case"scratch-paint/view/UPDATE_VIEW_BOUNDS":return t.viewBounds instanceof i.a.Matrix?t.viewBounds:(c.warn("View bounds should be a paper.Matrix."),e);default:return e}},zoomLevels:function(e,t){switch(void 0===e&&(e=lo),t.type){case"scratch-paint/zoom-levels/SET_ZOOM_LEVEL_ID":return"currentZoomLevelId"===t.zoomLevelId?(c.warn("currentZoomLevelId is an invalid string for zoomLevel"),e):Object.assign({},e,{currentZoomLevelId:t.zoomLevelId});case"scratch-paint/zoom-levels/SAVE_ZOOM_LEVEL":return Object.assign({},e,{[e.currentZoomLevelId]:t.zoomLevel});default:return e}}});o.d(t,"b",(function(){return Qc})),o.d(t,"a",(function(){return nd}))},874:function(e,t,o){"use strict";e.exports=function(e){var t,o={};if(!(e instanceof Object)||Array.isArray(e))throw new Error("keyMirror(...): Argument must be an object.");for(t in e)e.hasOwnProperty(t)&&(o[t]=t);return o}},875:function(e,t,o){var n=o(901);e.exports=function(e){var t,o,i,s;if(t=/^((?:rgb|hs[lv]|cmyk|xyz|lab)a?)\s*\(([^\)]*)\)/.exec(e)){var a=t[1],r="cmyk"===(l=a.replace(/a$/,""))?4:3;o=n[l],i=t[2].replace(/^\s+|\s+$/g,"").split(/\s*,\s*/).map((function(e,t){return/%$/.test(e)&&t===r?parseFloat(e)/100:(/%$/.test(e),parseFloat(e))})),a===l&&i.push(1),s=void 0===i[r]?1:i[r],i=i.slice(0,r),o[l]=function(){return i}}else if(/^#[A-Fa-f0-9]+$/.test(e)){var l;r=(l=e.replace(/^#/,"")).length;o=n.rgb,i=(i=l.split(3===r?/(.)/:/(..)/)).filter(Boolean).map((function(e){return 3===r?parseInt(e+e,16):parseInt(e,16)})),s=1,o.rgb=function(){return i},i[0]||(i[0]=0),i[1]||(i[1]=0),i[2]||(i[2]=0)}else(o=n.keyword).keyword=function(){return e},i=e,s=1;var c={rgb:void 0,hsl:void 0,hsv:void 0,cmyk:void 0,keyword:void 0,hex:void 0};try{c.rgb=o.rgb(i)}catch(e){}try{c.hsl=o.hsl(i)}catch(e){}try{c.hsv=o.hsv(i)}catch(e){}try{c.cmyk=o.cmyk(i)}catch(e){}try{c.keyword=o.keyword(i)}catch(e){}return c.rgb&&(c.hex="#"+c.rgb.map((function(e){var t=e.toString(16);return 1===t.length?"0"+t:t})).join("")),c.rgb&&(c.rgba=c.rgb.concat(s)),c.hsl&&(c.hsla=c.hsl.concat(s)),c.hsv&&(c.hsva=c.hsv.concat(s)),c.cmyk&&(c.cmyka=c.cmyk.concat(s)),c}},877:function(e,t,o){(function(t){var o=200,n="__lodash_hash_undefined__",i=1/0,s=9007199254740991,a="[object Arguments]",r="[object Function]",l="[object GeneratorFunction]",c="[object Symbol]",d=/^\[object .+?Constructor\]$/,h=/^(?:0|[1-9]\d*)$/,p="object"==typeof t&&t&&t.Object===Object&&t,u="object"==typeof self&&self&&self.Object===Object&&self,m=p||u||Function("return this")();function f(e,t,o){switch(o.length){case 0:return e.call(t);case 1:return e.call(t,o[0]);case 2:return e.call(t,o[0],o[1]);case 3:return e.call(t,o[0],o[1],o[2])}return e.apply(t,o)}function g(e,t){return!!(e?e.length:0)&&function(e,t,o){if(t!=t)return function(e,t,o,n){var i=e.length,s=o+(n?1:-1);for(;n?s--:++s<i;)if(t(e[s],s,e))return s;return-1}(e,S,o);var n=o-1,i=e.length;for(;++n<i;)if(e[n]===t)return n;return-1}(e,t,0)>-1}function b(e,t,o){for(var n=-1,i=e?e.length:0;++n<i;)if(o(t,e[n]))return!0;return!1}function v(e,t){for(var o=-1,n=e?e.length:0,i=Array(n);++o<n;)i[o]=t(e[o],o,e);return i}function w(e,t){for(var o=-1,n=t.length,i=e.length;++o<n;)e[i+o]=t[o];return e}function S(e){return e!=e}function C(e,t){return e.has(t)}function I(e,t){return function(o){return e(t(o))}}var x,T=Array.prototype,y=Function.prototype,M=Object.prototype,E=m["__core-js_shared__"],R=(x=/[^.]+$/.exec(E&&E.keys&&E.keys.IE_PROTO||""))?"Symbol(src)_1."+x:"",k=y.toString,O=M.hasOwnProperty,D=M.toString,P=RegExp("^"+k.call(O).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),_=m.Symbol,L=I(Object.getPrototypeOf,Object),B=M.propertyIsEnumerable,A=T.splice,N=_?_.isConcatSpreadable:void 0,U=Object.getOwnPropertySymbols,z=Math.max,F=J(m,"Map"),H=J(Object,"create");function q(e){var t=-1,o=e?e.length:0;for(this.clear();++t<o;){var n=e[t];this.set(n[0],n[1])}}function G(e){var t=-1,o=e?e.length:0;for(this.clear();++t<o;){var n=e[t];this.set(n[0],n[1])}}function j(e){var t=-1,o=e?e.length:0;for(this.clear();++t<o;){var n=e[t];this.set(n[0],n[1])}}function V(e){var t=-1,o=e?e.length:0;for(this.__data__=new j;++t<o;)this.add(e[t])}function W(e,t){var o=se(e)||ie(e)?function(e,t){for(var o=-1,n=Array(e);++o<e;)n[o]=t(o);return n}(e.length,String):[],n=o.length,i=!!n;for(var s in e)!t&&!O.call(e,s)||i&&("length"==s||oe(s,n))||o.push(s);return o}function K(e,t){for(var o,n,i=e.length;i--;)if((o=e[i][0])===(n=t)||o!=o&&n!=n)return i;return-1}function X(e){return!(!le(e)||(t=e,R&&R in t))&&(re(e)||function(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}(e)?P:d).test(function(e){if(null!=e){try{return k.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(e));var t}function $(e){if(!le(e))return function(e){var t=[];if(null!=e)for(var o in Object(e))t.push(o);return t}(e);var t,o,n,i=(o=(t=e)&&t.constructor,n="function"==typeof o&&o.prototype||M,t===n),s=[];for(var a in e)("constructor"!=a||!i&&O.call(e,a))&&s.push(a);return s}function Y(e){return function(e,t,o){var n=t(e);return se(e)?n:w(n,o(e))}(e,de,ee)}function Z(e,t){var o,n,i=e.__data__;return("string"==(n=typeof(o=t))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==o:null===o)?i["string"==typeof t?"string":"hash"]:i.map}function J(e,t){var o=function(e,t){return null==e?void 0:e[t]}(e,t);return X(o)?o:void 0}q.prototype.clear=function(){this.__data__=H?H(null):{}},q.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},q.prototype.get=function(e){var t=this.__data__;if(H){var o=t[e];return o===n?void 0:o}return O.call(t,e)?t[e]:void 0},q.prototype.has=function(e){var t=this.__data__;return H?void 0!==t[e]:O.call(t,e)},q.prototype.set=function(e,t){return this.__data__[e]=H&&void 0===t?n:t,this},G.prototype.clear=function(){this.__data__=[]},G.prototype.delete=function(e){var t=this.__data__,o=K(t,e);return!(o<0)&&(o==t.length-1?t.pop():A.call(t,o,1),!0)},G.prototype.get=function(e){var t=this.__data__,o=K(t,e);return o<0?void 0:t[o][1]},G.prototype.has=function(e){return K(this.__data__,e)>-1},G.prototype.set=function(e,t){var o=this.__data__,n=K(o,e);return n<0?o.push([e,t]):o[n][1]=t,this},j.prototype.clear=function(){this.__data__={hash:new q,map:new(F||G),string:new q}},j.prototype.delete=function(e){return Z(this,e).delete(e)},j.prototype.get=function(e){return Z(this,e).get(e)},j.prototype.has=function(e){return Z(this,e).has(e)},j.prototype.set=function(e,t){return Z(this,e).set(e,t),this},V.prototype.add=V.prototype.push=function(e){return this.__data__.set(e,n),this},V.prototype.has=function(e){return this.__data__.has(e)};var Q=U?I(U,Object):me,ee=U?function(e){for(var t=[];e;)w(t,Q(e)),e=L(e);return t}:me;function te(e){return se(e)||ie(e)||!!(N&&e&&e[N])}function oe(e,t){return!!(t=null==t?s:t)&&("number"==typeof e||h.test(e))&&e>-1&&e%1==0&&e<t}function ne(e){if("string"==typeof e||function(e){return"symbol"==typeof e||ce(e)&&D.call(e)==c}(e))return e;var t=e+"";return"0"==t&&1/e==-i?"-0":t}function ie(e){return function(e){return ce(e)&&ae(e)}(e)&&O.call(e,"callee")&&(!B.call(e,"callee")||D.call(e)==a)}var se=Array.isArray;function ae(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=s}(e.length)&&!re(e)}function re(e){var t=le(e)?D.call(e):"";return t==r||t==l}function le(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function ce(e){return!!e&&"object"==typeof e}function de(e){return ae(e)?W(e,!0):$(e)}var he,pe,ue=(he=function(e,t){return null==e?{}:(t=v(function e(t,o,n,i,s){var a=-1,r=t.length;for(n||(n=te),s||(s=[]);++a<r;){var l=t[a];o>0&&n(l)?o>1?e(l,o-1,n,i,s):w(s,l):i||(s[s.length]=l)}return s}(t,1),ne),function(e,t){return function(e,t,o){for(var n=-1,i=t.length,s={};++n<i;){var a=t[n],r=e[a];o(r,a)&&(s[a]=r)}return s}(e=Object(e),t,(function(t,o){return o in e}))}(e,function(e,t,n,i){var s,a=-1,r=g,l=!0,c=e.length,d=[],h=t.length;if(!c)return d;n&&(t=v(t,(s=n,function(e){return s(e)}))),i?(r=b,l=!1):t.length>=o&&(r=C,l=!1,t=new V(t));e:for(;++a<c;){var p=e[a],u=n?n(p):p;if(p=i||0!==p?p:0,l&&u==u){for(var m=h;m--;)if(t[m]===u)continue e;d.push(p)}else r(t,u,i)||d.push(p)}return d}(Y(e),t)))},pe=z(void 0===pe?he.length-1:pe,0),function(){for(var e=arguments,t=-1,o=z(e.length-pe,0),n=Array(o);++t<o;)n[t]=e[pe+t];t=-1;for(var i=Array(pe+1);++t<pe;)i[t]=e[t];return i[pe]=n,f(he,this,i)});function me(){return[]}e.exports=ue}).call(this,o(64))},887:function(e,t,o){e.exports=o.p+"static/resource/a6cebfe99bad7b01f59b85998cbc4628.svg"},888:function(e,t,o){e.exports=o.p+"static/resource/21739a7b303ece303b023791813412cb.svg"},889:function(e,t,o){e.exports=o.p+"static/resource/12e69a59db0f0c697eaaf1abbcad902f.svg"},890:function(e,t,o){e.exports=o.p+"static/resource/09469790f10bcd5ed51fe8f85f8bdc1e.svg"},891:function(e,t,o){e.exports=o.p+"static/resource/31446edc97ac1eb0c3d2af65c0d8432a.svg"},892:function(e,t,o){e.exports=o.p+"static/resource/770c1f3eca5a0d7c327c275865dad3f0.svg"},893:function(e,t,o){e.exports=o.p+"static/resource/e53ff4a140871927b2d5be4f5cdb2c79.svg"},894:function(e,t,o){e.exports=o.p+"static/resource/7d6f0362fc2114f39b4f6651ebeda312.svg"},895:function(e,t,o){e.exports=o.p+"static/resource/dbff6359a3f338d5581c626ee50acf60.svg"},896:function(e,t,o){var n=o(948);"string"==typeof n&&(n=[[e.i,n,""]]);var i={hmr:!0,transform:void 0};o(21)(n,i);n.locals&&(e.exports=n.locals)},897:function(e,t,o){var n=o(898);"string"==typeof n&&(n=[[e.i,n,""]]);var i={hmr:!0,transform:void 0};o(21)(n,i);n.locals&&(e.exports=n.locals)},898:function(e,t,o){(t=e.exports=o(20)(!1)).push([e.i,".paper-canvas_paper-canvas {\n    top: 1px; /* leave room for the border */\n    left: 1px;\n    width: calc(100% - 2px);\n    height: calc(100% - 2px);\n    margin: auto;\n    position: absolute;\n    background-color: #D9E3F2;\n}\n",""]),t.locals={"paper-canvas":"paper-canvas_paper-canvas",paperCanvas:"paper-canvas_paper-canvas"}},899:function(e,t,o){var n=o(900);"string"==typeof n&&(n=[[e.i,n,""]]);var i={hmr:!0,transform:void 0};o(21)(n,i);n.locals&&(e.exports=n.locals)},900:function(e,t,o){(t=e.exports=o(20)(!1)).push([e.i,".scrollable-canvas_vertical-scrollbar, .scrollable-canvas_horizontal-scrollbar {\n    position: absolute;\n    background: rgba(190, 190, 190, 0.8);\n    border-radius: calc(8px / 2);\n    cursor: pointer;\n}\n.scrollable-canvas_vertical-scrollbar-wrapper {\n    position: absolute;\n    width: 8px;\n    right: 4px;\n    top: 4px;\n    height: calc(100% - 8px - 2 * 4px);\n}\n.scrollable-canvas_horizontal-scrollbar-wrapper {\n    position: absolute;\n    height: 8px;\n    left: 4px;\n    bottom: 4px;\n    width: calc(100% - 8px - 2 * 4px);\n}\n.scrollable-canvas_vertical-scrollbar {\n    width: 8px;\n}\n.scrollable-canvas_horizontal-scrollbar {\n    height: 8px;\n}\n",""]),t.locals={"vertical-scrollbar":"scrollable-canvas_vertical-scrollbar",verticalScrollbar:"scrollable-canvas_vertical-scrollbar","horizontal-scrollbar":"scrollable-canvas_horizontal-scrollbar",horizontalScrollbar:"scrollable-canvas_horizontal-scrollbar","vertical-scrollbar-wrapper":"scrollable-canvas_vertical-scrollbar-wrapper",verticalScrollbarWrapper:"scrollable-canvas_vertical-scrollbar-wrapper","horizontal-scrollbar-wrapper":"scrollable-canvas_horizontal-scrollbar-wrapper",horizontalScrollbarWrapper:"scrollable-canvas_horizontal-scrollbar-wrapper"}},901:function(e,t,o){var n=o(902),i=function(){return new c};for(var s in n){i[s+"Raw"]=function(e){return function(t){return"number"==typeof t&&(t=Array.prototype.slice.call(arguments)),n[e](t)}}(s);var a=/(\w+)2(\w+)/.exec(s),r=a[1],l=a[2];(i[r]=i[r]||{})[l]=i[s]=function(e){return function(t){"number"==typeof t&&(t=Array.prototype.slice.call(arguments));var o=n[e](t);if("string"==typeof o||void 0===o)return o;for(var i=0;i<o.length;i++)o[i]=Math.round(o[i]);return o}}(s)}var c=function(){this.convs={}};c.prototype.routeSpace=function(e,t){var o=t[0];return void 0===o?this.getValues(e):("number"==typeof o&&(o=Array.prototype.slice.call(t)),this.setValues(e,o))},c.prototype.setValues=function(e,t){return this.space=e,this.convs={},this.convs[e]=t,this},c.prototype.getValues=function(e){var t=this.convs[e];if(!t){var o=this.space,n=this.convs[o];t=i[o][e](n),this.convs[e]=t}return t},["rgb","hsl","hsv","cmyk","keyword"].forEach((function(e){c.prototype[e]=function(t){return this.routeSpace(e,arguments)}})),e.exports=i},902:function(e,t){function o(e){var t,o,n=e[0]/255,i=e[1]/255,s=e[2]/255,a=Math.min(n,i,s),r=Math.max(n,i,s),l=r-a;return r==a?t=0:n==r?t=(i-s)/l:i==r?t=2+(s-n)/l:s==r&&(t=4+(n-i)/l),(t=Math.min(60*t,360))<0&&(t+=360),o=(a+r)/2,[t,100*(r==a?0:o<=.5?l/(r+a):l/(2-r-a)),100*o]}function n(e){var t,o,n=e[0],i=e[1],s=e[2],a=Math.min(n,i,s),r=Math.max(n,i,s),l=r-a;return o=0==r?0:l/r*1e3/10,r==a?t=0:n==r?t=(i-s)/l:i==r?t=2+(s-n)/l:s==r&&(t=4+(n-i)/l),(t=Math.min(60*t,360))<0&&(t+=360),[t,o,r/255*1e3/10]}function i(e){var t=e[0],n=e[1],i=e[2];return[o(e)[0],100*(1/255*Math.min(t,Math.min(n,i))),100*(i=1-1/255*Math.max(t,Math.max(n,i)))]}function s(e){var t,o=e[0]/255,n=e[1]/255,i=e[2]/255;return[100*((1-o-(t=Math.min(1-o,1-n,1-i)))/(1-t)||0),100*((1-n-t)/(1-t)||0),100*((1-i-t)/(1-t)||0),100*t]}function a(e){return T[JSON.stringify(e)]}function l(e){var t=e[0]/255,o=e[1]/255,n=e[2]/255;return[100*(.4124*(t=t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92)+.3576*(o=o>.04045?Math.pow((o+.055)/1.055,2.4):o/12.92)+.1805*(n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92)),100*(.2126*t+.7152*o+.0722*n),100*(.0193*t+.1192*o+.9505*n)]}function c(e){var t=l(e),o=t[0],n=t[1],i=t[2];return n/=100,i/=108.883,o=(o/=95.047)>.008856?Math.pow(o,1/3):7.787*o+16/116,[116*(n=n>.008856?Math.pow(n,1/3):7.787*n+16/116)-16,500*(o-n),200*(n-(i=i>.008856?Math.pow(i,1/3):7.787*i+16/116))]}function d(e){var t,o,n,i,s,a=e[0]/360,r=e[1]/100,l=e[2]/100;if(0==r)return[s=255*l,s,s];t=2*l-(o=l<.5?l*(1+r):l+r-l*r),i=[0,0,0];for(var c=0;c<3;c++)(n=a+1/3*-(c-1))<0&&n++,n>1&&n--,s=6*n<1?t+6*(o-t)*n:2*n<1?o:3*n<2?t+(o-t)*(2/3-n)*6:t,i[c]=255*s;return i}function h(e){var t=e[0]/60,o=e[1]/100,n=e[2]/100,i=Math.floor(t)%6,s=t-Math.floor(t),a=255*n*(1-o),r=255*n*(1-o*s),l=255*n*(1-o*(1-s));n*=255;switch(i){case 0:return[n,l,a];case 1:return[r,n,a];case 2:return[a,n,l];case 3:return[a,r,n];case 4:return[l,a,n];case 5:return[n,a,r]}}function p(e){var t,o,n,i,s=e[0]/360,a=e[1]/100,l=e[2]/100,c=a+l;switch(c>1&&(a/=c,l/=c),n=6*s-(t=Math.floor(6*s)),0!=(1&t)&&(n=1-n),i=a+n*((o=1-l)-a),t){default:case 6:case 0:r=o,g=i,b=a;break;case 1:r=i,g=o,b=a;break;case 2:r=a,g=o,b=i;break;case 3:r=a,g=i,b=o;break;case 4:r=i,g=a,b=o;break;case 5:r=o,g=a,b=i}return[255*r,255*g,255*b]}function u(e){var t=e[0]/100,o=e[1]/100,n=e[2]/100,i=e[3]/100;return[255*(1-Math.min(1,t*(1-i)+i)),255*(1-Math.min(1,o*(1-i)+i)),255*(1-Math.min(1,n*(1-i)+i))]}function m(e){var t,o,n,i=e[0]/100,s=e[1]/100,a=e[2]/100;return o=-.9689*i+1.8758*s+.0415*a,n=.0557*i+-.204*s+1.057*a,t=(t=3.2406*i+-1.5372*s+-.4986*a)>.0031308?1.055*Math.pow(t,1/2.4)-.055:t*=12.92,o=o>.0031308?1.055*Math.pow(o,1/2.4)-.055:o*=12.92,n=n>.0031308?1.055*Math.pow(n,1/2.4)-.055:n*=12.92,[255*(t=Math.min(Math.max(0,t),1)),255*(o=Math.min(Math.max(0,o),1)),255*(n=Math.min(Math.max(0,n),1))]}function f(e){var t=e[0],o=e[1],n=e[2];return o/=100,n/=108.883,t=(t/=95.047)>.008856?Math.pow(t,1/3):7.787*t+16/116,[116*(o=o>.008856?Math.pow(o,1/3):7.787*o+16/116)-16,500*(t-o),200*(o-(n=n>.008856?Math.pow(n,1/3):7.787*n+16/116))]}function v(e){var t,o,n,i,s=e[0],a=e[1],r=e[2];return s<=8?i=(o=100*s/903.3)/100*7.787+16/116:(o=100*Math.pow((s+16)/116,3),i=Math.pow(o/100,1/3)),[t=t/95.047<=.008856?t=95.047*(a/500+i-16/116)/7.787:95.047*Math.pow(a/500+i,3),o,n=n/108.883<=.008859?n=108.883*(i-r/200-16/116)/7.787:108.883*Math.pow(i-r/200,3)]}function w(e){var t,o=e[0],n=e[1],i=e[2];return(t=360*Math.atan2(i,n)/2/Math.PI)<0&&(t+=360),[o,Math.sqrt(n*n+i*i),t]}function S(e){return m(v(e))}function C(e){var t,o=e[0],n=e[1];return t=e[2]/360*2*Math.PI,[o,n*Math.cos(t),n*Math.sin(t)]}function I(e){return x[e]}e.exports={rgb2hsl:o,rgb2hsv:n,rgb2hwb:i,rgb2cmyk:s,rgb2keyword:a,rgb2xyz:l,rgb2lab:c,rgb2lch:function(e){return w(c(e))},hsl2rgb:d,hsl2hsv:function(e){var t=e[0],o=e[1]/100,n=e[2]/100;if(0===n)return[0,0,0];return[t,100*(2*(o*=(n*=2)<=1?n:2-n)/(n+o)),100*((n+o)/2)]},hsl2hwb:function(e){return i(d(e))},hsl2cmyk:function(e){return s(d(e))},hsl2keyword:function(e){return a(d(e))},hsv2rgb:h,hsv2hsl:function(e){var t,o,n=e[0],i=e[1]/100,s=e[2]/100;return t=i*s,[n,100*(t=(t/=(o=(2-i)*s)<=1?o:2-o)||0),100*(o/=2)]},hsv2hwb:function(e){return i(h(e))},hsv2cmyk:function(e){return s(h(e))},hsv2keyword:function(e){return a(h(e))},hwb2rgb:p,hwb2hsl:function(e){return o(p(e))},hwb2hsv:function(e){return n(p(e))},hwb2cmyk:function(e){return s(p(e))},hwb2keyword:function(e){return a(p(e))},cmyk2rgb:u,cmyk2hsl:function(e){return o(u(e))},cmyk2hsv:function(e){return n(u(e))},cmyk2hwb:function(e){return i(u(e))},cmyk2keyword:function(e){return a(u(e))},keyword2rgb:I,keyword2hsl:function(e){return o(I(e))},keyword2hsv:function(e){return n(I(e))},keyword2hwb:function(e){return i(I(e))},keyword2cmyk:function(e){return s(I(e))},keyword2lab:function(e){return c(I(e))},keyword2xyz:function(e){return l(I(e))},xyz2rgb:m,xyz2lab:f,xyz2lch:function(e){return w(f(e))},lab2xyz:v,lab2rgb:S,lab2lch:w,lch2lab:C,lch2xyz:function(e){return v(C(e))},lch2rgb:function(e){return S(C(e))}};var x={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},T={};for(var y in x)T[JSON.stringify(x[y])]=y},903:function(e,t,o){var n=o(904);"string"==typeof n&&(n=[[e.i,n,""]]);var i={hmr:!0,transform:void 0};o(21)(n,i);n.locals&&(e.exports=n.locals)},904:function(e,t,o){(t=e.exports=o(20)(!1)).push([e.i,"/* DO NOT EDIT\n@todo This file is copied from GUI and should be pulled out into a shared library.\nSee https://github.com/LLK/scratch-paint/issues/13 */\n\n.button_button {\n    background: none;\n    cursor: pointer;\n    -webkit-user-select: none;\n       -moz-user-select: none;\n        -ms-user-select: none;\n            user-select: none;\n}\n\n.button_button:active {\n    background-color: hsla(215, 100%, 65%, 0.20); \n}\n\n.button_highlighted.button_button {\n    background-color: hsla(215, 100%, 65%, 0.20); \n}\n\n.button_mod-disabled {\n    cursor: auto;\n    opacity: .5;\n}\n\n.button_mod-disabled:active {\n    background: none;\n}\n",""]),t.locals={button:"button_button",highlighted:"button_highlighted","mod-disabled":"button_mod-disabled",modDisabled:"button_mod-disabled"}},905:function(e,t,o){var n=o(906);"string"==typeof n&&(n=[[e.i,n,""]]);var i={hmr:!0,transform:void 0};o(21)(n,i);n.locals&&(e.exports=n.locals)},906:function(e,t,o){(t=e.exports=o(20)(!1)).push([e.i,"/* DO NOT EDIT\n@todo This file is copied from GUI and should be pulled out into a shared library.\nSee https://github.com/LLK/scratch-paint/issues/13 */\n\n/* DO NOT EDIT\n@todo This file is copied from GUI and should be pulled out into a shared library.\nSee https://github.com/LLK/scratch-paint/issues/13 */\n\n/* ACTUALLY, THIS IS EDITED ;)\nTHIS WAS CHANGED ON 10/25/2017 BY @mewtaylor TO ADD A VARIABLE FOR THE SMALLEST\nGRID UNITS.\n\nALSO EDITED ON 11/13/2017 TO ADD IN CONTANTS FOR LAYOUT FROM `layout-contents.js`*/\n\n/* layout contants from `layout-constants.js`, minus 1px */\n\n.tool-select-base_mod-tool-select {\n    display: inline-block;\n    margin: .25rem;\n    border: none;\n    border-radius: .25rem;\n    outline: none;\n    background: none;\n    padding: .25rem;\n    font-size: 0.85rem;\n    -webkit-transition: 0.2s;\n    -o-transition: 0.2s;\n    transition: 0.2s;\n}\n\n.tool-select-base_mod-tool-select.tool-select-base_is-selected {\n    background-color: #4C97FF;\n}\n\n.tool-select-base_mod-tool-select:focus {\n    outline: none;\n}\n\nimg.tool-select-base_tool-select-icon {\n    width: 2rem;\n    height: 2rem;\n    -webkit-box-flex: 1;\n    -webkit-flex-grow: 1;\n        -ms-flex-positive: 1;\n            flex-grow: 1;\n    vertical-align: middle;\n}\n\n.tool-select-base_mod-tool-select.tool-select-base_is-selected .tool-select-base_tool-select-icon {\n    /* Make the tool icons white while selected by making them black and inverting */\n    -webkit-filter: brightness(0) invert(1);\n            filter: brightness(0) invert(1);\n}\n\n@media only screen and (max-width: 1256px) {\n    .tool-select-base_mod-tool-select {\n        margin: 0;\n    }\n}\n",""]),t.locals={"mod-tool-select":"tool-select-base_mod-tool-select",modToolSelect:"tool-select-base_mod-tool-select","is-selected":"tool-select-base_is-selected",isSelected:"tool-select-base_is-selected","tool-select-icon":"tool-select-base_tool-select-icon",toolSelectIcon:"tool-select-base_tool-select-icon"}},907:function(e,t,o){e.exports=o.p+"static/resource/02d927ce93445be737c7ff43fb98b135.svg"},908:function(e,t,o){e.exports=o.p+"static/resource/81d5d1258558641e78d425193753207c.svg"},909:function(e,t,o){var n=o(910);"string"==typeof n&&(n=[[e.i,n,""]]);var i={hmr:!0,transform:void 0};o(21)(n,i);n.locals&&(e.exports=n.locals)},910:function(e,t,o){(t=e.exports=o(20)(!1)).push([e.i,"/* DO NOT EDIT\n@todo This file is copied from GUI and should be pulled out into a shared library.\nSee https://github.com/LLK/scratch-paint/issues/13 */\n\n/* ACTUALLY, THIS IS EDITED ;)\nTHIS WAS CHANGED ON 10/25/2017 BY @mewtaylor TO ADD A VARIABLE FOR THE SMALLEST\nGRID UNITS.\n\nALSO EDITED ON 11/13/2017 TO ADD IN CONTANTS FOR LAYOUT FROM `layout-contents.js`*/\n\n/* layout contants from `layout-constants.js`, minus 1px */\n\n.button-group_button-group {\n    display: -webkit-inline-box;\n    display: -webkit-inline-flex;\n    display: -ms-inline-flexbox;\n    display: inline-flex;\n    -webkit-box-orient: horizontal;\n    -webkit-box-direction: normal;\n    -webkit-flex-direction: row;\n        -ms-flex-direction: row;\n            flex-direction: row;\n    padding: 0 .25rem;\n}\n",""]),t.locals={"button-group":"button-group_button-group",buttonGroup:"button-group_button-group"}},911:function(e,t,o){var n=o(912);"string"==typeof n&&(n=[[e.i,n,""]]);var i={hmr:!0,transform:void 0};o(21)(n,i);n.locals&&(e.exports=n.locals)},912:function(e,t,o){(t=e.exports=o(20)(!1)).push([e.i,'.color-button_color-button {\n    height: 2rem;\n    width: 3rem;\n    display: -webkit-box;\n    display: -webkit-flex;\n    display: -ms-flexbox;\n    display: flex;\n}\n\n.color-button_color-button-swatch {\n    position: relative;\n    display: -webkit-box;\n    display: -webkit-flex;\n    display: -ms-flexbox;\n    display: flex;\n    cursor: pointer;\n    -webkit-flex-basis: 2rem;\n        -ms-flex-preferred-size: 2rem;\n            flex-basis: 2rem;\n    -webkit-flex-shrink: 0;\n        -ms-flex-negative: 0;\n            flex-shrink: 0;\n    height: 100%;\n    border: 1px solid rgba(0, 0, 0, 0.25);\n}\n\n[dir="ltr"] .color-button_color-button-swatch {\n    border-top-left-radius: 4px;\n    border-bottom-left-radius: 4px;\n}\n\n[dir="rtl"] .color-button_color-button-swatch {\n    border-top-right-radius: 4px;\n    border-bottom-right-radius: 4px;\n}\n\n.color-button_color-button-arrow {\n    display: -webkit-box;\n    display: -webkit-flex;\n    display: -ms-flexbox;\n    display: flex;\n    -webkit-user-select: none;\n       -moz-user-select: none;\n        -ms-user-select: none;\n            user-select: none;\n    cursor: pointer;\n    -webkit-flex-basis: 1rem;\n        -ms-flex-preferred-size: 1rem;\n            flex-basis: 1rem;\n    -webkit-flex-shrink: 0;\n        -ms-flex-negative: 0;\n            flex-shrink: 0;\n    height: 100%;\n\n    border: 1px solid rgba(0, 0, 0, 0.25);\n\n    -webkit-box-align: center;\n\n    -webkit-align-items: center;\n\n        -ms-flex-align: center;\n\n            align-items: center;\n    -webkit-box-pack: center;\n    -webkit-justify-content: center;\n        -ms-flex-pack: center;\n            justify-content: center;\n    color: #575e75;\n    font-size: 0.75rem;\n}\n\n[dir="ltr"] .color-button_color-button-arrow {\n    border-top-right-radius: 4px;\n    border-bottom-right-radius: 4px;\n    border-left: none;\n}\n\n[dir="rtl"] .color-button_color-button-arrow {\n    border-top-left-radius: 4px;\n    border-bottom-left-radius: 4px;\n    border-right: none;\n}\n\n.color-button_swatch-icon {\n    width: 1.75rem;\n    margin: auto;\n    /* Make sure it appears above the outline box */\n    z-index: 2;\n}\n\n.color-button_outline-swatch:after {\n    content: "";\n    position: absolute;\n    top: calc(0.5rem);\n    left: calc(0.5rem);\n    width: 0.75rem;\n    height: 0.75rem;\n    background: white;\n    border: 1px solid rgba(0, 0, 0, 0.25);\n    /* Make sure it appears below the transparent icon */\n    z-index: 1;\n}\n',""]),t.locals={"color-button":"color-button_color-button",colorButton:"color-button_color-button","color-button-swatch":"color-button_color-button-swatch",colorButtonSwatch:"color-button_color-button-swatch","color-button-arrow":"color-button_color-button-arrow",colorButtonArrow:"color-button_color-button-arrow","swatch-icon":"color-button_swatch-icon",swatchIcon:"color-button_swatch-icon","outline-swatch":"color-button_outline-swatch",outlineSwatch:"color-button_outline-swatch"}},913:function(e,t,o){var n=o(914);"string"==typeof n&&(n=[[e.i,n,""]]);var i={hmr:!0,transform:void 0};o(21)(n,i);n.locals&&(e.exports=n.locals)},914:function(e,t,o){(t=e.exports=o(20)(!1)).push([e.i,".slider_container {\n    margin: 8px;\n    height: 22px;\n    width: 150px;\n    position: relative;\n    outline: none;\n    border-radius: 11px;\n    margin-bottom: 20px;\n}\n\n.slider_last {\n    margin-bottom: 4px;\n}\n\n.slider_handle {\n    left: 100px;\n    width: 26px;\n    height: 26px;\n    margin-top: -2px;\n    position: absolute;\n    background-color: white;\n    border-radius: 100%;\n    -webkit-box-shadow: 0 0 0 4px rgba(0, 0, 0, 0.15);\n            box-shadow: 0 0 0 4px rgba(0, 0, 0, 0.15);\n    -ms-touch-action: none;\n        touch-action: none;\n}\n",""]),t.locals={container:"slider_container",last:"slider_last",handle:"slider_handle"}},915:function(e,t,o){var n=o(916);"string"==typeof n&&(n=[[e.i,n,""]]);var i={hmr:!0,transform:void 0};o(21)(n,i);n.locals&&(e.exports=n.locals)},916:function(e,t,o){(t=e.exports=o(20)(!1)).push([e.i,"/* DO NOT EDIT\n@todo This file is copied from GUI and should be pulled out into a shared library.\nSee https://github.com/LLK/scratch-paint/issues/13 */\n\n/* ACTUALLY, THIS IS EDITED ;)\nTHIS WAS CHANGED ON 10/25/2017 BY @mewtaylor TO ADD A VARIABLE FOR THE SMALLEST\nGRID UNITS.\n\nALSO EDITED ON 11/13/2017 TO ADD IN CONTANTS FOR LAYOUT FROM `layout-contents.js`*/\n\n/* layout contants from `layout-constants.js`, minus 1px */\n\n.labeled-icon-button_mod-edit-field {\n    background: none;\n    border: none;\n    display: inline-block;\n    padding: .25rem .325rem;\n    outline: none;\n    border-radius: 0.25rem;\n    min-width: 3rem;\n    font-size: 0.85rem;\n    text-align: center;\n}\n\n.labeled-icon-button_edit-field-icon {\n    width: 1.5rem;\n    height: 1.5rem;\n    -webkit-box-flex: 1;\n    -webkit-flex-grow: 1;\n        -ms-flex-positive: 1;\n            flex-grow: 1;\n    vertical-align: middle;\n}\n\n.labeled-icon-button_edit-field-title {\n    display: block;\n    margin-top: .125rem;\n    font-size: .625rem;\n}\n",""]),t.locals={"mod-edit-field":"labeled-icon-button_mod-edit-field",modEditField:"labeled-icon-button_mod-edit-field","edit-field-icon":"labeled-icon-button_edit-field-icon",editFieldIcon:"labeled-icon-button_edit-field-icon","edit-field-title":"labeled-icon-button_edit-field-title",editFieldTitle:"labeled-icon-button_edit-field-title"}},917:function(e,t,o){var n=o(918);"string"==typeof n&&(n=[[e.i,n,""]]);var i={hmr:!0,transform:void 0};o(21)(n,i);n.locals&&(e.exports=n.locals)},918:function(e,t,o){(t=e.exports=o(20)(!1)).push([e.i,'/* DO NOT EDIT\n@todo This file is copied from GUI and should be pulled out into a shared library.\nSee https://github.com/LLK/scratch-paint/issues/13 */\n\n/* ACTUALLY, THIS IS EDITED ;)\nTHIS WAS CHANGED ON 10/25/2017 BY @mewtaylor TO ADD A VARIABLE FOR THE SMALLEST\nGRID UNITS.\n\nALSO EDITED ON 11/13/2017 TO ADD IN CONTANTS FOR LAYOUT FROM `layout-contents.js`*/\n\n/* layout contants from `layout-constants.js`, minus 1px */\n\n/* Popover styles */\n\n.Popover-body {\n    background: white;\n    border: 1px solid #ddd;\n    padding: 4px;\n    border-radius: 4px;\n    padding: 4px;\n    -webkit-box-shadow: 0px 0px 8px 1px rgba(0, 0, 0, .3);\n            box-shadow: 0px 0px 8px 1px rgba(0, 0, 0, .3);\n}\n\n.Popover-tipShape {\n    fill: white;\n    stroke: #ddd;\n}\n\n.color-picker_clickable {\n    cursor: pointer;\n}\n\n.color-picker_swatch-row {\n    display: -webkit-box;\n    display: -webkit-flex;\n    display: -ms-flexbox;\n    display: flex;\n    -webkit-box-orient: horizontal;\n    -webkit-box-direction: normal;\n    -webkit-flex-direction: row;\n        -ms-flex-direction: row;\n            flex-direction: row;\n    -webkit-box-pack: justify;\n    -webkit-justify-content: space-between;\n        -ms-flex-pack: justify;\n            justify-content: space-between;\n}\n\n.color-picker_row-header {\n    font-family: "Helvetica Neue", Helvetica, sans-serif;\n    font-size: 0.65rem;\n    color: #575E75;\n    margin: 8px;\n}\n\n[dir="ltr"] .color-picker_label-readout {\n    margin-left: 10px;\n}\n\n[dir="rtl"] .color-picker_label-readout {\n    margin-right: 10px;\n}\n\n.color-picker_label-name {\n    font-weight: bold;\n}\n\n.color-picker_divider {\n    border-top: 1px solid #ddd;\n    margin: 8px;\n}\n\n.color-picker_swap-button {\n    margin-left: 8px;\n    margin-right: 8px;\n}\n\n.color-picker_swatches {\n    margin: 8px;\n}\n\n.color-picker_swatch {\n    width: 1.5rem;\n    height: 1.5rem;\n    border: 1px solid #ddd;\n    border-radius: 4px;\n    -webkit-box-sizing: content-box;\n            box-sizing: content-box;\n    display: -webkit-box;\n    display: -webkit-flex;\n    display: -ms-flexbox;\n    display: flex;\n    -webkit-box-align: center;\n    -webkit-align-items: center;\n        -ms-flex-align: center;\n            align-items: center;\n}\n\n.color-picker_large-swatch-icon {\n    width: 1.75rem;\n    margin: auto;\n}\n\n.color-picker_large-swatch {\n    width: 2rem;\n    height: 2rem;\n}\n\n.color-picker_active-swatch {\n    border: 1px solid #4C97FF;\n    -webkit-box-shadow: 0px 0px 0px 3px hsla(215, 100%, 65%, 0.2);\n            box-shadow: 0px 0px 0px 3px hsla(215, 100%, 65%, 0.2);\n}\n\n.color-picker_swatch-icon {\n    width: 1.5rem;\n    height: 1.5rem;\n}\n\n.color-picker_inactive-gradient {\n    -webkit-filter: saturate(0%);\n            filter: saturate(0%);\n}\n\n.color-picker_gradient-picker-row {\n    -webkit-box-align: center;\n    -webkit-align-items: center;\n        -ms-flex-align: center;\n            align-items: center;\n    display: -webkit-box;\n    display: -webkit-flex;\n    display: -ms-flexbox;\n    display: flex;\n    -webkit-box-orient: horizontal;\n    -webkit-box-direction: normal;\n    -webkit-flex-direction: row;\n        -ms-flex-direction: row;\n            flex-direction: row;\n    -webkit-box-pack: center;\n    -webkit-justify-content: center;\n        -ms-flex-pack: center;\n            justify-content: center;\n    margin: 8px;\n    -webkit-user-select: none;\n       -moz-user-select: none;\n        -ms-user-select: none;\n            user-select: none;\n}\n\n[dir="ltr"] .color-picker_gradient-picker-row > img + img {\n    margin-left: calc(2 * .25rem);\n}\n\n[dir="rtl"] .color-picker_gradient-picker-row > img + img {\n    margin-right: calc(2 * .25rem);\n}\n\n[dir="rtl"] .color-picker_gradient-swatches-row {\n    -webkit-box-orient: horizontal;\n    -webkit-box-direction: reverse;\n    -webkit-flex-direction: row-reverse;\n        -ms-flex-direction: row-reverse;\n            flex-direction: row-reverse;\n}\n',""]),t.locals={clickable:"color-picker_clickable","swatch-row":"color-picker_swatch-row",swatchRow:"color-picker_swatch-row","row-header":"color-picker_row-header",rowHeader:"color-picker_row-header","label-readout":"color-picker_label-readout",labelReadout:"color-picker_label-readout","label-name":"color-picker_label-name",labelName:"color-picker_label-name",divider:"color-picker_divider","swap-button":"color-picker_swap-button",swapButton:"color-picker_swap-button",swatches:"color-picker_swatches",swatch:"color-picker_swatch","large-swatch-icon":"color-picker_large-swatch-icon",largeSwatchIcon:"color-picker_large-swatch-icon","large-swatch":"color-picker_large-swatch",largeSwatch:"color-picker_large-swatch","active-swatch":"color-picker_active-swatch",activeSwatch:"color-picker_active-swatch","swatch-icon":"color-picker_swatch-icon",swatchIcon:"color-picker_swatch-icon","inactive-gradient":"color-picker_inactive-gradient",inactiveGradient:"color-picker_inactive-gradient","gradient-picker-row":"color-picker_gradient-picker-row",gradientPickerRow:"color-picker_gradient-picker-row","gradient-swatches-row":"color-picker_gradient-swatches-row",gradientSwatchesRow:"color-picker_gradient-swatches-row"}},919:function(e,t,o){e.exports=o.p+"static/resource/8fb27bc07c64def488d712e06906c7a4.svg"},920:function(e,t,o){e.exports=o.p+"static/resource/52886015226b693acd9c15e33d924075.svg"},921:function(e,t,o){e.exports=o.p+"static/resource/1c6e5129e936855db5a1181a778a3b94.svg"},922:function(e,t,o){e.exports=o.p+"static/resource/18b504b8572a14661279856a13522f25.svg"},923:function(e,t,o){e.exports=o.p+"static/resource/a0c3f3a11b20c6777738f170e4b00098.svg"},924:function(e,t,o){e.exports=o.p+"static/resource/03aed75f9a75aef179982d359433dea4.svg"},925:function(e,t,o){var n=o(926);"string"==typeof n&&(n=[[e.i,n,""]]);var i={hmr:!0,transform:void 0};o(21)(n,i);n.locals&&(e.exports=n.locals)},926:function(e,t,o){(t=e.exports=o(20)(!1)).push([e.i,'/* DO NOT EDIT\n@todo This file is copied from GUI and should be pulled out into a shared library.\nSee https://github.com/LLK/scratch-paint/issues/13 */\n\n/* ACTUALLY, THIS IS EDITED ;)\nTHIS WAS CHANGED ON 10/25/2017 BY @mewtaylor TO ADD A VARIABLE FOR THE SMALLEST\nGRID UNITS.\n\nALSO EDITED ON 11/13/2017 TO ADD IN CONTANTS FOR LAYOUT FROM `layout-contents.js`*/\n\n/* layout contants from `layout-constants.js`, minus 1px */\n\n.input-group_input-group {\n    display: -webkit-inline-box;\n    display: -webkit-inline-flex;\n    display: -ms-inline-flexbox;\n    display: inline-flex;\n    -webkit-box-orient: horizontal;\n    -webkit-box-direction: normal;\n    -webkit-flex-direction: row;\n        -ms-flex-direction: row;\n            flex-direction: row;\n    -webkit-box-align: center;\n    -webkit-align-items: center;\n        -ms-flex-align: center;\n            align-items: center;\n}\n\n[dir="ltr"] .input-group_input-group + .input-group_input-group {\n    margin-left: calc(2 * .25rem);\n}\n\n[dir="rtl"] .input-group_input-group + .input-group_input-group {\n    margin-right: calc(2 * .25rem);\n}\n\n.input-group_disabled {\n    opacity: 0.3;\n    /* Prevent any user actions */\n    pointer-events: none;\n}\n',""]),t.locals={"input-group":"input-group_input-group",inputGroup:"input-group_input-group",disabled:"input-group_disabled"}},927:function(e,t,o){var n=o(928);"string"==typeof n&&(n=[[e.i,n,""]]);var i={hmr:!0,transform:void 0};o(21)(n,i);n.locals&&(e.exports=n.locals)},928:function(e,t,o){(t=e.exports=o(20)(!1)).push([e.i,'/* DO NOT EDIT\n@todo This file is copied from GUI and should be pulled out into a shared library.\nSee https://github.com/LLK/scratch-paint/issues/13 */\n\n/* DO NOT EDIT\n@todo This file is copied from GUI and should be pulled out into a shared library.\nSee https://github.com/LLK/scratch-paint/issues/13 */\n\n/* ACTUALLY, THIS IS EDITED ;)\nTHIS WAS CHANGED ON 10/25/2017 BY @mewtaylor TO ADD A VARIABLE FOR THE SMALLEST\nGRID UNITS.\n\nALSO EDITED ON 11/13/2017 TO ADD IN CONTANTS FOR LAYOUT FROM `layout-contents.js`*/\n\n/* layout contants from `layout-constants.js`, minus 1px */\n\n/* DO NOT EDIT\n@todo This file is copied from GUI and should be pulled out into a shared library.\nSee https://github.com/LLK/scratch-paint/issues/13 */\n\n.label_input-group {\n    display: -webkit-inline-box;\n    display: -webkit-inline-flex;\n    display: -ms-inline-flexbox;\n    display: inline-flex;\n    -webkit-box-orient: horizontal;\n    -webkit-box-direction: normal;\n    -webkit-flex-direction: row;\n        -ms-flex-direction: row;\n            flex-direction: row;\n    -webkit-box-align: center;\n    -webkit-align-items: center;\n        -ms-flex-align: center;\n            align-items: center;\n}\n\n[dir="ltr"] .label_input-group + .label_input-group {\n    margin-left: calc(2 * .25rem);\n}\n\n[dir="rtl"] .label_input-group + .label_input-group {\n    margin-right: calc(2 * .25rem);\n}\n\n.label_disabled {\n    opacity: 0.3;\n    /* Prevent any user actions */\n    pointer-events: none;\n}\n\n.label_input-label, .label_input-label-secondary {\n    font-size: 0.625rem;\n    -webkit-user-select: none;\n       -moz-user-select: none;\n        -ms-user-select: none;\n            user-select: none;\n    cursor: default;\n}\n\n[dir="ltr"] .label_input-label, [dir="ltr"] .label_input-label-secondary{\n    margin-right: calc(2 * .25rem);\n}\n\n[dir="rtl"] .label_input-label, [dir="ltr"] .label_input-label-secondary{\n    margin-left: calc(2 * .25rem);\n}\n\n.label_input-label {\n    font-weight: bold;\n}\n\n@media only screen and (max-width: 1256px) {\n    .label_input-group {\n        display: -webkit-box;\n        display: -webkit-flex;\n        display: -ms-flexbox;\n        display: flex;\n        -webkit-box-orient: vertical;\n        -webkit-box-direction: normal;\n        -webkit-flex-direction: column;\n            -ms-flex-direction: column;\n                flex-direction: column;\n        -webkit-box-align: start;\n        -webkit-align-items: flex-start;\n            -ms-flex-align: start;\n                align-items: flex-start;\n        margin-top: -1rem; /* To align with the non-labeled inputs */\n    }\n\n    .label_input-label {\n        font-weight: normal;\n        margin-bottom: 0.25rem;\n    }\n}\n',""]),t.locals={"input-group":"label_input-group",inputGroup:"label_input-group",disabled:"label_disabled","input-label":"label_input-label",inputLabel:"label_input-label","input-label-secondary":"label_input-label-secondary",inputLabelSecondary:"label_input-label-secondary"}},929:function(e,t,o){e.exports=o.p+"static/resource/680b3ff6a51d8fc77fbaf8695c8de929.svg"},930:function(e,t,o){e.exports=o.p+"static/resource/04e10c82d2a75d397ca963c1a9f9e1e7.svg"},931:function(e,t,o){var n=o(932);"string"==typeof n&&(n=[[e.i,n,""]]);var i={hmr:!0,transform:void 0};o(21)(n,i);n.locals&&(e.exports=n.locals)},932:function(e,t,o){(t=e.exports=o(20)(!1)).push([e.i,".loupe_eye-dropper {\n    position: absolute;\n    border-radius: 100%;\n    border: 1px solid #222;\n}\n",""]),t.locals={"eye-dropper":"loupe_eye-dropper",eyeDropper:"loupe_eye-dropper"}},933:function(e,t,o){var n=o(934);"string"==typeof n&&(n=[[e.i,n,""]]);var i={hmr:!0,transform:void 0};o(21)(n,i);n.locals&&(e.exports=n.locals)},934:function(e,t,o){(t=e.exports=o(20)(!1)).push([e.i,'/* DO NOT EDIT\n@todo This file is copied from GUI and should be pulled out into a shared library.\nSee https://github.com/LLK/scratch-paint/issues/13 */\n\n.dropdown_dropdown {\n    border: 1px solid #E9EEF2;\n    border-radius: 5px;\n    overflow: visible;\n    min-width: 3.5rem;\n    color: #4C97FF;\n    padding: .5rem;\n}\n\n.dropdown_mod-open {\n    background-color: #E9EEF2;\n}\n\n.dropdown_dropdown-icon {\n    width: .5rem;\n    height: .5rem;\n    vertical-align: middle;\n    padding-bottom: .2rem;\n}\n\n[dir="ltr"] .dropdown_dropdown-icon {\n    margin-left: .5rem;\n}\n\n[dir="rtl"] .dropdown_dropdown-icon {\n    margin-right: .5rem;\n}\n\n.dropdown_mod-caret-up {\n    -webkit-transform: rotate(180deg);\n        -ms-transform: rotate(180deg);\n            transform: rotate(180deg);\n    padding-bottom: 0;\n    padding-top: .2rem;\n}\n',""]),t.locals={dropdown:"dropdown_dropdown","mod-open":"dropdown_mod-open",modOpen:"dropdown_mod-open","dropdown-icon":"dropdown_dropdown-icon",dropdownIcon:"dropdown_dropdown-icon","mod-caret-up":"dropdown_mod-caret-up",modCaretUp:"dropdown_mod-caret-up"}},935:function(e,t,o){e.exports=o.p+"static/resource/49977a0d3680d3a72955df57e5a15afb.svg"},936:function(e,t,o){var n=o(937);"string"==typeof n&&(n=[[e.i,n,""]]);var i={hmr:!0,transform:void 0};o(21)(n,i);n.locals&&(e.exports=n.locals)},937:function(e,t,o){(t=e.exports=o(20)(!1)).push([e.i,'/* DO NOT EDIT\n@todo This file is copied from GUI and should be pulled out into a shared library.\nSee https://github.com/LLK/scratch-paint/issues/13 */\n\n/* NOTE:\nEdited to add input-range-small\n*/\n\n/* DO NOT EDIT\n@todo This file is copied from GUI and should be pulled out into a shared library.\nSee https://github.com/LLK/scratch-paint/issues/13 */\n\n/* ACTUALLY, THIS IS EDITED ;)\nTHIS WAS CHANGED ON 10/25/2017 BY @mewtaylor TO ADD A VARIABLE FOR THE SMALLEST\nGRID UNITS.\n\nALSO EDITED ON 11/13/2017 TO ADD IN CONTANTS FOR LAYOUT FROM `layout-contents.js`*/\n\n/* layout contants from `layout-constants.js`, minus 1px */\n\n/* DO NOT EDIT\n@todo This file is copied from GUI and should be pulled out into a shared library.\nSee https://github.com/LLK/scratch-paint/issues/13 */\n\n.input_input-form {\n    height: 2rem;\n    padding: 0 0.75rem;\n\n    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;\n    font-size: 0.75rem;\n    font-weight: bold;\n    color: #575e75;\n\n    border-width: 1px;\n    border-style: solid;\n    border-color: #E9EEF2;\n    border-radius: 2rem;\n\n    outline: none;\n    cursor: text;\n    -webkit-transition: 0.25s ease-out;\n    -o-transition: 0.25s ease-out;\n    transition: 0.25s ease-out; /* @todo: standardize with var */\n    -webkit-box-shadow: none;\n            box-shadow: none;\n\n    /*\n        For truncating overflowing text gracefully\n        Min-width is for a bug: https://css-tricks.com/flexbox-truncated-text\n        @todo: move this out into a mixin or a helper component\n    */\n    overflow: hidden;\n    -o-text-overflow: ellipsis;\n       text-overflow: ellipsis;\n    white-space: nowrap;\n    min-width: 0;\n}\n\n.input_input-form:focus {\n    border-color: #4C97FF;\n    -webkit-box-shadow: 0 0 0 .25rem hsla(215, 100%, 65%, 0.20);\n            box-shadow: 0 0 0 .25rem hsla(215, 100%, 65%, 0.20);\n}\n\n.input_input-small {\n    width: 3rem;\n    text-align: center;\n}\n\n.input_input-small-range {\n    width: 4rem;\n    text-align: center;\n}\n',""]),t.locals={"input-form":"input_input-form",inputForm:"input_input-form","input-small":"input_input-small",inputSmall:"input_input-small","input-small-range":"input_input-small-range",inputSmallRange:"input_input-small-range"}},938:function(e,t,o){var n=o(939);"string"==typeof n&&(n=[[e.i,n,""]]);var i={hmr:!0,transform:void 0};o(21)(n,i);n.locals&&(e.exports=n.locals)},939:function(e,t,o){(t=e.exports=o(20)(!1)).push([e.i,'/* DO NOT EDIT\n@todo This file is copied from GUI and should be pulled out into a shared library.\nSee https://github.com/LLK/scratch-paint/issues/13 */\n\n/* DO NOT EDIT\n@todo This file is copied from GUI and should be pulled out into a shared library.\nSee https://github.com/LLK/scratch-paint/issues/13 */\n\n/* ACTUALLY, THIS IS EDITED ;)\nTHIS WAS CHANGED ON 10/25/2017 BY @mewtaylor TO ADD A VARIABLE FOR THE SMALLEST\nGRID UNITS.\n\nALSO EDITED ON 11/13/2017 TO ADD IN CONTANTS FOR LAYOUT FROM `layout-contents.js`*/\n\n/* layout contants from `layout-constants.js`, minus 1px */\n\n.fixed-tools_row {\n    display: -webkit-box;\n    display: -webkit-flex;\n    display: -ms-flexbox;\n    display: flex;\n    -webkit-box-orient: horizontal;\n    -webkit-box-direction: normal;\n    -webkit-flex-direction: row;\n        -ms-flex-direction: row;\n            flex-direction: row;\n    -webkit-box-align: center;\n    -webkit-align-items: center;\n        -ms-flex-align: center;\n            align-items: center;\n}\n\n.fixed-tools_costume-input {\n    width: 8rem;\n}\n\n[dir="ltr"] .fixed-tools_mod-dashed-border {\n    border-right: 1px dashed #D9D9D9;\n    padding-right: calc(2 * .25rem);\n}\n\n[dir="rtl"] .fixed-tools_mod-dashed-border {\n    border-left: 1px dashed #D9D9D9;\n    padding-left: calc(2 * .25rem);\n}\n\n.fixed-tools_mod-unselect {\n    -webkit-user-select: none;\n       -moz-user-select: none;\n        -ms-user-select: none;\n            user-select: none;\n}\n\n.fixed-tools_button-group-button {\n    display: inline-block;\n    border: 1px solid #D9D9D9;\n    border-radius: 0;\n    padding: .35rem;\n}\n\n[dir="ltr"] .fixed-tools_button-group-button {\n    border-left: none;\n}\n\n[dir="rtl"] .fixed-tools_button-group-button {\n    border-right: none;\n}\n\n[dir="ltr"] .fixed-tools_button-group-button:last-of-type {\n    border-top-right-radius: 0.25rem;\n    border-bottom-right-radius: 0.25rem;\n}\n\n[dir="ltr"] .fixed-tools_button-group-button:first-of-type {\n    border-left: 1px solid #D9D9D9;\n    border-top-left-radius: 0.25rem;\n    border-bottom-left-radius: 0.25rem;\n}\n\n[dir="rtl"] .fixed-tools_button-group-button:last-of-type {\n    border-top-left-radius: 0.25rem;\n    border-bottom-left-radius: 0.25rem;\n}\n\n[dir="rtl"] .fixed-tools_button-group-button:first-of-type {\n    border-right: 1px solid #D9D9D9;\n    border-top-right-radius: 0.25rem;\n    border-bottom-right-radius: 0.25rem;\n}\n\n[dir="ltr"] .fixed-tools_button-group-button.fixed-tools_mod-start-border {\n    border-left: 1px solid #D9D9D9;\n}\n\n[dir="rtl"] .fixed-tools_button-group-button.fixed-tools_mod-start-border {\n    border-right: 1px solid #D9D9D9;\n}\n\n[dir="ltr"] .fixed-tools_button-group-button.fixed-tools_mod-no-end-border {\n    border-right: none;\n}\n\n[dir="rtl"] .fixed-tools_button-group-button.fixed-tools_mod-no-end-border {\n    border-left: none;\n}\n\n.fixed-tools_button-group-button-icon {\n    width: 1.25rem;\n    height: 1.25rem;\n    vertical-align: middle;\n}\n\n[dir="rtl"] .fixed-tools_button-group-button-icon {\n    -webkit-transform: scaleX(-1);\n        -ms-transform: scaleX(-1);\n            transform: scaleX(-1);\n}\n\n.fixed-tools_mod-context-menu {\n    display: -webkit-box;\n    display: -webkit-flex;\n    display: -ms-flexbox;\n    display: flex;\n    -webkit-box-orient: vertical;\n    -webkit-box-direction: normal;\n    -webkit-flex-direction: column;\n        -ms-flex-direction: column;\n            flex-direction: column;\n}\n\n.fixed-tools_mod-top-divider {\n    border-top: 1px solid #D9D9D9;\n}\n\n.fixed-tools_mod-menu-item {\n    display: -webkit-box;\n    display: -webkit-flex;\n    display: -ms-flexbox;\n    display: flex;\n    margin: 0 -.25rem;\n    min-width: 6.25rem;\n    padding: calc(3 * .25rem);\n    white-space: nowrap;\n    cursor: pointer;\n    -webkit-transition: 0.1s ease;\n    -o-transition: 0.1s ease;\n    transition: 0.1s ease;\n    -webkit-box-align: center;\n    -webkit-align-items: center;\n        -ms-flex-align: center;\n            align-items: center;\n    font-family: "Helvetica Neue", Helvetica, sans-serif;\n}\n\n.fixed-tools_mod-disabled {\n    cursor: auto;\n}\n\n.fixed-tools_mod-menu-item:hover {\n    background: hsla(215, 100%, 65%, 0.20);\n}\n\n.fixed-tools_mod-disabled:hover {\n    background-color: transparent;\n}\n\n.fixed-tools_menu-item-icon {\n    margin-right: calc(2 * .25rem);\n}\n\n[dir="rtl"] .fixed-tools_menu-item-icon {\n    margin-right: 0;\n    margin-left: calc(2 * .25rem);\n}\n',""]),t.locals={row:"fixed-tools_row","costume-input":"fixed-tools_costume-input",costumeInput:"fixed-tools_costume-input","mod-dashed-border":"fixed-tools_mod-dashed-border",modDashedBorder:"fixed-tools_mod-dashed-border","mod-unselect":"fixed-tools_mod-unselect",modUnselect:"fixed-tools_mod-unselect","button-group-button":"fixed-tools_button-group-button",buttonGroupButton:"fixed-tools_button-group-button","mod-start-border":"fixed-tools_mod-start-border",modStartBorder:"fixed-tools_mod-start-border","mod-no-end-border":"fixed-tools_mod-no-end-border",modNoEndBorder:"fixed-tools_mod-no-end-border","button-group-button-icon":"fixed-tools_button-group-button-icon",buttonGroupButtonIcon:"fixed-tools_button-group-button-icon","mod-context-menu":"fixed-tools_mod-context-menu",modContextMenu:"fixed-tools_mod-context-menu","mod-top-divider":"fixed-tools_mod-top-divider",modTopDivider:"fixed-tools_mod-top-divider","mod-menu-item":"fixed-tools_mod-menu-item",modMenuItem:"fixed-tools_mod-menu-item","mod-disabled":"fixed-tools_mod-disabled",modDisabled:"fixed-tools_mod-disabled","menu-item-icon":"fixed-tools_menu-item-icon",menuItemIcon:"fixed-tools_menu-item-icon"}},940:function(e,t,o){e.exports=o.p+"static/resource/3aa6c6bac36d0bc86fbc48b99e86b7fa.svg"},941:function(e,t,o){e.exports=o.p+"static/resource/dccd5059320d172d1b282564e0d9422d.svg"},942:function(e,t,o){e.exports=o.p+"static/resource/f3cd3bde88a384bf6757c9f30508cdd6.svg"},943:function(e,t,o){e.exports=o.p+"static/resource/c4379c5eb21b7cf9b9c94055dde0b582.svg"},944:function(e,t,o){e.exports=o.p+"static/resource/cc0065f74161f7e7859b31796aaa3345.svg"},945:function(e,t,o){e.exports=o.p+"static/resource/abdb9221f6fe3367ae1d899e2352d2e3.svg"},946:function(e,t,o){e.exports=o.p+"static/resource/a54e98269f78b67e2036168fced9b070.svg"},947:function(e,t,o){e.exports=o.p+"static/resource/d16a2c96bd97f214cc889b5bc3f921b4.svg"},948:function(e,t,o){(t=e.exports=o(20)(!1)).push([e.i,'/* DO NOT EDIT\n@todo This file is copied from GUI and should be pulled out into a shared library.\nSee https://github.com/LLK/scratch-paint/issues/13 */\n\n/* DO NOT EDIT\n@todo This file is copied from GUI and should be pulled out into a shared library.\nSee https://github.com/LLK/scratch-paint/issues/13 */\n\n/* ACTUALLY, THIS IS EDITED ;)\nTHIS WAS CHANGED ON 10/25/2017 BY @mewtaylor TO ADD A VARIABLE FOR THE SMALLEST\nGRID UNITS.\n\nALSO EDITED ON 11/13/2017 TO ADD IN CONTANTS FOR LAYOUT FROM `layout-contents.js`*/\n\n/* layout contants from `layout-constants.js`, minus 1px */\n\n.font-dropdown_mod-menu-item {\n    display: -webkit-box;\n    display: -webkit-flex;\n    display: -ms-flexbox;\n    display: flex;\n    margin: 0 -.25rem;\n    min-width: 6.25rem;\n    padding: calc(2 * .25rem);\n    padding-left: calc(3 * .25rem);\n    padding-right: calc(3 * .25rem);\n    white-space: nowrap;\n    width: 8.5rem;\n    cursor: pointer;\n    -webkit-transition: 0.1s ease;\n    -o-transition: 0.1s ease;\n    transition: 0.1s ease;\n    -webkit-box-align: center;\n    -webkit-align-items: center;\n        -ms-flex-align: center;\n            align-items: center;\n}\n\n.font-dropdown_mod-menu-item:hover {\n    background: #4C97FF;\n    color: white;\n}\n\n.font-dropdown_mod-context-menu {\n    display: -webkit-box;\n    display: -webkit-flex;\n    display: -ms-flexbox;\n    display: flex;\n    -webkit-box-orient: vertical;\n    -webkit-box-direction: normal;\n    -webkit-flex-direction: column;\n        -ms-flex-direction: column;\n            flex-direction: column;\n}\n\n.font-dropdown_mod-unselect {\n    -webkit-user-select: none;\n       -moz-user-select: none;\n        -ms-user-select: none;\n            user-select: none;\n}\n\n.font-dropdown_displayed-font-name {\n    font-size: .8rem;\n}\n\n.font-dropdown_font-dropdown {\n    -webkit-box-align: center;\n    -webkit-align-items: center;\n        -ms-flex-align: center;\n            align-items: center;\n    color: #575e75;\n    display: -webkit-box;\n    display: -webkit-flex;\n    display: -ms-flexbox;\n    display: flex;\n    font-size: 1rem;\n    -webkit-box-pack: justify;\n    -webkit-justify-content: space-between;\n        -ms-flex-pack: justify;\n            justify-content: space-between;\n    width: 8.5rem;\n    height: 2rem;\n}\n\n.font-dropdown_serif {\n    font-family: \'Serif\';\n}\n\n.font-dropdown_sans-serif {\n    font-family: \'Sans Serif\';\n}\n\n.font-dropdown_serif {\n    font-family: \'Serif\';\n}\n\n.font-dropdown_handwriting {\n    font-family: \'Handwriting\';\n}\n\n.font-dropdown_marker {\n    font-family: \'Marker\';\n}\n\n.font-dropdown_curly {\n    font-family: \'Curly\';\n}\n\n.font-dropdown_pixel {\n    font-family: \'Pixel\';\n}\n\n.font-dropdown_chinese {\n    font-family: "Microsoft YaHei", "\\5FAE\\8F6F\\96C5\\9ED1", STXihei, "\\534E\\6587\\7EC6\\9ED1";\n}\n\n.font-dropdown_japanese {\n    font-family: "\\30D2\\30E9\\30AE\\30CE\\89D2\\30B4   Pro W3", "Hiragino Kaku Gothic Pro", Osaka, "\\30E1\\30A4\\30EA\\30AA", Meiryo, "\\FF2D\\FF33   \\FF30\\30B4\\30B7\\30C3\\30AF", "MS PGothic";\n}\n\n.font-dropdown_korean {\n    font-family: "Malgun Gothic";\n}\n',""]),t.locals={"mod-menu-item":"font-dropdown_mod-menu-item",modMenuItem:"font-dropdown_mod-menu-item","mod-context-menu":"font-dropdown_mod-context-menu",modContextMenu:"font-dropdown_mod-context-menu","mod-unselect":"font-dropdown_mod-unselect",modUnselect:"font-dropdown_mod-unselect","displayed-font-name":"font-dropdown_displayed-font-name",displayedFontName:"font-dropdown_displayed-font-name","font-dropdown":"font-dropdown_font-dropdown",fontDropdown:"font-dropdown_font-dropdown",serif:"font-dropdown_serif","sans-serif":"font-dropdown_sans-serif",sansSerif:"font-dropdown_sans-serif",handwriting:"font-dropdown_handwriting",marker:"font-dropdown_marker",curly:"font-dropdown_curly",pixel:"font-dropdown_pixel",chinese:"font-dropdown_chinese",japanese:"font-dropdown_japanese",korean:"font-dropdown_korean"}},949:function(e,t,o){var n=o(950);"string"==typeof n&&(n=[[e.i,n,""]]);var i={hmr:!0,transform:void 0};o(21)(n,i);n.locals&&(e.exports=n.locals)},950:function(e,t,o){(t=e.exports=o(20)(!1)).push([e.i,'/* DO NOT EDIT\n@todo This file is copied from GUI and should be pulled out into a shared library.\nSee https://github.com/LLK/scratch-paint/issues/13 */\n\n/* DO NOT EDIT\n@todo This file is copied from GUI and should be pulled out into a shared library.\nSee https://github.com/LLK/scratch-paint/issues/13 */\n\n/* ACTUALLY, THIS IS EDITED ;)\nTHIS WAS CHANGED ON 10/25/2017 BY @mewtaylor TO ADD A VARIABLE FOR THE SMALLEST\nGRID UNITS.\n\nALSO EDITED ON 11/13/2017 TO ADD IN CONTANTS FOR LAYOUT FROM `layout-contents.js`*/\n\n/* layout contants from `layout-constants.js`, minus 1px */\n\n.mode-tools_mode-tools {\n    display: -webkit-box;\n    display: -webkit-flex;\n    display: -ms-flexbox;\n    display: flex;\n    min-height: 3rem;\n    -webkit-box-align: center;\n    -webkit-align-items: center;\n        -ms-flex-align: center;\n            align-items: center;\n}\n\n.mode-tools_mode-tools-icon {\n    margin-right: calc(2 * .25rem);\n    width: 2rem;\n    height: 2rem;\n}\n\n[dir="ltr"] .mode-tools_mod-dashed-border {\n    border-right: 1px dashed #D9D9D9;\n    padding-right: calc(3 * .25rem);\n}\n\n[dir="rtl"] .mode-tools_mod-dashed-border {\n    border-left: 1px dashed #D9D9D9;\n    padding-left: calc(3 * .25rem);\n}\n\n.mode-tools_mod-labeled-icon-height {\n    display: -webkit-box;\n    display: -webkit-flex;\n    display: -ms-flexbox;\n    display: flex;\n    height: 2.85rem; /* for the second row so the dashed borders are equal in size */\n    -webkit-box-align: center;\n    -webkit-align-items: center;\n        -ms-flex-align: center;\n            align-items: center;\n}\n',""]),t.locals={"mode-tools":"mode-tools_mode-tools",modeTools:"mode-tools_mode-tools","mode-tools-icon":"mode-tools_mode-tools-icon",modeToolsIcon:"mode-tools_mode-tools-icon","mod-dashed-border":"mode-tools_mod-dashed-border",modDashedBorder:"mode-tools_mod-dashed-border","mod-labeled-icon-height":"mode-tools_mod-labeled-icon-height",modLabeledIconHeight:"mode-tools_mod-labeled-icon-height"}},951:function(e,t,o){e.exports=o.p+"static/resource/374b815c6393f1c3585ddeec83c83f48.svg"},952:function(e,t,o){e.exports=o.p+"static/resource/c083eb7d85a76d2d205dcf97a46f76ac.svg"},953:function(e,t,o){e.exports=o.p+"static/resource/6e61fa7e48326bd2026d28e7a62884b1.svg"},954:function(e,t,o){e.exports=o.p+"static/resource/bb7c6671cf8cdffe1001dc509d20881c.svg"},955:function(e,t,o){e.exports=o.p+"static/resource/1fd3942fa102af8c13222be2ccc52e36.svg"},956:function(e,t,o){e.exports=o.p+"static/resource/db50bd7dacd69c9e8397eb83b4d83c3b.svg"},957:function(e,t,o){e.exports=o.p+"static/resource/3336a4516746eca7bc4a8e981e51a981.svg"},958:function(e,t,o){e.exports=o.p+"static/resource/d84cdb7f4b9567882511ab47f63e342b.svg"},959:function(e,t,o){e.exports=o.p+"static/resource/80ad76114d0b3f2fc54a3756dd283a53.svg"},960:function(e,t,o){e.exports=o.p+"static/resource/ac92bfcb2fc35687d1ba5ab6bb733671.svg"},961:function(e,t,o){e.exports=o.p+"static/resource/3a2d63269c47aa8244b0d613cf50eb6c.svg"},962:function(e,t,o){e.exports=o.p+"static/resource/e6f716edc49c30d8e46444093f2c113a.svg"},963:function(e,t,o){e.exports=o.p+"static/resource/5679cd29c517886712116060d3360592.svg"},964:function(e,t,o){e.exports=o.p+"static/resource/b592c8b4b02de3c7d367ce10efa9d7a6.svg"},965:function(e,t,o){e.exports=o.p+"static/resource/989d99155bdb2720680a8c09fb7c454e.svg"},966:function(e,t,o){var n=o(967);"string"==typeof n&&(n=[[e.i,n,""]]);var i={hmr:!0,transform:void 0};o(21)(n,i);n.locals&&(e.exports=n.locals)},967:function(e,t,o){(t=e.exports=o(20)(!1)).push([e.i,'/* DO NOT EDIT\n@todo This file is copied from GUI and should be pulled out into a shared library.\nSee https://github.com/LLK/scratch-paint/issues/13 */\n\n/* DO NOT EDIT\n@todo This file is copied from GUI and should be pulled out into a shared library.\nSee https://github.com/LLK/scratch-paint/issues/13 */\n\n/* ACTUALLY, THIS IS EDITED ;)\nTHIS WAS CHANGED ON 10/25/2017 BY @mewtaylor TO ADD A VARIABLE FOR THE SMALLEST\nGRID UNITS.\n\nALSO EDITED ON 11/13/2017 TO ADD IN CONTANTS FOR LAYOUT FROM `layout-contents.js`*/\n\n/* layout contants from `layout-constants.js`, minus 1px */\n\n.paint-editor_editor-container {\n    width: 100%;\n    height: 100%;\n    display: -webkit-box;\n    display: -webkit-flex;\n    display: -ms-flexbox;\n    display: flex;\n    -webkit-box-orient: vertical;\n    -webkit-box-direction: normal;\n    -webkit-flex-direction: column;\n        -ms-flex-direction: column;\n            flex-direction: column;\n    padding: calc(3 * .25rem);\n}\n\n.paint-editor_row {\n    display: -webkit-box;\n    display: -webkit-flex;\n    display: -ms-flexbox;\n    display: flex;\n    -webkit-box-orient: horizontal;\n    -webkit-box-direction: normal;\n    -webkit-flex-direction: row;\n        -ms-flex-direction: row;\n            flex-direction: row;\n    -webkit-box-align: center;\n    -webkit-align-items: center;\n        -ms-flex-align: center;\n            align-items: center;\n}\n\n.paint-editor_editor-container-top {\n    border-bottom: 1px dashed #D9D9D9;\n    padding-bottom: calc(2 * .25rem);\n}\n\n.paint-editor_top-align-row {\n    display: -webkit-box;\n    display: -webkit-flex;\n    display: -ms-flexbox;\n    display: flex;\n    -webkit-box-orient: horizontal;\n    -webkit-box-direction: normal;\n    -webkit-flex-direction: row;\n        -ms-flex-direction: row;\n            flex-direction: row;\n    height: 100%;\n    padding-top: calc(5 * .25rem);\n    min-width: 524px;\n}\n\n.paint-editor_row + .paint-editor_row {\n    margin-top: calc(2 * .25rem);\n}\n\n[dir="ltr"] .paint-editor_mod-dashed-border {\n    border-right: 1px dashed #D9D9D9;\n    padding-right: calc(2 * .25rem);\n}\n\n[dir="rtl"] .paint-editor_mod-dashed-border {\n    border-left: 1px dashed #D9D9D9;\n    padding-left: calc(2 * .25rem);\n}\n\n.paint-editor_mod-labeled-icon-height {\n    height: 2.85rem; /* for the second row so the dashed borders are equal in size */\n}\n\n.paint-editor_button-group-button {\n    display: inline-block;\n    border: 1px solid #D9D9D9;\n    border-radius: 0;\n    padding: .35rem;\n}\n\n[dir="ltr"] .paint-editor_button-group-button {\n    border-left: none;\n}\n\n[dir="rtl"] .paint-editor_button-group-button {\n    border-right: none;\n}\n\n[dir="ltr"] .paint-editor_button-group-button:last-of-type {\n    border-top-right-radius: 0.25rem;\n    border-bottom-right-radius: 0.25rem;\n}\n\n[dir="ltr"] .paint-editor_button-group-button:first-of-type {\n    border-left: 1px solid #D9D9D9;\n    border-top-left-radius: 0.25rem;\n    border-bottom-left-radius: 0.25rem;\n}\n\n[dir="rtl"] .paint-editor_button-group-button:last-of-type {\n    border-top-left-radius: 0.25rem;\n    border-bottom-left-radius: 0.25rem;\n}\n\n[dir="rtl"] .paint-editor_button-group-button:first-of-type {\n    border-right: 1px solid #D9D9D9;\n    border-top-right-radius: 0.25rem;\n    border-bottom-right-radius: 0.25rem;\n}\n\n[dir="ltr"] .paint-editor_button-group-button.paint-editor_mod-start-border {\n    border-left: 1px solid #D9D9D9;\n}\n\n[dir="rtl"] .paint-editor_button-group-button.paint-editor_mod-start-border {\n    border-right: 1px solid #D9D9D9;\n}\n\n[dir="ltr"].paint-editor_button-group-button.paint-editor_mod-no-end-border {\n    border-right: none;\n}\n\n[dir="rtl"].paint-editor_button-group-button.paint-editor_mod-no-end-border {\n    border-left: none;\n}\n\n.paint-editor_button-group-button-icon {\n    width: 1.25rem;\n    height: 1.25rem;\n    vertical-align: middle;\n}\n\n.paint-editor_mod-mode-tools {\n    margin-left: calc(2 * .25rem);\n}\n\n[dir="ltr"] .paint-editor_mod-margin-after {\n    margin-right: calc(2 * .25rem);\n}\n\n[dir="rtl"] .paint-editor_mod-margin-after {\n    margin-left: calc(2 * .25rem);\n}\n\n.paint-editor_controls-container {\n    width: 100%;\n    display: -webkit-box;\n    display: -webkit-flex;\n    display: -ms-flexbox;\n    display: flex;\n    -webkit-box-orient: vertical;\n    -webkit-box-direction: normal;\n    -webkit-flex-flow: column;\n        -ms-flex-flow: column;\n            flex-flow: column;\n    -webkit-box-flex: 1;\n    -webkit-flex-grow: 1;\n        -ms-flex-positive: 1;\n            flex-grow: 1;\n    margin-left: calc(2 * .25rem);\n    margin-right: calc(2 * .25rem);\n}\n\n.paint-editor_canvas-container {\n    width: 100%;\n    -webkit-box-flex: 1;\n    -webkit-flex-grow: 1;\n        -ms-flex-positive: 1;\n            flex-grow: 1;\n    min-width: 402px; /* Leave room for the border */\n    -webkit-box-sizing: content-box;\n            box-sizing: content-box;\n    border: 1px solid #e8edf1;\n    border-radius: .25rem;\n    position: relative;\n    overflow: visible;\n}\n\n.paint-editor_mode-selector {\n    display: -webkit-box;\n    display: -webkit-flex;\n    display: -ms-flexbox;\n    display: flex;\n    max-width: 7.5rem;\n    -webkit-box-orient: horizontal;\n    -webkit-box-direction: normal;\n    -webkit-flex-direction: row;\n        -ms-flex-direction: row;\n            flex-direction: row;\n    -webkit-flex-wrap: wrap;\n        -ms-flex-wrap: wrap;\n            flex-wrap: wrap;\n    -webkit-box-align: start;\n    -webkit-align-items: flex-start;\n        -ms-flex-align: start;\n            align-items: flex-start;\n    -webkit-align-content: flex-start;\n        -ms-flex-line-pack: start;\n            align-content: flex-start;\n    -webkit-box-pack: justify;\n    -webkit-justify-content: space-between;\n        -ms-flex-pack: justify;\n            justify-content: space-between;\n}\n\n.paint-editor_zoom-controls {\n    display: -webkit-box;\n    display: -webkit-flex;\n    display: -ms-flexbox;\n    display: flex;\n    -webkit-box-orient: horizontal;\n    -webkit-box-direction: reverse;\n    -webkit-flex-direction: row-reverse;\n        -ms-flex-direction: row-reverse;\n            flex-direction: row-reverse;\n}\n\n.paint-editor_color-picker-wrapper {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    pointer-events: none;\n}\n\n.paint-editor_canvas-controls {\n    display: -webkit-box;\n    display: -webkit-flex;\n    display: -ms-flexbox;\n    display: flex;\n    height: 36px;\n    margin-top: .25rem;\n    -webkit-box-pack: justify;\n    -webkit-justify-content: space-between;\n        -ms-flex-pack: justify;\n            justify-content: space-between;\n}\n\n.paint-editor_bitmap-button {\n    display: -webkit-box;\n    display: -webkit-flex;\n    display: -ms-flexbox;\n    display: flex;\n    border-radius: 5px;\n    background-color: #4C97FF;\n    padding: calc(2 * .25rem);\n    line-height: 1.5rem;\n    font-size: calc(3 * .25rem);\n    font-weight: bold;\n    color: white;\n    -webkit-box-pack: center;\n    -webkit-justify-content: center;\n        -ms-flex-pack: center;\n            justify-content: center;\n}\n\n[dir="ltr"] .paint-editor_bitmap-button-icon {\n    margin-right: calc(2 * .25rem);\n}\n\n[dir="rtl"] .paint-editor_bitmap-button-icon {\n    margin-left: calc(2 * .25rem);\n}\n\n@media only screen and (max-width: 1256px) {\n    .paint-editor_editor-container {\n        padding: calc(3 * .25rem) .25rem;\n    }\n\n    .paint-editor_mode-selector {\n        -webkit-box-orient: vertical;\n        -webkit-box-direction: normal;\n        -webkit-flex-direction: column;\n            -ms-flex-direction: column;\n                flex-direction: column;\n        -webkit-box-pack: start;\n        -webkit-justify-content: flex-start;\n            -ms-flex-pack: start;\n                justify-content: flex-start;\n    }\n\n    .paint-editor_controls-container {\n        margin-right: .25rem;\n        margin-left: .25rem;\n    }\n}\n\n.paint-editor_text-area {\n    background: transparent;\n    border: none;\n    display: none;\n    margin: 0px;\n    opacity: .8;\n    outline: none;\n    overflow: hidden;\n    padding: 0px;\n    position: absolute;\n    resize: none;\n    -webkit-text-fill-color: transparent;\n    text-fill-color: transparent;\n}\n\n.paint-editor_button-text {\n    width: 100%; /* Fixes button text wrapping in Edge */\n}\n',""]),t.locals={"editor-container":"paint-editor_editor-container",editorContainer:"paint-editor_editor-container",row:"paint-editor_row","editor-container-top":"paint-editor_editor-container-top",editorContainerTop:"paint-editor_editor-container-top","top-align-row":"paint-editor_top-align-row",topAlignRow:"paint-editor_top-align-row","mod-dashed-border":"paint-editor_mod-dashed-border",modDashedBorder:"paint-editor_mod-dashed-border","mod-labeled-icon-height":"paint-editor_mod-labeled-icon-height",modLabeledIconHeight:"paint-editor_mod-labeled-icon-height","button-group-button":"paint-editor_button-group-button",buttonGroupButton:"paint-editor_button-group-button","mod-start-border":"paint-editor_mod-start-border",modStartBorder:"paint-editor_mod-start-border","mod-no-end-border":"paint-editor_mod-no-end-border",modNoEndBorder:"paint-editor_mod-no-end-border","button-group-button-icon":"paint-editor_button-group-button-icon",buttonGroupButtonIcon:"paint-editor_button-group-button-icon","mod-mode-tools":"paint-editor_mod-mode-tools",modModeTools:"paint-editor_mod-mode-tools","mod-margin-after":"paint-editor_mod-margin-after",modMarginAfter:"paint-editor_mod-margin-after","controls-container":"paint-editor_controls-container",controlsContainer:"paint-editor_controls-container","canvas-container":"paint-editor_canvas-container",canvasContainer:"paint-editor_canvas-container","mode-selector":"paint-editor_mode-selector",modeSelector:"paint-editor_mode-selector","zoom-controls":"paint-editor_zoom-controls",zoomControls:"paint-editor_zoom-controls","color-picker-wrapper":"paint-editor_color-picker-wrapper",colorPickerWrapper:"paint-editor_color-picker-wrapper","canvas-controls":"paint-editor_canvas-controls",canvasControls:"paint-editor_canvas-controls","bitmap-button":"paint-editor_bitmap-button",bitmapButton:"paint-editor_bitmap-button","bitmap-button-icon":"paint-editor_bitmap-button-icon",bitmapButtonIcon:"paint-editor_bitmap-button-icon","text-area":"paint-editor_text-area",textArea:"paint-editor_text-area","button-text":"paint-editor_button-text",buttonText:"paint-editor_button-text"}},968:function(e,t,o){e.exports=o.p+"static/resource/59c79fa681b1421547664294a259b2d8.svg"},969:function(e,t,o){e.exports=o.p+"static/resource/3cfc9b39a0d002246119d47f6756d77e.svg"},970:function(e,t,o){e.exports=o.p+"static/resource/1fa6345d57ffc67eccd9f44cf6a383dd.svg"},971:function(e,t,o){e.exports=o.p+"static/resource/dba629c24296756d68a135988fe96011.svg"}}]);
//# sourceMappingURL=mblock.eb04cb880372b0a7.js.map