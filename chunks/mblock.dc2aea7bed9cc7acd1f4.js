(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{1193:function(e,t,n){(e.exports=n(68)(!1)).push([e.i,".passport-box .ant-modal-body {\n  padding: 0 !important;\n}\n.passport-box .ant-modal-content {\n  overflow: hidden;\n}\n.passport-box iframe {\n  display: block;\n  width: 100%;\n  height: 600px;\n  border: none;\n  overflow: hidden;\n  position: relative;\n  z-index: 2;\n}\n.passport-placeholder {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  top: 0;\n  left: 0;\n  z-index: 1;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  font-size: 18px;\n  flex-direction: column;\n}\n.passport-warn {\n  margin-top: 20px;\n  color: #666666;\n}\n",""])},1236:function(e,t,n){var a=n(1193);"string"==typeof a&&(a=[[e.i,a,""]]);var s={transform:void 0},o=n(88)(a,s);a.locals&&(e.exports=a.locals),a.locals||e.hot.accept(1193,(function(){var t=n(1193);"string"==typeof t&&(t=[[e.i,t,""]]),o(t)})),e.hot.dispose((function(){o()}))},1270:function(e,t,n){"use strict";n.r(t);var a=n(0),s=n.n(a),o=n(26),i=n(63),r=n(1163),l=n(32),c=n(44),p=n.n(c),d=n(15),h=n(17),m=n(14),u=n(30),S=n(48),f=n(21),g=n(72),w=n(19),b=n(3),y=n(13),E=n(7),I=n(104),j=(n(5),n(20));n(1236);class v extends a.PureComponent{constructor(e){var t,n,a;super(e),a=()=>{this.unlisten&&this.unlisten(),y.a.replace("/")},(n="handleCancel")in(t=this)?Object.defineProperty(t,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[n]=a,this.initPassport(),this.state={loading:!1,networkSlowly:!1,url:p.a.url}}componentDidMount(){this.timerId=setTimeout(()=>{this.setState({loading:!0}),this.networkWarn()},100)}networkWarn(){this.timerId&&clearTimeout(this.timerId),this.timerId=setTimeout(()=>{this.setState({networkSlowly:!0}),this.timerId=null},Object(h.isOnline)()?3e4:0)}componentWillUnmount(){this.timerId&&clearTimeout(this.timerId)}initPassport(){const{protocol:e}=location;"file:"===e&&(p.a.storage.strategy="localstorage",p.a.useLocalstorage=!0),this.unlisten=p.a.listenMessage(),p.a.intl=d.a.isInternational,p.a.redirect="",p.a.lang=this.props.langKey,p.a.showSwitchHost=!0,p.a.switchHost=e=>{e=Boolean(e),d.a.isPC?(p.a.intl=e,j.a.setIsIntl(e),this.setState({url:p.a.url,networkSlowly:!1}),this.networkWarn()):e!==Boolean(d.a.isInternational)&&m.c.openLink(null,E.b.link.mblock_web[e?"en":"zh"])},p.a.close=async e=>{this.props.updateLoginingState(!0);try{const t=await p.a.userInfo();t.intl=Boolean(d.a.isInternational),this.props.updateUserInfo(t),this.handleLogined(e)}catch(e){i.a.success(Object(S.b)({id:"MSG.99999"}))}this.props.updateLoginingState(!1),this.handleCancel()}}handleLogined(e={}){j.a.setToken(e.token),j.a.setIsIntl(Boolean(d.a.isInternational));const t=e.type===c.MESSAGE_TYPE.REGISTER,n=e.type===c.MESSAGE_TYPE.FINDPWD;let a="USER.LOGIN.SUCCESS.MSG";t?a="USER.REGISTER.SUCCESS.MSG":n&&(a="USER.FINDPWD.SUCCESS.MSG"),b.default.emit("RecoverProject"),i.a.success(Object(S.b)({id:a}));const{project:s,messages:o}=this.props,{name:r}=s;this.props.setProjectPlatformType(s.projectId),-1===r.indexOf(o["FILENAME.EMPTY"])?(w.a.isConfirmName=!0,Object(g.d)(f.a)):w.a.isConfirmName=!1,b.default.emit("RegisterDevice","login")}render(){return s.a.createElement(r.a,{wrapClassName:"vertical-center-modal",className:"passport-box",visible:!0,footer:null,width:400,onCancel:this.handleCancel},s.a.createElement("iframe",{src:this.state.url}),this.state.loading&&s.a.createElement("div",{className:"passport-placeholder"},s.a.createElement(l.a,{type:"loading",style:{fontSize:60},spin:!0}),s.a.createElement("p",{className:"passport-warn",style:{visibility:this.state.networkSlowly?"visible":"hidden"}},s.a.createElement(S.a,{id:"MSG.99999"}))))}}t.default=Object(o.connect)(({intlr:e,project:t})=>({langKey:e.langKey,messages:e.messages,project:t}),e=>({updateLoginingState:t=>e(Object(I.b)(t)),updateUserInfo:t=>e(Object(I.c)(t)),setProjectPlatformType:t=>e(u.a.setProjectPlatformType(t))}))(v)}}]);